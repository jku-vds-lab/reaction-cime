/*! For license information please see main.61680b9e.chunk.js.LICENSE.txt */
(this["webpackJsonpreaction-cime"]=this["webpackJsonpreaction-cime"]||[]).push([[0],{563:function(t){t.exports=JSON.parse('{"a":"0.1.3"}')},620:function(t,e,n){},626:function(t,e,n){},648:function(t,e,n){},649:function(t,e,n){},650:function(t,e,n){},651:function(t,e,n){"use strict";n.r(e);var r=n(2),a=n.n(r),i=n(125),o=n.n(i),u=n(22),s=n(30),c=n(10),l=n(7),f=n(14),h=n(15),d=n(13),g=n(53),p=n(723),m=n(256),v=n(720),y=n(721),b=(n(620),n(23)),_=n(44),x=n(24),j=n.n(x),O=n(52),w=n(112),C=function(){function t(e){var n=this,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};Object(c.a)(this,t),this.baseUrl=e,this.fetchParams=r,this.smiles_cache={},this.smiles_highlight_cache={},this.cache={},this.handleSmilesCache=function(t){var e=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return e?n.smiles_highlight_cache[t]:n.smiles_cache[t]},this.setSmilesCache=function(t){var e=arguments.length>1&&void 0!==arguments[1]&&arguments[1],r=arguments.length>2?arguments[2]:void 0;e?n.smiles_highlight_cache[t]=r:n.smiles_cache[t]=r},this.async_cache=function(){var t=Object(_.a)(j.a.mark((function t(e){return j.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",e);case 1:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),this.handleCache=function(t){return n.cache[t]?Object.assign(n.cache[t]):null},this.setCache=function(t,e){n.cache[t]=e},this.handleErrors=function(t){if(!t.ok)throw Error(t.statusText);return t},this.handleJSONErrors=function(t){return Object.keys(t).includes("error")&&alert(t.error),t},this.getUploadedFiles=Object(_.a)(j.a.mark((function t(){var e;return j.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e=n.baseUrl+"/get_uploaded_files_list",t.abrupt("return",fetch(e,Object(b.a)(Object(b.a)({},n.fetchParams),{},{method:"GET"})).then(n.handleErrors).then((function(t){return t.json()})).then(n.handleJSONErrors).catch((function(t){console.log(t)})));case 2:case"end":return t.stop()}}),t)}))),this.deleteFile=function(){var t=Object(_.a)(j.a.mark((function t(e){var r;return j.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return r=n.baseUrl+"/delete_file/"+e,t.abrupt("return",fetch(r,Object(b.a)(Object(b.a)({},n.fetchParams),{},{method:"GET"})).then(n.handleErrors).then((function(t){return t.json()})).then(n.handleJSONErrors).catch((function(t){alert("file could not be deleted. please, try again"),console.log(t)})));case 2:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),this.getStructureFromSmiles=function(t){var e=arguments.length>1&&void 0!==arguments[1]&&arguments[1],r=arguments.length>2?arguments[2]:void 0,a=n.handleSmilesCache(t,e);if(a)return n.async_cache(a);var i=new FormData;i.append("smiles",t);var o=n.baseUrl+"/get_mol_img";return e&&(o+="/highlight"),fetch(o,Object(b.a)(Object(b.a)({},n.fetchParams),{},{method:"POST",body:i,signal:null===r||void 0===r?void 0:r.signal})).then(n.handleErrors).then((function(t){return t.json()})).then(n.handleJSONErrors).then((function(r){return n.setSmilesCache(t,e,r.data),r.data})).catch((function(t){console.log(t)}))},this.getMCSFromSmilesList=function(){var t=Object(_.a)(j.a.mark((function t(e,r){var a;return j.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return a=r?fetch(n.baseUrl+"/get_common_mol_img",Object(b.a)(Object(b.a)({},n.fetchParams),{},{method:"POST",body:e,signal:null===r||void 0===r?void 0:r.signal})):fetch(n.baseUrl+"/get_common_mol_img",Object(b.a)(Object(b.a)({},n.fetchParams),{},{method:"POST",body:e})),t.abrupt("return",a.then(n.handleErrors).then((function(t){return t.json()})).then(n.handleJSONErrors).then((function(t){return t.data})).catch((function(t){console.log(t)})));case 2:case"end":return t.stop()}}),t)})));return function(e,n){return t.apply(this,arguments)}}(),this.getSubstructureCount=function(){var t=Object(_.a)(j.a.mark((function t(e,r){var a;return j.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return(a=new FormData).append("smiles_list",e),a.append("filter_smiles",r),t.abrupt("return",fetch(n.baseUrl+"/get_substructure_count",Object(b.a)(Object(b.a)({},n.fetchParams),{},{method:"POST",body:a})).then(n.handleErrors).then((function(t){return t.json()})).then(n.handleJSONErrors).then((function(t){if(Object.keys(t).includes("substructure_counts"))return t.substructure_counts;throw Error("Backend responded with error: "+t.error)})).catch((function(t){alert("could not find substructure match"),console.log(t)})));case 4:case"end":return t.stop()}}),t)})));return function(e,n){return t.apply(this,arguments)}}(),this.calculateHDBScanClusters=function(){var t=Object(_.a)(j.a.mark((function t(e,r,a,i){var o;return j.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return(o=new FormData).append("min_cluster_size",r),o.append("min_cluster_samples",a),o.append("allow_single_cluster",i),o.append("X",e),t.abrupt("return",fetch(n.baseUrl+"/segmentation",Object(b.a)(Object(b.a)({},n.fetchParams),{},{method:"POST",body:o})).then(n.handleErrors).then((function(t){return t.json()})).then(n.handleJSONErrors).catch((function(t){alert("error when calculating clusters"),console.log(t)})));case 6:case"end":return t.stop()}}),t)})));return function(e,n,r,a){return t.apply(this,arguments)}}(),this.terminate_projection=function(){var t=Object(_.a)(j.a.mark((function t(e){var r;return j.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return r=n.baseUrl+"/terminate_projection_thread/"+e,t.abrupt("return",fetch(r,Object(b.a)(Object(b.a)({},n.fetchParams),{},{method:"GET"})).then(n.handleErrors).then((function(t){return t.json()})).then(n.handleJSONErrors).catch((function(t){console.log(t)})));case 2:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),this.getkNearestData=function(){var t=Object(_.a)(j.a.mark((function t(e,r,a,i){var o;return j.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:o=n.baseUrl+"/get_k_nearest_from_csv/"+e+"/"+r+"/"+a+"/"+i,window.open(o);case 2:case"end":return t.stop()}}),t)})));return function(e,n,r,a){return t.apply(this,arguments)}}(),this.project_dataset=function(){var t=Object(_.a)(j.a.mark((function t(e,r,a,i){var o;return j.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return(o=new FormData).append("filename",e),o.append("params",JSON.stringify(r)),o.append("selected_feature_info",JSON.stringify(a)),t.abrupt("return",fetch(n.baseUrl+"/project_dataset_async",Object(b.a)(Object(b.a)({},n.fetchParams),{},{method:"POST",body:o,signal:null===i||void 0===i?void 0:i.signal})).then(n.handleErrors).then((function(t){return n.resetAggregationCache(),t})).catch((function(t){console.log(t)})));case 5:case"end":return t.stop()}}),t)})));return function(e,n,r,a){return t.apply(this,arguments)}}(),this.upload_csv_file=function(){var t=Object(_.a)(j.a.mark((function t(e,r){var a,i;return j.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return(a=new FormData).append("myFile",e),a.append("file_size",e.size),i=fetch(n.baseUrl+"/upload_csv",Object(b.a)(Object(b.a)({},n.fetchParams),{},{method:"POST",body:a,signal:null===r||void 0===r?void 0:r.signal})).then(n.handleErrors).then((function(t){return t.json()})).then(n.handleJSONErrors).catch((function(t){"AbortError"===t.name?console.log("Fetch aborted"):(alert("error when uploading file. it might be too big"),console.log(t))})),t.abrupt("return",i);case 5:case"end":return t.stop()}}),t)})));return function(e,n){return t.apply(this,arguments)}}(),this.loadNODatapoints=function(){var t=Object(_.a)(j.a.mark((function t(e){return j.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",fetch(n.baseUrl+"/get_no_datapoints/"+e,Object(b.a)(Object(b.a)({},n.fetchParams),{},{method:"GET"})).then(n.handleErrors).then((function(t){return t.json()})).then(n.handleJSONErrors).catch((function(t){console.log(t)})));case 1:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),this.loadValueRange=function(){var t=Object(_.a)(j.a.mark((function t(e,r){return j.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",fetch(n.baseUrl+"/get_value_range/"+e+"/"+r,Object(b.a)(Object(b.a)({},n.fetchParams),{},{method:"GET"})).then(n.handleErrors).then((function(t){return t.json()})).then(n.handleJSONErrors).catch((function(t){console.log(t)})));case 1:case"end":return t.stop()}}),t)})));return function(e,n){return t.apply(this,arguments)}}(),this.loadCategoryValues=function(){var t=Object(_.a)(j.a.mark((function t(e,r){return j.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",fetch(n.baseUrl+"/get_category_values/"+e+"/"+r,Object(b.a)(Object(b.a)({},n.fetchParams),{},{method:"GET"})).then(n.handleErrors).then((function(t){return t.json()})).then(n.handleJSONErrors).catch((function(t){console.log(t)})));case 1:case"end":return t.stop()}}),t)})));return function(e,n){return t.apply(this,arguments)}}(),this.updateBackendCache=function(){var t=Object(_.a)(j.a.mark((function t(e,r){var a,i,o;return j.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(a="",null!=r)for(i in r)o=r[i],a+="&cache_cols="+o;return t.abrupt("return",fetch(n.baseUrl+"/update_cache/"+e+"?dummy=1"+a,Object(b.a)(Object(b.a)({},n.fetchParams),{},{method:"GET"})).then(n.handleErrors).then((function(t){return t.json()})).then(n.handleJSONErrors).catch((function(t){console.log(t)})));case 3:case"end":return t.stop()}}),t)})));return function(e,n){return t.apply(this,arguments)}}(),this.loadCategoryCount=function(){var t=Object(_.a)(j.a.mark((function t(e,r){return j.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",fetch(n.baseUrl+"/get_category_count/"+e+"/"+r,Object(b.a)(Object(b.a)({},n.fetchParams),{},{method:"GET"})).then(n.handleErrors).then((function(t){return t.json()})).then(n.handleJSONErrors).catch((function(t){console.log(t)})));case 1:case"end":return t.stop()}}),t)})));return function(e,n){return t.apply(this,arguments)}}(),this.loadCategoryCountOfHex=function(){var t=Object(_.a)(j.a.mark((function t(e,r,a,i,o,u,s){return j.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return null==a&&(a="x"),null==i&&(i="y"),t.abrupt("return",fetch(n.baseUrl+"/get_category_count_of_hex/"+e+"/"+r+"/"+a+"/"+i+"?x="+o+"&y="+u+"&circ_radius="+s,Object(b.a)(Object(b.a)({},n.fetchParams),{},{method:"GET"})).then(n.handleErrors).then((function(t){return t.json()})).then(n.handleJSONErrors).catch((function(t){console.log(t)})));case 3:case"end":return t.stop()}}),t)})));return function(e,n,r,a,i,o,u){return t.apply(this,arguments)}}(),this.loadDensity=function(){var t=Object(_.a)(j.a.mark((function t(e,r){return j.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",fetch(n.baseUrl+"/get_density/"+e+"/"+r,Object(b.a)(Object(b.a)({},n.fetchParams),{},{method:"GET"})).then(n.handleErrors).then((function(t){return t.json()})).then(n.handleJSONErrors).catch((function(t){console.log(t)})));case 1:case"end":return t.stop()}}),t)})));return function(e,n){return t.apply(this,arguments)}}(),this.loadDensityOfHex=function(){var t=Object(_.a)(j.a.mark((function t(e,r,a,i,o,u,s){return j.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return null==a&&(a="x"),null==i&&(i="y"),t.abrupt("return",fetch(n.baseUrl+"/get_density_of_hex/"+e+"/"+r+"/"+a+"/"+i+"?x="+o+"&y="+u+"&circ_radius="+s,Object(b.a)(Object(b.a)({},n.fetchParams),{},{method:"GET"})).then(n.handleErrors).then((function(t){return t.json()})).then(n.handleJSONErrors).catch((function(t){console.log(t)})));case 3:case"end":return t.stop()}}),t)})));return function(e,n,r,a,i,o,u){return t.apply(this,arguments)}}(),this.agg_dataset_cache=null,this.cur_agg_path="",this.resetAggregationCache=function(){n.agg_dataset_cache=null},this.handleAggregationCache=function(t,e,r,a,i,o){if(null==n.agg_dataset_cache||n.agg_dataset_cache.length<=0)return null;if(i=null==i?"x":i,i=null==o?"y":o,n.cur_agg_path!==t||!(e in n.agg_dataset_cache[0].data)||!(r in n.agg_dataset_cache[0].data)||!(i in n.agg_dataset_cache[0].data)||!(o in n.agg_dataset_cache[0].data))return n.resetAggregationCache(),n.cur_agg_path=t,null;var u=n.agg_dataset_cache.filter((function(t){return!!(n.is_within_boundaries(a.x.min,t.x.min)&&n.is_within_boundaries(a.x.max,t.x.max)&&n.is_within_boundaries(a.y.min,t.y.min)&&n.is_within_boundaries(a.y.max,t.y.max))}));return 1===u.length||u.length>1?u[0]:null},this.loadPOIExceptions=function(){var t=Object(_.a)(j.a.mark((function t(e){return j.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",fetch(n.baseUrl+"/get_poi_exceptions/"+e,Object(b.a)(Object(b.a)({},n.fetchParams),{},{method:"GET"})).then(n.handleErrors).then((function(t){return t.json()})).then(n.handleJSONErrors).catch((function(t){console.log(t)})));case 1:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),this.loadPOIConstraints=function(){var t=Object(_.a)(j.a.mark((function t(e){return j.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",fetch(n.baseUrl+"/get_poi_constraints/"+e,Object(b.a)(Object(b.a)({},n.fetchParams),{},{method:"GET"})).then(n.handleErrors).then((function(t){return t.json()})).then(n.handleJSONErrors).catch((function(t){console.log(t)})));case 1:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),this.resetPOIConstraints=function(){var t=Object(_.a)(j.a.mark((function t(e){return j.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",fetch(n.baseUrl+"/reset_poi_constraints/"+e,Object(b.a)(Object(b.a)({},n.fetchParams),{},{method:"GET"})).then(n.handleErrors).then((function(t){return t.json()})).then(n.handleJSONErrors).catch((function(t){console.log(t)})));case 1:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),this.addPOIExceptions=function(){var t=Object(_.a)(j.a.mark((function t(e,r){var a;return j.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return(a=new FormData).append("exceptions",JSON.stringify(r)),a.append("filename",e),t.abrupt("return",fetch(n.baseUrl+"/add_poi_exceptions",Object(b.a)(Object(b.a)({},n.fetchParams),{},{method:"POST",body:a})).then(n.handleErrors).then((function(t){return t.json()})).then(n.handleJSONErrors).catch((function(t){console.log(t)})));case 4:case"end":return t.stop()}}),t)})));return function(e,n){return t.apply(this,arguments)}}(),this.updatePOIExceptions=function(){var t=Object(_.a)(j.a.mark((function t(e,r){var a;return j.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return(a=new FormData).append("exceptions",JSON.stringify(r)),a.append("filename",e),t.abrupt("return",fetch(n.baseUrl+"/update_poi_exceptions",Object(b.a)(Object(b.a)({},n.fetchParams),{},{method:"POST",body:a})).then(n.handleErrors).then((function(t){return t.json()})).then(n.handleJSONErrors).catch((function(t){console.log(t)})));case 4:case"end":return t.stop()}}),t)})));return function(e,n){return t.apply(this,arguments)}}(),this.updatePOIConstraints=function(){var t=Object(_.a)(j.a.mark((function t(e,r){var a;return j.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return(a=new FormData).append("constraints",JSON.stringify(r)),a.append("filename",e),t.abrupt("return",fetch(n.baseUrl+"/update_poi_constraints",Object(b.a)(Object(b.a)({},n.fetchParams),{},{method:"POST",body:a})).then(n.handleErrors).then((function(t){return t.json()})).then(n.handleJSONErrors).catch((function(t){console.log(t)})));case 4:case"end":return t.stop()}}),t)})));return function(e,n){return t.apply(this,arguments)}}(),this.downloadPOIConstraints=function(){var t=Object(_.a)(j.a.mark((function t(e){var r;return j.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:r=n.baseUrl+"/download_poi_constraints/"+e,window.open(r);case 2:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),this.uploadPOIConstraints=function(){var t=Object(_.a)(j.a.mark((function t(e,n){var r,a;return j.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,n.text();case 2:return r=t.sent,a=O.csvParse(r),t.abrupt("return",S.updatePOIConstraints(e,a));case 5:case"end":return t.stop()}}),t)})));return function(e,n){return t.apply(this,arguments)}}()}return Object(l.a)(t,[{key:"cache_agg_data",value:function(t,e){null==this.agg_dataset_cache?this.agg_dataset_cache=[Object(b.a)(Object(b.a)({},t),{},{data:e})]:this.agg_dataset_cache.push(Object(b.a)(Object(b.a)({},t),{},{data:e}))}},{key:"is_within_boundaries",value:function(t,e){var n=Math.abs(.5*e);return t<e+n&&t>e-n}},{key:"loadHexAgg",value:function(t,e,n,r,a,i,o,u,s,c,l,f,h){var d=this;null==n&&(n="x"),null==r&&(r="y");var g=this.handleAggregationCache(e,a,i,c,n,r),p=null;if(g)console.log("cached"),p=this.async_cache(g.data);else{var m="retrieve_cols="+a;m+="&aggregation_methods="+s.valueAggregationMethod,"None"!==i&&null!=i&&(m+="&retrieve_cols="+i,m+="&aggregation_methods="+s.uncertaintyAggregationMethod);var v="";if(null!=o)for(var y in o){v+="&cache_cols="+o[y]}var _="";null!=u&&(_="&sample_size="+u),null==c&&(c={x:{min:-1e4,max:1e4},y:{min:-1e4,max:1e4}});var x="&x_min="+c.x.min+"&x_max="+c.x.max+"&y_min="+c.y.min+"&y_max="+c.y.max,j=S.baseUrl+"/get_hex_agg/"+e+"/"+n+"/"+r+"?"+m+v+_+x;p=l?l(O.csv(j,Object(b.a)(Object(b.a)({},S.fetchParams),{},{signal:null===f||void 0===f?void 0:f.signal})),f):O.csv(j,Object(b.a)(Object(b.a)({},S.fetchParams),{},{signal:null===f||void 0===f?void 0:f.signal}))}Object(w.trackPromise)(p.then((function(e){e.length<=0?(console.log("aggregation dataset is empty"),alert("aggregation dataset is empty")):(null==g&&d.cache_agg_data(c,e),t(e))})).catch((function(t){console.log(t)})),h)}},{key:"loadAggCSV",value:function(t,e,n,r,a,i,o,u,s,c){var l=this;null==o&&(o={x:{min:-1e4,max:1e4},y:{min:-1e4,max:1e4}});var f=this.handleAggregationCache(e,n,r,o),h=null;if(f)h=this.async_cache(f.data);else{var d="retrieve_cols="+n;"None"!==r&&null!=r&&(d+="&retrieve_cols="+r);var g="";if(null!=a)for(var p in a){g+="&cache_cols="+a[p]}var m="";null!=i&&(m="&sample_size="+i);var v="&x_min="+o.x.min+"&x_max="+o.x.max+"&y_min="+o.y.min+"&y_max="+o.y.max,y=S.baseUrl+"/get_agg_csv_cached/"+e+"?"+d+g+m+v;h=u?u(O.csv(y,Object(b.a)(Object(b.a)({},S.fetchParams),{},{signal:null===s||void 0===s?void 0:s.signal})),s):O.csv(y,Object(b.a)(Object(b.a)({},S.fetchParams),{},{signal:null===s||void 0===s?void 0:s.signal}))}Object(w.trackPromise)(h.then((function(e){e.length<=0?(console.log("aggregation dataset is empty"),alert("aggregation dataset is empty")):(null==f&&l.cache_agg_data(o,e),t(e))})).catch((function(t){console.log(t)})),c)}},{key:"loadPacoCSV",value:function(t,e,n,r,a,i){var o="?dummy=0";for(var u in n){o+="&cols="+n[u]}var s=S.baseUrl+"/get_csv_by_columns/"+e+o,c=r?r(O.csv(s,Object(b.a)(Object(b.a)({},S.fetchParams),{},{signal:null===a||void 0===a?void 0:a.signal})),a):O.csv(s,Object(b.a)(Object(b.a)({},S.fetchParams),{},{signal:null===a||void 0===a?void 0:a.signal}));Object(w.trackPromise)(c.then((function(e){e.length<=0?(console.log("dataset is empty"),alert("dataset is empty")):t(e)})).catch((function(t){console.log(t)})),i)}}]),t}();var S=new C("",{}),k="#007dad",E=function(t){return t<.01?O.format(".2e")(t):t>=100?Math.round(t):Math.round(100*t)/100},M=function(t,e,n){if(null==n||null==e)return Math.round(t);var r=(n-e)/100;return r<.01?O.format(".2e")(t):r>=1?Math.round(t):Math.round(100*t)/100};function T(t,e){return Array.isArray(t)&&Array.isArray(e)&&t.length===e.length&&t.every((function(t,n){return t===e[n]}))}function P(t){var e,n=localStorage.getItem("smiles_lookup");return null==n?t:null===(e=O.csvParse(n).find((function(e){return e.smiles===t})))||void 0===e?void 0:e.shortname}function A(t){var e,n=localStorage.getItem("smiles_lookup");return null==n?t:null===(e=O.csvParse(n).find((function(e){return e.shortname===t})))||void 0===e?void 0:e.smiles}var N,I,U,R=function(t,e,n){var r=new Blob([t],{type:n}),a=window.URL.createObjectURL(r),i=document.createElement("a");i.href=a,i.setAttribute("download",e),i.click()},F=n(719),D=n(66),L=n(145),V=n(20),H=n(38),z=n(37),G=n(255),J=n(27),Y=n(26),B=n(25),q=n(56),W=n(40),X=n(32),$=n(41),Q=n(141),Z=Object(O.format)(".3n");var K=Object(B.j)("rename","filterNumber","sort","sortBy")(N=Object(B.f)("sort","sortNumbers")(N=Object(B.b)("descending")((U=I=function(t){Object(f.a)(n,t);var e=Object(h.a)(n);function n(t,r,a){var i;return Object(c.a)(this,n),(i=e.call(this,t,r)).numberFormat=Z,i.sort=void 0,i.mapping=void 0,i.original=void 0,i.colorMapping=void 0,i.currentFilter={min:-1/0,max:1/0,filterMissing:!1},i.min=0,i.max=1,i.mapping=new q.a([r.min,r.max],"linear",[0,1]),i.original=i.mapping.clone(),i.sort=r.sort||W.a.median,i.colorMapping=a.colorMappingFunction(r.colorMapping||r.color),r.numberFormat&&(i.numberFormat=Object(O.format)(r.numberFormat)),i.min=r.min,i.max=r.max,i}return Object(l.a)(n,[{key:"getMin",value:function(){return this.min}},{key:"getMax",value:function(){return this.max}},{key:"getNumberFormat",value:function(){return this.numberFormat}},{key:"get_quartile",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:.5;if(0===t.length)return 0;t.sort((function(t,e){return t-e}));var n=Math.floor(t.length*e);return t.length%2?t[n]:(t[n-1]+t[n])/2}},{key:"mean",value:function(t){var e,n=0;for(e=0;e<t.length;e+=1)n+=t[e];return n/t.length}},{key:"get_advanced_value",value:function(t,e){switch(t){case W.a.min:return Math.min.apply(Math,Object(d.a)(e));case W.a.max:return Math.max.apply(Math,Object(d.a)(e));case W.a.mean:return this.mean(e);case W.a.median:return this.get_quartile(e);case W.a.q1:return this.get_quartile(e,1);case W.a.q3:return this.get_quartile(e,3);default:return this.get_quartile(e)}}},{key:"toCompareValue",value:function(t){var e=this.getValue(t)[0].value,n=this.getSortMethod();return this.get_advanced_value(n,e)}},{key:"toCompareValueType",value:function(){return X.b.FLOAT}},{key:"getBoxPlotDataFromValueList",value:function(t){return{mean:this.get_advanced_value(W.a.mean,t),missing:0,count:t.length,max:this.get_advanced_value(W.a.max,t),min:this.get_advanced_value(W.a.min,t),median:this.get_advanced_value(W.a.median,t),q1:this.get_advanced_value(W.a.q1,t),q3:this.get_advanced_value(W.a.q3,t)}}},{key:"getBoxPlotData",value:function(t){console.log("getBoxPlotData");var e=this.getValue(t)[0].value;return null==e?null:this.getBoxPlotDataFromValueList(e)}},{key:"getRawBoxPlotData",value:function(t){console.log("getRawBoxPlotData");var e=this.getRawValue(t)[0].value;return null==e?null:this.getBoxPlotDataFromValueList(e)}},{key:"getRange",value:function(){return console.log("getRange"),this.mapping.getRange(this.numberFormat)}},{key:"getColorMapping",value:function(){return console.log("getColorMapping"),this.colorMapping.clone()}},{key:"getNumber",value:function(t){return this.mapping.apply(this.toCompareValue(t))}},{key:"getRawNumber",value:function(t){return this.toCompareValue(t)}},{key:"iterNumber",value:function(t){var e=this.getValue(t);return[this.get_advanced_value(W.a.median,e[0].value)]}},{key:"iterRawNumber",value:function(t){var e=this.getRawValue(t);return[this.get_advanced_value(W.a.median,e[0].value)]}},{key:"getValue",value:function(t){var e=this,n=this.getRawValue(t);return 0===n.length?null:n.map((function(t){var n=t.key,r=t.value;return{key:n,value:0===r.length?null:r.map((function(t){return e.mapping.apply(t)}))}}))}},{key:"getRawValue",value:function(t){var e=Object(J.a)(Object(Y.a)(n.prototype),"getValue",this).call(this,t);return null==e?[]:e}},{key:"getExportValue",value:function(t,e){return"json"===e?this.getRawValue(t):Object(J.a)(Object(Y.a)(n.prototype),"getExportValue",this).call(this,t,e)}},{key:"getFormatedLabelArray",value:function(t){var e=this;return"["+t.map((function(t){return e.numberFormat(t)})).toString()+"]"}},{key:"getLabels",value:function(t){var e=this;return this.getRawValue(t).map((function(t){var n=t.key,r=t.value;return{key:n,value:e.getFormatedLabelArray(r)}}))}},{key:"getSortMethod",value:function(){return this.sort}},{key:"setSortMethod",value:function(t){this.sort!==t&&(this.fire([n.EVENT_SORTMETHOD_CHANGED],this.sort,this.sort=t),this.isSortedByMe().asc||this.sortByMe())}},{key:"dump",value:function(t){var e,r=Object(J.a)(Object(Y.a)(n.prototype),"dump",this).call(this,t);return r.sortMethod=this.getSortMethod(),r.filter=(e=this.currentFilter).filterMissing||isFinite(e.min)||isFinite(e.max)?this.currentFilter:null,r.map=this.mapping.toJSON(),r}},{key:"restore",value:function(t,e){var r;Object(J.a)(Object(Y.a)(n.prototype),"restore",this).call(this,t,e),t.sortMethod&&(this.sort=t.sortMethod),t.filter&&(this.currentFilter={min:null!=(r=t.filter).min&&isFinite(r.min)?r.min:-1/0,max:null!=r.max&&isFinite(r.max)?r.max:1/0,filterMissing:r.filterMissing}),(t.map||t.domain)&&(this.mapping=function(t,e){return t.map?e.mappingFunction(t.map):new q.a(t.domain||[0,1],"linear",t.range||[0,1])}(t,e))}},{key:"createEventList",value:function(){return Object(J.a)(Object(Y.a)(n.prototype),"createEventList",this).call(this).concat([n.EVENT_MAPPING_CHANGED,n.EVENT_SORTMETHOD_CHANGED,n.EVENT_FILTER_CHANGED])}},{key:"on",value:function(t,e){return Object(J.a)(Object(Y.a)(n.prototype),"on",this).call(this,t,e)}},{key:"getOriginalMapping",value:function(){return this.original.clone()}},{key:"getMapping",value:function(){return this.mapping.clone()}},{key:"setMapping",value:function(t){this.mapping.eq(t)||this.fire([n.EVENT_MAPPING_CHANGED,V.a.EVENT_DIRTY_VALUES,V.a.EVENT_DIRTY],this.mapping.clone(),this.mapping=t)}},{key:"getColor",value:function(t){return $.a.prototype.getColor.call(this,t)}},{key:"isFiltered",value:function(){return $.a.prototype.isFiltered.call(this)}},{key:"getFilter",value:function(){return $.a.prototype.getFilter.call(this)}},{key:"setFilter",value:function(t){$.a.prototype.setFilter.call(this,t)}},{key:"isNumberIncluded",value:function(t,e){return!t||(Number.isNaN(e)?!t.filterMissing:!(isFinite(t.min)&&e<t.min||isFinite(t.max)&&e>t.max))}},{key:"filter",value:function(t){var e=this.get_advanced_value(W.a.median,this.getRawValue(t)[0].value);return this.isNumberIncluded(this.getFilter(),e)}},{key:"clearFilter",value:function(){return $.a.prototype.clearFilter.call(this)}}]),n}(Q.a),I.EVENT_MAPPING_CHANGED=$.a.EVENT_MAPPING_CHANGED,I.EVENT_COLOR_MAPPING_CHANGED=$.a.EVENT_COLOR_MAPPING_CHANGED,I.EVENT_SORTMETHOD_CHANGED=$.a.EVENT_SORTMETHOD_CHANGED,I.EVENT_FILTER_CHANGED=$.a.EVENT_FILTER_CHANGED,N=U))||N)||N)||N,tt="ducks/lineUpInput/SET_DUMP",et="ducks/lineUpInput/SET_FILTER",nt="ducks/lineUpInput/UPDATE_FILTER",rt="ducks/lineUpInput/SET_LINEUP",at="ducks/lineUpInput/SET_UPDATE",it={dump:"",filter:null,previousfilter:null,lineup:null,update:0},ot=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:it,e=arguments.length>1?arguments[1]:void 0;switch(e.type){case tt:return Object(b.a)(Object(b.a)({},t),{},{dump:e.input});case et:var n=Object(b.a)({},t.filter);return Object(b.a)(Object(b.a)({},t),{},{previousfilter:n,filter:e.input});case nt:if(t.filter&&Object.keys(t.filter).includes(e.input.key)&&t.filter[e.input.key]===e.input.val_old){var r=Object(b.a)({},G.filter);return r[e.input.key]=e.input.val_new,Object(b.a)(Object(b.a)({},t),{},{filter:r})}return t;case rt:return Object(b.a)(Object(b.a)({},t),{},{lineup:e.input});case at:var a=t.update;return Object(b.a)(Object(b.a)({},t),{},{update:a+1});default:return t}},ut=n(1),st=n(625),ct=Object(g.connect)((function(t){var e,n,r,a;return{lineUpInput:t.lineUpInput,lineUpInput_data:null===(e=t.dataset)||void 0===e?void 0:e.vectors,lineUpInput_columns:null===(n=t.dataset)||void 0===n?void 0:n.columns,currentAggregation:t.currentAggregation,activeStory:s.AStorytelling.getActive(t.stories),pointColorScale:null===(r=t.multiples.multiples.entities[t.multiples.multiples.ids[0]])||void 0===r?void 0:r.attributes.pointColorScale,channelColor:null===(a=t.multiples.multiples.entities[t.multiples.multiples.ids[0]])||void 0===a?void 0:a.attributes.channelColor,detailView:t.detailView}}),(function(t){return{setCurrentAggregation:function(e){return t(Object(s.selectVectors)(e))},setLineUpInput_lineup:function(e){return t(function(t){return{type:rt,input:t}}(e))},setHoverstate:function(e,n){return t(Object(s.setHoverState)(e,n))}}})),lt="unique_ID",ft=ct((function(t){var e,n=t.lineUpInput,r=t.lineUpInput_data,i=t.lineUpInput_columns,o=t.currentAggregation,c=t.channelColor,l=t.setCurrentAggregation,f=t.setLineUpInput_lineup,h=t.activeStory,d=t.pointColorScale,g=t.setHoverstate,b=t.detailView;if(!n||!r||!b.open)return null;var _=a.a.useRef(),x=a.a.useCallback(G.debounce((function(t){return g(t,"lineup")}),200),[]),j=function(t,e){if(e){var n=function(e){var n=t.lineup.data.getFirstRanking();if("selection"===e){var r=n.children.find((function(t){return t.desc.column===lt}));null===r||void 0===r||r.clearFilter()}else{var a=n.children.find((function(t){return t.desc.column===e}));null===a||void 0===a||a.clearFilter()}};for(var r in e)n(r)}};return a.a.useEffect((function(){var t,e,a=function(t){h&&s.ACluster.deriveVectorLabelsFromClusters(t,Object.values(h.clusters.entities));var e=new Array,n={};return t.forEach((function(t){var r={};for(var a in i){var o=i[a];if(!s.EXCLUDED_COLUMNS.includes(a)&&(Object.keys(o.metaInformation).length<=0||!o.metaInformation.noLineUp))if(Object.keys(o.metaInformation).length>0&&o.metaInformation.timeSeriesGroup){var u=o.metaInformation.timeSeriesGroup.split(":");if(u.length<=1)Object.keys(r).includes(o.metaInformation.timeSeriesGroup)?r[o.metaInformation.timeSeriesGroup].push(t[a]):(r[o.metaInformation.timeSeriesGroup]=[t[a]],n[o.metaInformation.timeSeriesGroup]=o,n[o.metaInformation.timeSeriesGroup].metaInformation.listData=!0,n[o.metaInformation.timeSeriesGroup].metaInformation.range=o.metaInformation.globalRange,n[o.metaInformation.timeSeriesGroup].metaInformation.colorMapping=o.metaInformation.colorMapping);else{var c=u[0],l=u[1];Object.keys(r).includes(c)?Object.keys(r[c]).includes(l)?r[c][l].push(t[a]):r[c][l]=[t[a]]:(r[c]={},r[c][l]=[t[a]]),Object.keys(n).includes(c)?(n[c].metaInformation.globalMin=Math.min(n[c].metaInformation.globalMin,t[a]),n[c].metaInformation.globalMax=Math.max(n[c].metaInformation.globalMax,t[a])):(n[c]=o,n[c].metaInformation.customLineChart=!0,n[c].metaInformation.globalMin=t[a],n[c].metaInformation.globalMax=t[a])}}else Object.keys(o.metaInformation).length>0&&o.metaInformation.lineup_meta_column?(r[a]=t[a],n[a]=o,r[o.metaInformation.lineup_meta_column]=t[a],n[o.metaInformation.lineup_meta_column]={metaInformation:{hide:!0}}):(r[a]=t[a],n[a]=o)}r[s.PrebuiltFeatures.ClusterLabel]=t[s.PrebuiltFeatures.ClusterLabel].toString(),r.unique_ID=t.__meta__.meshIndex,e.push(r)})),[e,n]}(r),o=a[0],g=function(t,e,n,r){var a;if((null===r||void 0===r?void 0:r.key)===s.PrebuiltFeatures.ClusterLabel){var i=new s.DiscreteMapping(n,new s.ShallowSet(e.map((function(t){return t[s.PrebuiltFeatures.ClusterLabel]}))));a=i.values.filter((function(t){return t&&""!==t})).map((function(t){return{name:t,color:i.map(t).hex}}))}var o=p.a(e),u=function(n){var r=t[n],i=!0;if(r.metaInformation.imgSmiles){var u="Structure: "+n;ht.push(u),o.column(m.a("mySmilesStructureColumn",n).label(u).renderer("mySmilesStructureRenderer","mySmilesStructureRenderer").width(50).build([]))}else if(r.metaInformation.customLineChart)o.column(m.a("myLineChartColumn",n).label(n).custom("min",r.metaInformation.globalMin).custom("max",r.metaInformation.globalMax).renderer("myLineChartRenderer","myLineChartRenderer").width(150).build([])),dt.push(n);else if(n===s.PrebuiltFeatures.ClusterLabel){var c=v.a(n,a).custom("visible",i).width(70);o.column(c)}else if(r.metaInformation.listData){var l=Object(L.c)(e,{columns:[n]})[0];r.metaInformation.range&&(l.domain=r.metaInformation.range),r.metaInformation.colorMapping&&(Array.isArray(r.metaInformation.colorMapping)?l.colorMapping={type:"custom",entries:r.metaInformation.colorMapping.map((function(t,e){return{color:t,value:e/(r.metaInformation.colorMapping.length-1)}}))}:l.colorMapping=r.metaInformation.colorMapping),o.column(l)}else r.metaInformation.hide||o.deriveColumns(n)};for(var c in t)u(c);return o.column(y.a("Annotations").editable().color(pt)),o.column(y.a(lt).width(50).color(pt)),o.defaultRanking(!0),o.registerRenderer("mySmilesStructureRenderer",new yt),o.registerRenderer("myLineChartRenderer",new vt),o.registerColumnType("mySmilesStructureColumn",mt),o.registerColumnType("myLineChartColumn",K),o.sidePanel(!0,!0),o.livePreviews({filter:!1}),o.dynamicHeight(gt),o.animated(!1),o}(a[1],o,d,c),b=function(t){return t.lineup?(j(t,t.filter),t.lineup.dump()):null}(n);null===(t=n.lineup)||void 0===t||t.destroy(),e=g.buildTaggle(_.current),b&&e.restore(b);var O=e.data.getFirstRanking(),w=O.children.find((function(t){return"Selection Checkboxes"===t.label}));if(w||(w=e.data.create(Object(F.a)()))&&O.insert(w,1),e.on("selectionChanged",(function(t){var e=r.map((function(t,e){if(t.__meta__.selected)return e})).filter((function(t){return void 0!==t}));if(!T(t,e)){var n=new Array;t.forEach((function(t){n.push(r[t].__meta__.meshIndex)})),l(n)}})),e.on("highlightChanged",(function(t){var e;t>=0&&(e=r[t]),x(e)})),ht.length>0||dt.length>0){var C=O.children.filter((function(t){return dt.includes(t.label)}));for(var k in C){C[k].on("widthChanged",(function(t,n){e.update()}))}var E=O.children.filter((function(t){return ht.includes(t.label)})),M=function(t){var n=E[t];n.on("widthChanged",(function(t,n){e.update()}));n.on(D.c.EVENT_FILTER_CHANGED,(function(t,e){if((null===t||void 0===t?void 0:t.filter)!==(null===e||void 0===e?void 0:e.filter)){var a="string"===typeof(null===e||void 0===e?void 0:e.filter)?null===e||void 0===e?void 0:e.filter:null;n&&a&&S.getSubstructureCount(r.map((function(t){return t[n.desc.column]})),a).then((function(t){var r=t.filter((function(t){var e=Object(u.a)(t,2);e[0];return e[1]>0})).map((function(t){var e=Object(u.a)(t,2),n=e[0];e[1];return n}));n.setFilter({filter:a,valid:new Set(r),filterMissing:e.filterMissing})})).catch((function(t){n.setFilter(null)}))}}))};for(var P in E)M(P)}f(e)}),[r,i,h,null===h||void 0===h?void 0:h.clusters,null===h||void 0===h||null===(e=h.clusters)||void 0===e?void 0:e.ids.length,n.update]),a.a.useEffect((function(){if(null!=n.lineup)if(o.aggregation&&o.aggregation.length>0){var t=r.map((function(t,e){if(t.__meta__.selected)return e})).filter((function(t){return void 0!==t}));n.lineup.setSelection(t)}else n.lineup.setSelection([])}),[n.lineup,o]),a.a.useEffect((function(){if(n.lineup&&n.lineup.data){var t=n.lineup.data.getFirstRanking();if(j(n,n.previousfilter),n.filter){var e=function(e){var r=n.filter[e];if("reset"===e&&r)t.clearFilters();else if("selection"===e){var a=t.children.find((function(t){return t.desc.column===lt})),i="";n.filter[e].forEach((function(t){i+="|",i+=t})),i=i.substr(1);var o=new RegExp("^(".concat(i,")$"),"i");null===a||void 0===a||a.setFilter({filter:o,filterMissing:!0})}else{var u=t.children.find((function(t){return t.desc.column===e})),s=new RegExp("^(.+,)?".concat(r,"(,.+)?$"),"i");null===u||void 0===u||u.setFilter({filter:s,filterMissing:!0})}};for(var r in n.filter)e(r)}}}),[n.lineup,n.filter]),Object(ut.jsx)("div",{className:"LineUpParent",children:Object(ut.jsx)("div",{style:{clear:"both",position:"absolute",top:"1px",bottom:0,left:0,right:0,padding:0},ref:_,id:"lineup_view"})})})),ht=new Array,dt=new Array;function gt(t,e){if(ht.length>0){var n=e.children.filter((function(t){return ht.includes(t.label)||dt.includes(t.label)}));if(!n||0===n.length)return{defaultHeight:25,height:function(){return 25},padding:function(){return 0}};var r=n.map((function(t){return dt.includes(t.label)?t.getWidth()/2:t.getWidth()})),a=Math.max(Math.max.apply(Math,Object(d.a)(r)),25);return{defaultHeight:a,height:function(t){return a},padding:function(t){return 0}}}return{defaultHeight:25,height:function(){return 25},padding:function(){return 0}}}var pt="#c1c1c1";var mt=function(t){Object(f.a)(n,t);var e=Object(h.a)(n);function n(){var t;Object(c.a)(this,n);for(var r=arguments.length,a=new Array(r),i=0;i<r;i++)a[i]=arguments[i];return(t=e.call.apply(e,[this].concat(a))).structureFilter=null,t}return Object(l.a)(n,[{key:"filter",value:function(t){return!this.isFiltered()||this.structureFilter.valid.has(this.getLabel(t))}},{key:"isFiltered",value:function(){var t;return null!=this.structureFilter&&(null===(t=this.structureFilter.valid)||void 0===t?void 0:t.size)>0}},{key:"getFilter",value:function(){return this.structureFilter}},{key:"setFilter",value:function(t){st(t,this.structureFilter)||this.fire([D.c.EVENT_FILTER_CHANGED,V.a.EVENT_DIRTY_VALUES,V.a.EVENT_DIRTY],this.structureFilter,this.structureFilter=t)}}]),n}(D.c),vt=function(){function t(){Object(c.a)(this,t),this.title="Line Chart"}return Object(l.a)(t,[{key:"canRender",value:function(t,e){return e===H.a.CELL}},{key:"create",value:function(t){return{template:'<div class="svg-container">\n        <svg class="svg-content" preserveAspectRatio="xMidYMid meet">\n          <g>\n            <path class="areaChart"></path>\n            <path class="lineChart" fill="none" stroke="'.concat(pt,'" stroke-width="0.02px"></path>\n            <g>\n              <line class="focus-line"></line>\n              <line class="value-line-marker"></line>\n            </g>\n            <g>\n              <text style="font-size:0.2px; opacity:0;" class="marker-text">-</text>\n              <text style="font-size:0.2px;" class="focus-text"></text>\n            </g>\n            <rect class="hover-rect"></rect>\n          </g>\n        </svg></div>'),update:function(e,n){if(!Object(z.b)(e,t,n)){var r=t.getMap(n),a=r[0].value,i=r[1].value,o=O.max(a,(function(t){return+t}))+1,u=O.min(a,(function(t){return+t}))-1,s=null,c=null;t.desc.label+"_value"in n.v&&t.desc.label+"_step"in n.v&&(s=n.v[t.desc.label+"_value"],c=n.v[t.desc.label+"_step"],u=Math.min(u,s-.1*s),o=Math.max(o,s+.1*s));var l=O.select(e).select("svg");l.attr("viewBox","0 0 ".concat(2," ").concat(1));var f=O.scaleTime().domain([0,a.length]).range([0,2]),h=O.scaleLinear().domain([u,o]).range([1,0]);l.select(".areaChart").datum(i).attr("fill","#c1c1c14d").attr("stroke","none").attr("d",O.area().x((function(t,e){return f(e)})).y0((function(t,e){return h(a[e]-t)})).y1((function(t,e){return h(a[e]+t)}))),l.select(".lineChart").datum(a).attr("d",O.line().x((function(t,e){return f(e)})).y((function(t){return h(t)}))),null!=s&&null!=c&&(l.select(".value-line-marker").style("fill","none").attr("stroke","#007dad").attr("stroke-width","0.5%").attr("y1","0").attr("y2",1).attr("x1",f(c)).attr("x2",f(c)).style("opacity",1),l.select(".marker-text").style("opacity",1).style("color","#007dad").attr("text-anchor","middle").attr("alignment-baseline","middle").attr("letter-spacing","0px").attr("x",f(c)).attr("y",h(s)));var d=l.select(".focus-line").style("fill","none").attr("stroke","black").attr("stroke-width","1%").attr("y1","0").attr("y2",1).attr("x1","0").attr("x2","0").style("opacity",0),g=l.select(".focus-text").style("opacity",0).attr("text-anchor","left").attr("alignment-baseline","middle").attr("letter-spacing","0px");l.select(".hover-rect").style("fill","none").style("pointer-events","all").attr("width","100%").attr("height","100%").on("mouseover",(function(){d.style("opacity",1),g.style("opacity",1)})).on("mousemove",(function(){var t=O.mouse(this)[0],e=Math.round(f.invert(t));e=Math.max(e,0),e=Math.min(a.length-1,e),d.attr("x1",f(e)).attr("x2",f(e));var n="";e===c&&(n="<tspan x='0' dy='1.2em'>measured: "+Math.round(100*s)/100+"</tspan>");g.html("<tspan x='0' dy='1.2em'>step: "+e+"</tspan><tspan x='0' dy='1.2em'>mean: "+Math.round(100*a[e])/100+"</tspan><tspan x='0' dy='1.2em'>var: "+Math.round(100*i[e])/100+"</tspan>"+n).attr("x",0).attr("y",0)})).on("mouseout",(function(){d.style("opacity",0),g.style("opacity",0)}))}}}}}]),t}(),yt=function(){function t(){Object(c.a)(this,t),this.title="Compound Structure",this.template='<div style="background-size: contain; background-position: center; background-repeat: no-repeat;"></div>'}return Object(l.a)(t,[{key:"canRender",value:function(t,e){return t instanceof mt&&(e===H.a.CELL||e===H.a.GROUP)}},{key:"create",value:function(t){return{template:this.template,update:function(e,n){var r=n.v[t.desc.column];S.getStructureFromSmiles(r,!1,null).then((function(t){t&&t.length>100?e.style.backgroundImage="url('data:image/jpg;base64,".concat(t,"')"):e.innerHTML=t,e.title=P(r)+": "+r}))}}}},{key:"createGroup",value:function(t,e){return{template:this.template,update:function(n,r){var a=new FormData;return e.tasks.groupRows(t,r,"string",(function(e){e.every((function(e){var n=t.getLabel(e);return a.append("smiles_list",n),!0}))})).then((function(){S.getMCSFromSmilesList(a).then((function(t){n.style.backgroundImage="url('data:image/jpg;base64,".concat(t,"')"),n.alt=a.getAll("smiles_list").toString()}))}))}}}}]),t}(),bt=n(495),_t=n(499),xt=n(497),jt=n(498),Ot=n(515),wt=n(496),Ct=n(494);Object(g.connect)(null,(function(t){return{setLineUp_dump:function(e){return t({type:tt,input:e})}}}))((function(t){var e=t.openDialog,n=t.setOpenDumpDialog,r=t.setLineUp_dump,i=a.a.useState(""),o=Object(u.a)(i,2),s=o[0],c=o[1];function l(){n((function(){return!1})),r(s)}return Object(ut.jsxs)(bt.a,{maxWidth:"lg",open:e,onClose:l,children:[Object(ut.jsx)(_t.a,{children:"Specify Modifiers"}),Object(ut.jsxs)(xt.a,{children:[Object(ut.jsx)(jt.a,{children:"Insert Linup JSON dump"}),Object(ut.jsx)(Ot.a,{autoFocus:!0,margin:"dense",id:"modifiers",label:"Modifiers",value:s,onChange:function(t){c(t.target.value)},fullWidth:!0})]}),Object(ut.jsxs)(wt.a,{children:[Object(ut.jsx)(Ct.a,{onClick:l,children:"Cancel"}),Object(ut.jsx)(Ct.a,{onClick:l,children:"Start"})]})]})}));var St,kt=n(147),Et=n(715),Mt=n(501),Tt=n(509),Pt=n(374),At=n.n(Pt),Nt=Object(g.connect)((function(t){return{currentAggregation:t.currentAggregation,lineUpInput:t.lineUpInput}}),(function(t){return{setDetailVisibility:function(e){return t(s.DetailViewActions.setDetailVisibility(e))},setLineUpInput_filter:function(e){return t({type:et,input:e})}}}))((function(t){var e=t.setDetailVisibility,n=t.setLineUpInput_filter,r=t.lineUpInput,i=t.currentAggregation,o=t.splitRef,s=function(t){e(!0),n(t);var r=o.current.split.getSizes();r[1]<2&&o.current.split.setSizes([r[0],70])},c=a.a.useState(!1),l=Object(u.a)(c,2),f=l[0],h=l[1];a.a.useEffect((function(){var t=document.getElementById("cell_value_vis");t||((t=document.createElement("style")).setAttribute("id","cell_value_vis"),t.setAttribute("type","text/css"),(document.head||document.getElementsByTagName("head")[0]).appendChild(t));var e=f?".lu-hover-only { visibility: visible; }":".lu-hover-only { visibility: hidden; }";t.styleSheet?t.styleSheet.cssText=e:(t.innerHTML="",t.appendChild(document.createTextNode(e)))}),[f]);return Object(ut.jsxs)("div",{style:{display:"flex",flexDirection:"column",height:"100%"},children:[Object(ut.jsx)(Et.a,{paddingLeft:2,paddingTop:1,paddingRight:2,children:Object(ut.jsx)(kt.a,{variant:"subtitle2",gutterBottom:!0,children:"LineUp Settings"})}),Object(ut.jsx)(Et.a,{paddingLeft:2,paddingTop:1,paddingRight:2,children:Object(ut.jsx)(Ct.a,{fullWidth:!0,style:{marginRight:2},variant:"outlined",onClick:function(){return s({reset:!0})},children:"Load All"})}),Object(ut.jsx)(Et.a,{paddingLeft:2,paddingTop:1,paddingRight:2,children:Object(ut.jsx)(Ct.a,{fullWidth:!0,variant:"outlined",onClick:function(){return s({selection:i.aggregation})},children:"Load Selection"})}),Object(ut.jsx)(Et.a,{paddingLeft:2,paddingTop:1,paddingRight:2,children:Object(ut.jsx)(Mt.a,{control:Object(ut.jsx)(Tt.a,{color:"primary",value:f,onChange:function(t){h((function(){return!f}))}}),label:"Show Cell Values"})}),Object(ut.jsx)(Et.a,{paddingLeft:2,paddingTop:1,paddingRight:2,children:Object(ut.jsxs)(Ct.a,{fullWidth:!0,variant:"outlined",onClick:function(){r.lineup&&r.lineup.data&&r.lineup.data.exportTable(r.lineup.data.getRankings()[0],{separator:","}).then((function(t){return R(t,"lineup-export.csv","application/csv")}))},children:[Object(ut.jsx)(At.a,{}),"\xa0Export CSV"]})})]})})),It=n(117),Ut=n(110);!function(t){t.MIN="min",t.MAX="max",t.MEDIAN="median",t.MEAN="mean"}(St||(St={}));var Rt=["interpolateCividis","interpolateViridis","interpolateYlGnBu","interpolateYlOrBr","interpolateMagma","interpolateInferno","interpolateWarm","interpolateCool","interpolateBuGn","interpolateGnBu","interpolateOrRd","interpolateYlOrRd","interpolateTurbo"],Ft={value_col:"None",uncertainty_col:"None",cache_cols:null},Dt={aggregateColor:Ft,scale_obj:null,colorscale:Rt[0],useVSUP:!0,valueFilter:[]},Lt={curStep:0},Vt={deriveRange:!0,valueRange:null,uncertaintyRange:null,variableIndex:{valueVariableIndex:0,uncertaintyVariableIndex:0},aggregationMethod:{valueAggregationMethod:St.MAX,uncertaintyAggregationMethod:St.MIN},sampleSize:20},Ht={colormapSettings:Dt,stepperSettings:Lt,advancedSettings:Vt,selectAttribute:null,selectAttributeInfo:null},zt={all:Ht,colormapSettings:Dt,stepperSettings:Lt,advancedSettings:Vt},Gt=Object(It.b)({name:"aggregateSettings",initialState:Ht,reducers:{setSelectAttribute:function(t,e){t.selectAttribute=e.payload.attribute_name,t.selectAttributeInfo=e.payload.attribute_info},setCurStep:function(t,e){t.stepperSettings.curStep=e.payload},setAggregateColor:{reducer:function(t,e){t.colormapSettings.aggregateColor.value_col===e.payload.value_col&&t.colormapSettings.aggregateColor.uncertainty_col===e.payload.uncertainty_col||(t.colormapSettings.scale_obj=null,t.colormapSettings.valueFilter=[],t.colormapSettings.aggregateColor.value_col=e.payload.value_col,t.colormapSettings.aggregateColor.uncertainty_col=e.payload.uncertainty_col,t.colormapSettings.aggregateColor.cache_cols=e.payload.cache_cols)},prepare:function(t){return{payload:null!==t&&void 0!==t?t:Ft}}},setAggregateColorMapScale:function(t,e){t.colormapSettings.valueFilter=[],t.colormapSettings.scale_obj=e.payload},setValueRange:function(t,e){t.advancedSettings.valueRange=e.payload},setUncertaintyRange:function(t,e){t.advancedSettings.uncertaintyRange=e.payload},toggleDeriveRange:function(t){t.advancedSettings.deriveRange=!t.advancedSettings.deriveRange},setDeriveRange:function(t,e){t.advancedSettings.deriveRange=e.payload},setAggregateColorScale:function(t,e){t.colormapSettings.valueFilter=[],t.colormapSettings.colorscale=e.payload},toggleUseVSUP:function(t){t.colormapSettings.valueFilter=[],t.colormapSettings.useVSUP=!t.colormapSettings.useVSUP},addValueFilter:function(t,e){t.colormapSettings.valueFilter.push(e.payload)},removeValueFilter:function(t,e){var n=t.colormapSettings.valueFilter.indexOf(e.payload);-1!==n&&t.colormapSettings.valueFilter.splice(n,1)},clearValueFilter:function(t){t.colormapSettings.valueFilter=[]},setVariableIndex:function(t,e){t.advancedSettings.variableIndex=e.payload},setAggregationMethod:function(t,e){t.advancedSettings.aggregationMethod=e.payload}}}),Jt=Gt.actions,Yt=Jt.setCurStep,Bt=Jt.setSelectAttribute,qt=Jt.setAggregateColor,Wt=Jt.setAggregateColorMapScale,Xt=Jt.setValueRange,$t=Jt.setUncertaintyRange,Qt=Jt.toggleDeriveRange,Zt=Jt.setDeriveRange,Kt=Jt.setAggregateColorScale,te=Jt.toggleUseVSUP,ee=Jt.addValueFilter,ne=Jt.removeValueFilter,re=Jt.clearValueFilter,ae=Jt.setVariableIndex,ie=Jt.setAggregationMethod,oe=Gt.reducer,ue=Object(It.b)({name:"handleDataset",initialState:{triggerUpdate:null},reducers:{setTriggerUpdate:function(t,e){t.triggerUpdate=e.payload}}}),se=ue.actions.setTriggerUpdate,ce=ue.reducer,le=Object(It.b)({name:"mouseInteractionHooks",initialState:{mousemove:null,mousedown:null,mouseclick:null},reducers:{setMouseMove:function(t,e){t.mousemove=e.payload},setMouseClick:function(t,e){t.mouseclick=e.payload}}}),fe=le.actions,he=fe.setMouseMove,de=fe.setMouseClick,ge=le.reducer,pe=Object(It.b)({name:"pacoSettings",initialState:{pacoAttributes:null,pacoConstraints:[],pacoRef:null},reducers:{setPacoAttributes:function(t,e){t.pacoAttributes=e.payload},setPacoConstraints:function(t,e){t.pacoConstraints=e.payload},setPacoRef:function(t,e){t.pacoRef=e.payload}}}),me=pe.actions,ve=me.setPacoAttributes,ye=me.setPacoConstraints,be=me.setPacoRef,_e=pe.reducer,xe=Object(It.b)({name:"selection",initialState:{currentAggregateSelection:null},reducers:{setCurrentAggregateSelection:function(t,e){t.currentAggregateSelection=e.payload}}}),je=xe.actions.setCurrentAggregateSelection,Oe=xe.reducer,we=Object(It.a)("view/resetView"),Ce={resetViews:we},Se={lineUpInput:ot,multiples:Object(s.createViewDuckReducer)({aggregateSettings:oe},(function(t){t.addCase(we,(function(t,e){for(var n in t.multiples.ids){var r=t.multiples.ids[n];t.multiples.entities[r].attributes.aggregateSettings=zt.all}}))})).reducer,mouseInteractionHooks:ge,selection:Oe,handleDataset:ce,pacoSettings:_e};Object(Ut.combineReducers)(Se);var ke=n(340),Ee=Object(g.connect)((function(t){var e,n,r,a,i,o,u,s;return{variableIndex:null===(e=t.multiples.multiples.entities[t.multiples.active])||void 0===e||null===(n=e.attributes.aggregateSettings)||void 0===n?void 0:n.advancedSettings.variableIndex,selectAttribute:null===(r=t.multiples.multiples.entities[t.multiples.active])||void 0===r||null===(a=r.attributes.aggregateSettings)||void 0===a?void 0:a.selectAttribute,selectAttributeInfo:null===(i=t.multiples.multiples.entities[t.multiples.active])||void 0===i||null===(o=i.attributes.aggregateSettings)||void 0===o?void 0:o.selectAttributeInfo,curStep:null===(u=t.multiples.multiples.entities[t.multiples.active])||void 0===u||null===(s=u.attributes.aggregateSettings)||void 0===s?void 0:s.stepperSettings.curStep}}),(function(t){return{setAggregateColor:function(e){return t(qt(e))},setCurStep:function(e){return t(Yt(e))}}}))((function(t){var e=t.selectAttribute,n=t.setAggregateColor,r=t.selectAttributeInfo,i=t.variableIndex,o=t.curStep,s=t.setCurStep,c=a.a.useState([]),l=Object(u.a)(c,2),f=l[0],h=l[1];return a.a.useEffect((function(){var t;if(r){var e=Object.keys(r),n=Object.keys(r[e[0]].temporal_columns);n.sort(),t=n.map((function(t,e){return{value:parseInt(t),label:t}}))}h(t)}),[e,r]),a.a.useEffect((function(){var t=o;if(r&&i){var a=Object.keys(r),u=r[a[i.valueVariableIndex]].temporal_columns[t],s=Object.values(r[a[i.valueVariableIndex]].temporal_columns),c=null;i.valueVariableIndex!==i.uncertaintyVariableIndex&&null!=a[i.uncertaintyVariableIndex]&&(c=r[a[i.uncertaintyVariableIndex]].temporal_columns[t],s=s.concat(Object.values(r[a[i.uncertaintyVariableIndex]].temporal_columns))),n({value_col:u,uncertainty_col:c,cache_cols:s})}else n({value_col:e,uncertainty_col:null,cache_cols:null})}),[o,e,i]),Object(ut.jsx)(ut.Fragment,{children:f&&f.length>0&&Object(ut.jsxs)(ut.Fragment,{children:[Object(ut.jsx)(kt.a,{id:"range-slider",gutterBottom:!0,children:"Choose Step"}),Object(ut.jsx)(ke.h,{min:0,max:f.length-1,value:o,onChange:function(t,e){s(e)},step:1,marks:f,valueLabelDisplay:"auto"})]})})})),Me=n(443),Te=n(451),Pe=n(507),Ae=n(202),Ne=Object(g.connect)((function(t){var e,n,r;return{aggregateSettings:null===(e=t.multiples.multiples.entities[t.multiples.active])||void 0===e?void 0:e.attributes.aggregateSettings,selectAttribute:null===(n=t.multiples.multiples.entities[t.multiples.active])||void 0===n||null===(r=n.attributes.aggregateSettings)||void 0===r?void 0:r.selectAttribute,activeId:t.multiples.active}}),(function(t){return{setAggregateColorScale:function(e){return t(Kt(e))},toggleUseVSUP:function(){return t(te())},addValueFilter:function(e){return t(ee(e))},removeValueFilter:function(e){return t(ne(e))},clearValueFilter:function(){return t(re())},setAggregateColorMapScale:function(e){return t(Wt(e))}}}))((function(t){var e=t.setAggregateColorScale,n=t.selectAttribute,r=t.toggleUseVSUP,i=t.addValueFilter,o=t.removeValueFilter,s=t.clearValueFilter,c=t.aggregateSettings,l=t.setAggregateColorMapScale,f=t.activeId;if(null==n||"None"===n)return null;var h=[0,.1,.2,.3,.4,.5,.6,.7,.8,.9,1],d=a.a.useRef(),g=a.a.useRef(),p=a.a.useState([]),m=Object(u.a)(p,2),v=m[0],y=m[1],b=a.a.useState(null),_=Object(u.a)(b,2),x=_[0],j=_[1];return a.a.useEffect((function(){if(null!=c.advancedSettings.valueRange){var t,e,n,r=[c.advancedSettings.valueRange.min,c.advancedSettings.valueRange.max];if(null==c.advancedSettings.uncertaintyRange)r=(e=O.scaleQuantize().domain(r).range(O.quantize(O[c.colormapSettings.colorscale],8))).domain(),t=Ae.a.simpleLegend(e).title(c.colormapSettings.aggregateColor.value_col);else{var a=[c.advancedSettings.uncertaintyRange.min,c.advancedSettings.uncertaintyRange.max];c.colormapSettings.useVSUP?(n=Ae.b().branching(2).layers(4).valueDomain(r).uncertaintyDomain(a),e=Ae.c().quantize(n).range(O[c.colormapSettings.colorscale]),t=Ae.a.arcmapLegend(e)):(n=Ae.d(4).valueDomain(r).uncertaintyDomain(a),e=Ae.c().quantize(n).range(O[c.colormapSettings.colorscale]),t=Ae.a.heatmapLegend(e)),t.vtitle(c.colormapSettings.aggregateColor.value_col).utitle(c.colormapSettings.aggregateColor.uncertainty_col)}var i=O.precisionFixed((r[1]-r[0])/8);i>2?t.format(".2"):i>0&&t.format("."+i+"r"),j((function(){return t})),l(e)}}),[f,c.colormapSettings.useVSUP,c.advancedSettings.valueRange,c.advancedSettings.uncertaintyRange,c.colormapSettings.colorscale,c.colormapSettings.aggregateColor]),a.a.useEffect((function(){if(null!=x&&d.current&&g.current){var t,e,n,r,a,u=250;x.size(u),null==x.height?(a=u,e=2*(t=25),n=3*t,r=3*t):(e=0,n=2*(t=12.5),r=1.2*(a=x.height()));var s=O.select(d.current);s.html(""),s.call(x);var c=O.select(g.current);c.attr("viewBox","-".concat(t," -").concat(e," ").concat(u+n," ").concat(a+r));var l=c.select(".legend > g:last-child"),f=l.selectAll("path");f.nodes().length<=0&&(f=s.selectAll("rect")),y(f),f.on("mouseover",(function(t,e){l.select(".hover_clone").remove();var n=O.select(f.nodes()[e]).clone();n.attr("class","hover_clone"),n.attr("fill",k),n.on("mouseout",(function(){n.remove()})),n.on("click",(function(){var t=O.select(f.nodes()[e]);null==t.attr("stroke")?(t.attr("stroke",k),t.attr("stroke-width","3px"),i(t.attr("fill"))):(t.attr("stroke",null),t.attr("stroke-width","0px"),o(t.attr("fill")))}))}))}}),[x,d,g]),Object(ut.jsxs)(ut.Fragment,{children:[Object(ut.jsx)(Me.a,{id:"colorscale-select-label",children:"Choose Colormap"}),Object(ut.jsx)(Te.a,{labelId:"colorscale-select-label",id:"colorscale-select",value:c.colormapSettings.colorscale,onChange:function(t){e(t.target.value)},children:Rt.map((function(t){return Object(ut.jsx)(Pe.a,{value:t,title:t,children:Object(ut.jsx)("div",{style:{width:"100%",minWidth:"13rem",height:"1rem",backgroundImage:"linear-gradient(to right, ".concat(h.map((function(e){return O[t](e)})).join(","),")")}})},t)}))}),Object(ut.jsx)("svg",{ref:g,style:{cursor:"pointer"},children:Object(ut.jsx)("g",{ref:d})}),null==(null===x||void 0===x?void 0:x.height)&&Object(ut.jsx)(Ct.a,{variant:"outlined",onClick:function(){r()},children:"Switch Encoding"}),null!=c.colormapSettings.valueFilter&&c.colormapSettings.valueFilter.length>0&&Object(ut.jsx)(Ct.a,{variant:"outlined",onClick:function(){var t;t=v,s(),t.attr("stroke",null),t.attr("stroke-width","0px")},children:"Clear Filter"})]})})),Ie=(n(626),n(539)),Ue=n(541),Re=n(540),Fe=n(440),De=n(722),Le=function(t){var e=t.title,n=t.target,r=t.setRange,a=t.range;return Object(ut.jsxs)(De.a,{paddingTop:1,children:[Object(ut.jsx)(kt.a,{variant:"subtitle2",gutterBottom:!0,children:e}),Object(ut.jsx)(Ot.a,{title:"range minimum for "+n,type:"number",id:"knn-textfield",label:"min",variant:"outlined",onChange:function(t){var e=parseFloat(t.target.value),n=Object(b.a)({},a);!isNaN(e)&&e<a.max?(n.min=e,r(n)):(n.min=n.max,r(n))},style:{width:"50%"},size:"small",value:a.min}),Object(ut.jsx)(Ot.a,{title:"range maximum for "+n,type:"number",id:"knn-textfield",label:"max",variant:"outlined",onChange:function(t){var e=parseFloat(t.target.value),n=Object(b.a)({},a);!isNaN(e)&&e>a.min?(n.max=e,r(n)):(n.max=n.min,r(n))},style:{width:"50%"},size:"small",value:a.max})]})},Ve=Object(g.connect)((function(t){var e,n,r,a,i;return{aggregateSettings:null===(e=t.multiples.multiples.entities[t.multiples.active])||void 0===e?void 0:e.attributes.aggregateSettings,selectAttribute:null===(n=t.multiples.multiples.entities[t.multiples.active])||void 0===n||null===(r=n.attributes.aggregateSettings)||void 0===r?void 0:r.selectAttribute,selectAttributeInfo:null===(a=t.multiples.multiples.entities[t.multiples.active])||void 0===a||null===(i=a.attributes.aggregateSettings)||void 0===i?void 0:i.selectAttributeInfo}}),(function(t){return{setValueRange:function(e){return t(Xt(e))},setUncertaintyRange:function(e){return t($t(e))},toggleDeriveRange:function(){return t(Qt())},setDeriveRange:function(e){return t(Zt(e))},setVariableIndex:function(e){return t(ae(e))},setAggregationMethod:function(e){return t(ie(e))}}}))((function(t){var e=t.selectAttribute,n=t.setValueRange,r=t.setUncertaintyRange,i=t.toggleDeriveRange,o=t.selectAttributeInfo,u=t.setVariableIndex,s=t.setAggregationMethod,c=t.aggregateSettings;return null==e||"None"===e?null:(a.a.useEffect((function(){if(o){var t=Object.keys(o);1===t.length?u({valueVariableIndex:0,uncertaintyVariableIndex:0}):t.length>1&&u({valueVariableIndex:0,uncertaintyVariableIndex:1})}}),[o]),Object(ut.jsxs)(ut.Fragment,{children:[Object(ut.jsxs)(De.a,{paddingTop:1,children:[Object(ut.jsx)(Mt.a,{control:Object(ut.jsx)(Ie.a,{checked:c.advancedSettings.deriveRange,onChange:function(){i()},title:"Derive Range from Data"}),label:"Derive Range from Data"}),null!=c.advancedSettings.valueRange&&!c.advancedSettings.deriveRange&&Object(ut.jsx)(Le,{title:"Customize Range for "+c.colormapSettings.aggregateColor.value_col,target:"value",range:c.advancedSettings.valueRange,setRange:n}),null!=c.advancedSettings.uncertaintyRange&&!c.advancedSettings.deriveRange&&Object(ut.jsx)(Le,{title:"Customize Range for "+c.colormapSettings.aggregateColor.uncertainty_col,target:"uncertainty",range:c.advancedSettings.uncertaintyRange,setRange:r})]}),null!=o?Object(ut.jsx)(De.a,{paddingTop:1,sx:{flexGrow:1},children:Object(ut.jsxs)(ut.Fragment,{children:[Object(ut.jsxs)(Ue.a,{container:!0,columns:{xs:3},children:[Object(ut.jsx)(Ue.a,{item:!0,xs:1}),Object(ut.jsx)(Ue.a,{item:!0,xs:1,children:"value"}),Object(ut.jsx)(Ue.a,{item:!0,xs:1,children:"uncertainty"})]}),Object.keys(o).map((function(t,e){return Object(ut.jsxs)(Ue.a,{container:!0,columns:{xs:3},children:[Object(ut.jsx)(Ue.a,{item:!0,xs:1,children:t}),Object(ut.jsx)(Ue.a,{item:!0,xs:1,children:Object(ut.jsx)(Re.a,{onChange:function(t){t.target.checked&&u({valueVariableIndex:e,uncertaintyVariableIndex:c.advancedSettings.variableIndex.uncertaintyVariableIndex})},checked:e===c.advancedSettings.variableIndex.valueVariableIndex})}),Object(ut.jsx)(Ue.a,{item:!0,xs:1,children:Object(ut.jsx)(Re.a,{onChange:function(t){t.target.checked&&u({valueVariableIndex:c.advancedSettings.variableIndex.valueVariableIndex,uncertaintyVariableIndex:e})},checked:e===c.advancedSettings.variableIndex.uncertaintyVariableIndex})})]},t)})),Object(ut.jsxs)(Ue.a,{container:!0,columns:{xs:3},children:[Object(ut.jsx)(Ue.a,{item:!0,xs:1}),Object(ut.jsx)(Ue.a,{item:!0,xs:1,children:Object(ut.jsxs)(Fe.a,{children:[Object(ut.jsx)(Me.a,{id:"selectValueAggregation",children:"Agg"}),Object(ut.jsx)(Te.a,{labelId:"selectValueAggregation",value:c.advancedSettings.aggregationMethod.valueAggregationMethod,label:"Value Aggregation",onChange:function(t){s({valueAggregationMethod:t.target.value,uncertaintyAggregationMethod:c.advancedSettings.aggregationMethod.uncertaintyAggregationMethod})},children:Object.values(St).map((function(t){return Object(ut.jsx)(Pe.a,{value:t,children:t},t)}))})]})}),Object(ut.jsx)(Ue.a,{item:!0,xs:1,children:Object(ut.jsxs)(Fe.a,{children:[Object(ut.jsx)(Me.a,{id:"selectUncertaintyAggregation",children:"Agg"}),Object(ut.jsx)(Te.a,{labelId:"selectUncertaintyAggregation",value:c.advancedSettings.aggregationMethod.uncertaintyAggregationMethod,label:"Uncertainty Aggregation",onChange:function(t){s({valueAggregationMethod:c.advancedSettings.aggregationMethod.valueAggregationMethod,uncertaintyAggregationMethod:t.target.value})},children:Object.values(St).map((function(t){return Object(ut.jsx)(Pe.a,{value:t,children:t},t)}))})]})})]})]})}):Object(ut.jsxs)(De.a,{paddingTop:1,children:[Object(ut.jsx)(kt.a,{variant:"subtitle2",gutterBottom:!0,children:"Select value aggregation function"}),Object(ut.jsxs)(Fe.a,{children:[Object(ut.jsx)(Me.a,{id:"selectValueAggregation",children:"Agg"}),Object(ut.jsx)(Te.a,{labelId:"selectValueAggregation",value:c.advancedSettings.aggregationMethod.valueAggregationMethod,label:"Value Aggregation",onChange:function(t){s({valueAggregationMethod:t.target.value,uncertaintyAggregationMethod:c.advancedSettings.aggregationMethod.uncertaintyAggregationMethod})},children:Object.values(St).map((function(t){return Object(ut.jsx)(Pe.a,{value:t,children:t},t)}))})]})]})]}))})),He=Object(g.connect)((function(t){return{dataset:t.dataset,globalLabels:t.globalLabels}}),(function(t){return{}}))((function(t){var e,n,r=t.dataset,i=t.globalLabels,o=t.variant,s=a.a.useState(-1),c=Object(u.a)(s,2),l=c[0],f=c[1];a.a.useEffect((function(){null!=r&&S.loadNODatapoints(r.info.path).then((function(t){f(t.no_datapoints)}))}),[r]);var h="";switch(o){case"all":h="Showing all ".concat(l," ").concat(i.itemLabelPlural," as aggregation");break;case"filterOutOfTotal":h="Currently showing ".concat(null===r||void 0===r||null===(e=r.vectors)||void 0===e?void 0:e.length," out of ").concat(l," ").concat(i.itemLabelPlural," (~").concat(Math.round((null===r||void 0===r||null===(n=r.vectors)||void 0===n?void 0:n.length)/l*1e4)/100,"% of the dataset)")}return l>=0&&Object(ut.jsx)(kt.a,{color:"textSecondary",variant:"body2",children:h})})),ze=Object(g.connect)((function(t){var e,n;return{poiDataset:t.dataset,selectAttribute:null===(e=t.multiples.multiples.entities[t.multiples.active])||void 0===e||null===(n=e.attributes.aggregateSettings)||void 0===n?void 0:n.selectAttribute,globalLabels:t.globalLabels}}),(function(t){return{setSelectAttribute:function(e,n){return t(Bt({attribute_name:e,attribute_info:n}))},setValueRange:function(e){return t(Xt(e))},setUncertaintyRange:function(e){return t($t(e))},setDeriveRange:function(e){return t(Zt(e))}}}))((function(t){var e=t.poiDataset,n=t.selectAttribute,r=t.setSelectAttribute,i=a.a.useState(null),o=Object(u.a)(i,2),c=o[0],l=o[1],f=a.a.useState(null),h=Object(u.a)(f,2),d=h[0],g=h[1],p=a.a.useState(null),m=Object(u.a)(p,2),v=m[0],y=m[1];return a.a.useEffect((function(){Xt(null),$t(null),Zt(!0)}),[n]),a.a.useEffect((function(){var t={},n=Object(b.a)({},null===e||void 0===e?void 0:e.columns);if(null!=e&&null!=e.columns){Object.keys(e.columns).forEach((function(r){var a=e.columns[r];if(Object.keys(a.metaInformation).length>0&&a.metaInformation.timeSeriesGroup){var i,o,u=a.metaInformation.timeSeriesGroup.split(":");if(u.length<=1?(i=a.metaInformation.timeSeriesGroup,o=a.metaInformation.timeSeriesGroup):(i=u[0],o=u[1]),Object.keys(t).includes(i))if(Object.keys(t[i]).includes(o))t[i][o].temporal_columns[a.metaInformation.timestep]=r;else{var s={};s[a.metaInformation.timestep]=r,t[i][o]={temporal_columns:s}}else{var c={};c[a.metaInformation.timestep]=r,t[i]={},t[i][o]={temporal_columns:c}}n[i]={featureLabel:"Timeseries",distinct:void 0,featureType:void 0,isNumeric:void 0,metaInformation:void 0,project:void 0,range:void 0}}else a.metaInformation.real_column&&a.isNumeric&&!["x","y"].includes(r)&&(t[r]=null)})),y(n),g(t);var r=Object.keys(t);r.sort(),l(r)}}),[e]),Object(ut.jsxs)("div",{style:{display:"flex",flexDirection:"column",height:"100%"},children:[Object(ut.jsx)(Et.a,{paddingLeft:2,paddingTop:1,paddingRight:2,children:Object(ut.jsx)(He,{variant:"all"})}),Object(ut.jsx)(Et.a,{paddingLeft:2,paddingTop:1,paddingRight:2,children:null!=c&&Object(ut.jsx)(s.SelectFeatureComponent,{column_info:v,label:"color",default_val:n,categoryOptions:c,onChange:function(t){var e=t;null==e&&(e="None"),null!=d&&Object.keys(d).includes(e)?r(e,d[e]):r(e,null)}})}),Object(ut.jsx)(Et.a,{paddingLeft:2,paddingTop:1,paddingRight:2,children:Object(ut.jsx)(Ee,{})}),Object(ut.jsx)(Et.a,{paddingLeft:2,paddingTop:1,paddingRight:2,children:Object(ut.jsx)(Ne,{})}),Object(ut.jsx)(Et.a,{paddingLeft:2,paddingTop:1,paddingRight:2,children:Object(ut.jsx)(Ve,{})})]})})),Ge=n(508);var Je=function(){function t(){Object(c.a)(this,t),this.vectors=[],this.datasetType=s.DatasetType.None,this.loadingArea="global_loading_indicator"}return Object(l.a)(t,[{key:"resolvePath",value:function(t,e,n,r,a){var i=this;t.uploaded?this.loadPOICSV(e,t,n,r,a):Object(w.trackPromise)(fetch(t.path,{signal:null===a||void 0===a?void 0:a.signal}).then((function(t){return t.blob()})).then((function(t){return i.resolveContent(t,e,n,r,a)})).catch((function(t){console.log(t)})),this.loadingArea)}},{key:"resolveContent",value:function(t,e,n,r,a){var i=this,o=n?n(S.upload_csv_file(t,a),a):S.upload_csv_file(t,a);Object(w.trackPromise)(o.then((function(t){i.loadPOICSV(e,{display:"",type:i.datasetType,path:t.id},n,r,a)})).catch((function(t){console.log(t)})),this.loadingArea)}},{key:"loadPOICSV",value:function(t,e,n,r,a){var i=this,o=S.baseUrl+"/get_poi_csv/"+e.path,u=n?n(O.csv(o,Object(b.a)(Object(b.a)({},S.fetchParams),{},{signal:null===a||void 0===a?void 0:a.signal})),a):O.csv(o,Object(b.a)(Object(b.a)({},S.fetchParams),{},{signal:null===a||void 0===a?void 0:a.signal}));Object(w.trackPromise)(u.then((function(n){n.length<=0?(console.log("Dataset is empty"),alert("Dataset is empty")):(i.vectors=function(t){return t.map((function(t){return s.AVector.create(t)}))}(n),i.datasetType=s.DatasetType.Chem,(new s.CSVLoader).resolve(t,i.vectors,i.datasetType,e))})).catch((function(t){console.log(t)})),this.loadingArea)}}]),t}(),Ye=function(t){var e=t.onDatasetChange,n=t.cancellablePromise,r=t.abort_controller;return Object(ut.jsx)(Ue.a,{container:!0,item:!0,alignItems:"stretch",justifyContent:"center",direction:"column",style:{padding:"16px"},children:Object(ut.jsx)(s.DragAndDrop,{accept:".csv",handleDrop:function(t){if(!(null==t||t.length<=0)){var a=t[0];a.name.endsWith("csv")&&(new Je).resolveContent(a,e,n,r)}},children:Object(ut.jsx)("div",{style:{height:200}})})})},Be=n(551),qe=n.n(Be),We=n(502),Xe=n(493),$e=n(503),Qe=n(506),Ze=n(444),Ke=n(492),tn=n(193),en=n.n(tn),nn=n(552),rn=n.n(nn),an="update_uploaded_files_list",on=function(t){var e=t.onChange,n=t.refresh,r=a.a.useState([]),i=Object(u.a)(r,2),o=i[0],c=i[1],l=Object(s.useCancellablePromise)().cancellablePromise,f=function(){Object(w.trackPromise)(l(S.getUploadedFiles()).then((function(t){c(null!==t&&void 0!==t?t:[])})).catch((function(t){return console.log(t)})),an)};a.a.useEffect((function(){f()}),[n]);return o&&Object(ut.jsx)("div",{children:Object(ut.jsxs)(Ue.a,{item:!0,style:{overflowY:"auto",flex:"1 1 auto",maxHeight:"400px"},children:[Object(ut.jsxs)(We.a,{subheader:Object(ut.jsx)("li",{}),style:{backgroundColor:"white"},children:[!Fr&&Object(ut.jsxs)(Xe.a,{children:["Uploaded Files"," ",Object(ut.jsx)(Ct.a,{onClick:function(){return f()},children:Object(ut.jsx)(rn.a,{style:{fontSize:"1.25rem"}})})]}),Fr&&Object(ut.jsx)(Xe.a,{children:"Select Dataset"}),o.map((function(t){return Object(ut.jsxs)($e.a,{button:!0,onClick:function(){var n;n={display:t,path:t,type:s.DatasetType.Chem,uploaded:!0},e(n)},children:[Object(ut.jsx)(Qe.a,{primary:t}),!Fr&&Object(ut.jsx)(Ze.a,{onClick:function(){!function(t){l(S.deleteFile(t)).then((function(e){e&&"true"===e.deleted&&c(o.filter((function(e){return e!==t})))})).catch((function(t){return console.log(t)}))}(t)},children:Object(ut.jsx)(Ke.a,{edge:"end","aria-label":"delete",children:Object(ut.jsx)(en.a,{})})})]},t)}))]}),Object(ut.jsx)(ln,{area:an})]})})},un=n(553),sn=n.n(un);function cn(t,e){var n,r,a=null!==(n=e.xChannel)&&void 0!==n?n:"x",i=null!==(r=e.xChannel)&&void 0!==r?r:"y";return t.vectors.map((function(t){return{x:a?t[a]:0,y:i?t[i]:0}}))}var ln=function(t){return Object(w.usePromiseTracker)({area:t.area}).promiseInProgress&&Object(ut.jsx)("div",{style:{width:"100%",height:"100",display:"flex",justifyContent:"center",alignItems:"center"},children:Object(ut.jsx)(qe.a,{type:"ThreeDots",color:"#2BAD60",height:"100",width:"100"})})},fn=function(t){var e=Object(w.usePromiseTracker)({area:t.area}).promiseInProgress;return Object(ut.jsxs)(bt.a,{maxWidth:"lg",open:e,children:[" ",Object(ut.jsx)(xt.a,{children:Object(ut.jsx)(ln,{area:t.area})}),Object(ut.jsx)(wt.a,{children:Object(ut.jsx)(Ct.a,{onClick:t.handleClose,children:"Cancel"})})]})},hn=Object(g.connect)((function(t){return{}}),(function(t){return{setTriggerUpdate:function(e){return t(se(e))},resetViews:function(){return t(Ce.resetViews())},hydrateState:function(e){return t(s.RootActions.hydrate(e))}}}))((function(t){var e=t.onDataSelected,n=t.resetViews,i=t.setTriggerUpdate,o=t.hydrateState,c=Object(s.useCancellablePromise)(),l=c.cancellablePromise,f=c.cancelPromises,h=new AbortController,d=Object(r.useState)(0),g=Object(u.a)(d,2),p=g[0],m=g[1],v=a.a.useRef(),y=function(t,r){n(),e(t),null!=r&&o(r)},_=function(t,e){var n=null;null!=e&&(n=s.UtilityActions.partialDump(e,["dataset","activeLine","currentAggregation","genericFingerprintAttributes","handleDataset","highlightedSequence","hoverState","mouseInteractionHooks","projectionColumns","projects","interfaceState","selectedLineBy"])),(new Je).resolvePath(t,(function(t){if(null!=n){var r=Object(b.a)({},n.multiples.projections.entities);for(var a in n.multiples.multiples.ids){var i=n.multiples.multiples.ids[a],o=n.multiples.multiples.entities[i].attributes.workspace,u=cn(t,e.multiples.multiples.entities[i].attributes.workspace),s=Object(b.a)({},r[o]);s.positions=u,r[o]=s}var c=Object(b.a)(Object(b.a)({},n.multiples.projections),{},{entities:r}),l=Object(b.a)(Object(b.a)({},n.multiples),{},{projections:c});n=Object(b.a)(Object(b.a)({},n),{},{multiples:l})}y(t,n)}),l,null,h)};return a.a.useEffect((function(){i(_)}),[]),Object(ut.jsxs)("div",{style:{display:"flex",flexDirection:"column",height:"100%"},children:[Object(ut.jsx)(Et.a,{paddingLeft:2,paddingTop:2,children:Object(ut.jsx)(kt.a,{variant:"subtitle2",gutterBottom:!0,children:"Custom Datasets (Drag and Drop)"})}),Object(ut.jsx)(Ye,{onDatasetChange:function(t){y(t),m(p+1)},cancellablePromise:l,abort_controller:h}),Object(ut.jsx)(Et.a,{paddingLeft:2,paddingTop:2,children:Object(ut.jsx)(kt.a,{variant:"subtitle2",gutterBottom:!0,children:"Predefined Datasets"})}),Object(ut.jsx)(on,{onChange:function(t){_(t)},refresh:p}),Object(ut.jsx)(fn,{handleClose:function(){f()},area:"global_loading_indicator"}),Object(ut.jsx)("input",{style:{display:"none"},accept:".csv",ref:v,type:"file",onChange:function(t){!function(t){if(!(null==t||t.length<=0)){var e=t[0],n=new FileReader;n.onload=function(t){localStorage.setItem("smiles_lookup",t.target.result.toString()),alert("Successfuly uploaded")},n.readAsBinaryString(e)}}(t.target.files)}}),Object(ut.jsx)(Et.a,{paddingLeft:2,paddingTop:2,paddingRight:2,children:Object(ut.jsx)(Ge.a,{title:'Select a lookup table for shortnames of molecules. It has to be a csv-file with the columns "smiles" and "shortname".',children:Object(ut.jsxs)(Ct.a,{fullWidth:!0,variant:"outlined","aria-label":"Define lookup table for shortnames of SMILES",color:"primary",onClick:function(){return v.current.click()},children:[Object(ut.jsx)(sn.a,{}),"\xa0Define lookup table"]})})})]})})),dn=n(554),gn=n.n(dn);function pn(){return gn()('/*! For license information please see remote.worker.8fe021bc.worker.js.LICENSE.txt */\n!function(t){var e={};function n(r){if(e[r])return e[r].exports;var i=e[r]={i:r,l:!1,exports:{}};return t[r].call(i.exports,i,i.exports,n),i.l=!0,i.exports}n.m=t,n.c=e,n.d=function(t,e,r){n.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:r})},n.r=function(t){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},n.t=function(t,e){if(1&e&&(t=n(t)),8&e)return t;if(4&e&&"object"===typeof t&&t&&t.__esModule)return t;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var i in t)n.d(r,i,function(e){return t[e]}.bind(null,i));return r},n.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return n.d(e,"a",e),e},n.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},n.p="/jku-vds-lab/reaction-cime/",n(n.s=35)}([function(t,e,n){t.exports=n(29)},,,,,,,function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),Object.defineProperty(e,"trackPromise",{enumerable:!0,get:function(){return r.trackPromise}}),Object.defineProperty(e,"manuallyResetPromiseCounter",{enumerable:!0,get:function(){return r.manuallyResetPromiseCounter}}),Object.defineProperty(e,"manuallyDecrementPromiseCounter",{enumerable:!0,get:function(){return r.manuallyDecrementPromiseCounter}}),Object.defineProperty(e,"manuallyIncrementPromiseCounter",{enumerable:!0,get:function(){return r.manuallyIncrementPromiseCounter}}),Object.defineProperty(e,"promiseTrackerHoc",{enumerable:!0,get:function(){return i.promiseTrackerHoc}}),Object.defineProperty(e,"usePromiseTracker",{enumerable:!0,get:function(){return o.usePromiseTracker}});var r=n(13),i=n(31),o=n(34)},,,,,,function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.manuallyIncrementPromiseCounter=e.manuallyDecrementPromiseCounter=e.manuallyResetPromiseCounter=e.trackPromise=e.getCounter=e.promiseCounterUpdateEventId=e.emitter=void 0;var r=n(30),i=n(16);var o=new r.Emitter;e.emitter=o;var a="promise-counter-update";e.promiseCounterUpdateEventId=a;var u,s,c,l=(u={},s=i.defaultArea,c=0,s in u?Object.defineProperty(u,s,{value:c,enumerable:!0,configurable:!0,writable:!0}):u[s]=c,u);e.getCounter=function(t){return l[t]};e.trackPromise=function(t,e){e=e||i.defaultArea,f(e);var n=function(){return d(e)};return t.then(n,n),t};var f=function(t){h(t);var e=p(t);o.emit(a,e,t)},h=function(t){Boolean(l[t])?l[t]++:l[t]=1},p=function(t){return l[t]>0},d=function(t){l[t]>0&&g(t);var e=p(t);o.emit(a,e,t)},g=function(t){l[t]--};e.manuallyResetPromiseCounter=function(t){t=t||i.defaultArea,l[t]=0,o.emit(a,!1,t)};e.manuallyDecrementPromiseCounter=function(t){t=t||i.defaultArea,d(t)};e.manuallyIncrementPromiseCounter=function(t){t=t||i.defaultArea,f(t)}},,,function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.defaultArea=void 0;e.defaultArea="default-area"},function(t,e,n){"use strict";t.exports=n(32)},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.setupConfig=e.defaultConfig=void 0;var r=n(16),i={area:r.defaultArea,delay:0};e.defaultConfig=i;e.setupConfig=function(t){return{area:t&&t.area?t.area:r.defaultArea,delay:t&&t.delay?t.delay:0}}},,,,,,,,,,,function(t,e,n){var r=function(t){"use strict";var e,n=Object.prototype,r=n.hasOwnProperty,i="function"===typeof Symbol?Symbol:{},o=i.iterator||"@@iterator",a=i.asyncIterator||"@@asyncIterator",u=i.toStringTag||"@@toStringTag";function s(t,e,n){return Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{s({},"")}catch(N){s=function(t,e,n){return t[e]=n}}function c(t,e,n,r){var i=e&&e.prototype instanceof v?e:v,o=Object.create(i.prototype),a=new T(r||[]);return o._invoke=function(t,e,n){var r=f;return function(i,o){if(r===p)throw new Error("Generator is already running");if(r===d){if("throw"===i)throw o;return S()}for(n.method=i,n.arg=o;;){var a=n.delegate;if(a){var u=P(a,n);if(u){if(u===g)continue;return u}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(r===f)throw r=d,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);r=p;var s=l(t,e,n);if("normal"===s.type){if(r=n.done?d:h,s.arg===g)continue;return{value:s.arg,done:n.done}}"throw"===s.type&&(r=d,n.method="throw",n.arg=s.arg)}}}(t,n,a),o}function l(t,e,n){try{return{type:"normal",arg:t.call(e,n)}}catch(N){return{type:"throw",arg:N}}}t.wrap=c;var f="suspendedStart",h="suspendedYield",p="executing",d="completed",g={};function v(){}function y(){}function m(){}var _={};s(_,o,(function(){return this}));var w=Object.getPrototypeOf,b=w&&w(w(O([])));b&&b!==n&&r.call(b,o)&&(_=b);var x=m.prototype=v.prototype=Object.create(_);function C(t){["next","throw","return"].forEach((function(e){s(t,e,(function(t){return this._invoke(e,t)}))}))}function M(t,e){function n(i,o,a,u){var s=l(t[i],t,o);if("throw"!==s.type){var c=s.arg,f=c.value;return f&&"object"===typeof f&&r.call(f,"__await")?e.resolve(f.__await).then((function(t){n("next",t,a,u)}),(function(t){n("throw",t,a,u)})):e.resolve(f).then((function(t){c.value=t,a(c)}),(function(t){return n("throw",t,a,u)}))}u(s.arg)}var i;this._invoke=function(t,r){function o(){return new e((function(e,i){n(t,r,e,i)}))}return i=i?i.then(o,o):o()}}function P(t,n){var r=t.iterator[n.method];if(r===e){if(n.delegate=null,"throw"===n.method){if(t.iterator.return&&(n.method="return",n.arg=e,P(t,n),"throw"===n.method))return g;n.method="throw",n.arg=new TypeError("The iterator does not provide a \'throw\' method")}return g}var i=l(r,t.iterator,n.arg);if("throw"===i.type)return n.method="throw",n.arg=i.arg,n.delegate=null,g;var o=i.arg;return o?o.done?(n[t.resultName]=o.value,n.next=t.nextLoc,"return"!==n.method&&(n.method="next",n.arg=e),n.delegate=null,g):o:(n.method="throw",n.arg=new TypeError("iterator result is not an object"),n.delegate=null,g)}function k(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function E(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function T(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(k,this),this.reset(!0)}function O(t){if(t){var n=t[o];if(n)return n.call(t);if("function"===typeof t.next)return t;if(!isNaN(t.length)){var i=-1,a=function n(){for(;++i<t.length;)if(r.call(t,i))return n.value=t[i],n.done=!1,n;return n.value=e,n.done=!0,n};return a.next=a}}return{next:S}}function S(){return{value:e,done:!0}}return y.prototype=m,s(x,"constructor",m),s(m,"constructor",y),y.displayName=s(m,u,"GeneratorFunction"),t.isGeneratorFunction=function(t){var e="function"===typeof t&&t.constructor;return!!e&&(e===y||"GeneratorFunction"===(e.displayName||e.name))},t.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,m):(t.__proto__=m,s(t,u,"GeneratorFunction")),t.prototype=Object.create(x),t},t.awrap=function(t){return{__await:t}},C(M.prototype),s(M.prototype,a,(function(){return this})),t.AsyncIterator=M,t.async=function(e,n,r,i,o){void 0===o&&(o=Promise);var a=new M(c(e,n,r,i),o);return t.isGeneratorFunction(n)?a:a.next().then((function(t){return t.done?t.value:a.next()}))},C(x),s(x,u,"Generator"),s(x,o,(function(){return this})),s(x,"toString",(function(){return"[object Generator]"})),t.keys=function(t){var e=[];for(var n in t)e.push(n);return e.reverse(),function n(){for(;e.length;){var r=e.pop();if(r in t)return n.value=r,n.done=!1,n}return n.done=!0,n}},t.values=O,T.prototype={constructor:T,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=e,this.done=!1,this.delegate=null,this.method="next",this.arg=e,this.tryEntries.forEach(E),!t)for(var n in this)"t"===n.charAt(0)&&r.call(this,n)&&!isNaN(+n.slice(1))&&(this[n]=e)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var n=this;function i(r,i){return u.type="throw",u.arg=t,n.next=r,i&&(n.method="next",n.arg=e),!!i}for(var o=this.tryEntries.length-1;o>=0;--o){var a=this.tryEntries[o],u=a.completion;if("root"===a.tryLoc)return i("end");if(a.tryLoc<=this.prev){var s=r.call(a,"catchLoc"),c=r.call(a,"finallyLoc");if(s&&c){if(this.prev<a.catchLoc)return i(a.catchLoc,!0);if(this.prev<a.finallyLoc)return i(a.finallyLoc)}else if(s){if(this.prev<a.catchLoc)return i(a.catchLoc,!0)}else{if(!c)throw new Error("try statement without catch or finally");if(this.prev<a.finallyLoc)return i(a.finallyLoc)}}}},abrupt:function(t,e){for(var n=this.tryEntries.length-1;n>=0;--n){var i=this.tryEntries[n];if(i.tryLoc<=this.prev&&r.call(i,"finallyLoc")&&this.prev<i.finallyLoc){var o=i;break}}o&&("break"===t||"continue"===t)&&o.tryLoc<=e&&e<=o.finallyLoc&&(o=null);var a=o?o.completion:{};return a.type=t,a.arg=e,o?(this.method="next",this.next=o.finallyLoc,g):this.complete(a)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),g},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var n=this.tryEntries[e];if(n.finallyLoc===t)return this.complete(n.completion,n.afterLoc),E(n),g}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var n=this.tryEntries[e];if(n.tryLoc===t){var r=n.completion;if("throw"===r.type){var i=r.arg;E(n)}return i}}throw new Error("illegal catch attempt")},delegateYield:function(t,n,r){return this.delegate={iterator:O(t),resultName:n,nextLoc:r},"next"===this.method&&(this.arg=e),g}},t}(t.exports);try{regeneratorRuntime=r}catch(i){"object"===typeof globalThis?globalThis.regeneratorRuntime=r:Function("r","regeneratorRuntime = r")(r)}},function(t,e,n){"use strict";function r(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}Object.defineProperty(e,"__esModule",{value:!0}),e.Emitter=void 0;var i=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t)}var e,n,i;return e=t,n=[{key:"emit",value:function(t){if(!t)return this;for(var e=arguments.length,n=new Array(e>1?e-1:0),r=1;r<e;r++)n[r-1]=arguments[r];var i=!0,o=!1,a=void 0;try{for(var u,s=this._e(t)[Symbol.iterator]();!(i=(u=s.next()).done);i=!0){var c=u.value;c.apply(c.ctx,[].concat(n)),1==c.off_event&&this.off(t,c)}}catch(l){o=!0,a=l}finally{try{i||null==s.return||s.return()}finally{if(o)throw a}}return this}},{key:"on",value:function(t,e,n){return t?(e.ctx=n,this._e(t).push(e),this):this}},{key:"once",value:function(t,e,n){return t?(e.ctx=n,e.off_event=!0,this.on(t,e)):this}},{key:"off",value:function(t,e){if(!t)return this;if(!this[t])return this;var n=this._e(t);return e?(this[t]=n.filter((function(t){return t!=e})),this):(delete this[t],this)}},{key:"_e",value:function(t){return this[t]||(this[t]=[])}}],n&&r(e.prototype,n),i&&r(e,i),t}();e.Emitter=i},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.promiseTrackerHoc=void 0;var r=function(t){if(t&&t.__esModule)return t;if(null===t||"object"!==u(t)&&"function"!==typeof t)return{default:t};var e=a();if(e&&e.has(t))return e.get(t);var n={},r=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var i in t)if(Object.prototype.hasOwnProperty.call(t,i)){var o=r?Object.getOwnPropertyDescriptor(t,i):null;o&&(o.get||o.set)?Object.defineProperty(n,i,o):n[i]=t[i]}n.default=t,e&&e.set(t,n);return n}(n(17)),i=n(13),o=n(18);function a(){if("function"!==typeof WeakMap)return null;var t=new WeakMap;return a=function(){return t},t}function u(t){return u="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"===typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},u(t)}function s(){return s=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},s.apply(this,arguments)}function c(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function l(t){return l=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)},l(t)}function f(t){if(void 0===t)throw new ReferenceError("this hasn\'t been initialised - super() hasn\'t been called");return t}function h(t,e){return h=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t},h(t,e)}e.promiseTrackerHoc=function(t){return function(e){function n(t){var e;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,n),(e=function(t,e){return!e||"object"!==u(e)&&"function"!==typeof e?f(t):e}(this,l(n).call(this,t))).state={promiseInProgress:!1,internalPromiseInProgress:!1,config:(0,o.setupConfig)(t.config)},e.notifyPromiseInProgress=e.notifyPromiseInProgress.bind(f(e)),e.updateProgress=e.updateProgress.bind(f(e)),e.subscribeToCounterUpdate=e.subscribeToCounterUpdate.bind(f(e)),e}var a,p,d;return function(t,e){if("function"!==typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&h(t,e)}(n,e),a=n,(p=[{key:"notifyPromiseInProgress",value:function(){var t=this;0===this.state.config.delay?this.setState({promiseInProgress:!0}):setTimeout((function(){var e=Boolean((0,i.getCounter)(t.state.config.area)>0);t.setState({promiseInProgress:e})}),this.state.config.delay)}},{key:"updateProgress",value:function(t,e){this.setState({internalPromiseInProgress:t},e),t?this.notifyPromiseInProgress():this.setState({promiseInProgress:!1})}},{key:"subscribeToCounterUpdate",value:function(){var t=this;i.emitter.on(i.promiseCounterUpdateEventId,(function(e,n){t.state.config.area===n&&t.updateProgress(e)}))}},{key:"componentDidMount",value:function(){this.updateProgress(Boolean((0,i.getCounter)(this.state.config.area)>0),this.subscribeToCounterUpdate)}},{key:"componentWillUnmount",value:function(){i.emitter.off(i.promiseCounterUpdateEventId)}},{key:"render",value:function(){return r.default.createElement(t,s({},this.props,{config:this.state.config,promiseInProgress:this.state.promiseInProgress}))}}])&&c(a.prototype,p),d&&c(a,d),n}(r.Component)}},function(t,e,n){"use strict";var r=n(33),i=60103,o=60106;e.Fragment=60107,e.StrictMode=60108,e.Profiler=60114;var a=60109,u=60110,s=60112;e.Suspense=60113;var c=60115,l=60116;if("function"===typeof Symbol&&Symbol.for){var f=Symbol.for;i=f("react.element"),o=f("react.portal"),e.Fragment=f("react.fragment"),e.StrictMode=f("react.strict_mode"),e.Profiler=f("react.profiler"),a=f("react.provider"),u=f("react.context"),s=f("react.forward_ref"),e.Suspense=f("react.suspense"),c=f("react.memo"),l=f("react.lazy")}var h="function"===typeof Symbol&&Symbol.iterator;function p(t){for(var e="https://reactjs.org/docs/error-decoder.html?invariant="+t,n=1;n<arguments.length;n++)e+="&args[]="+encodeURIComponent(arguments[n]);return"Minified React error #"+t+"; visit "+e+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var d={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},g={};function v(t,e,n){this.props=t,this.context=e,this.refs=g,this.updater=n||d}function y(){}function m(t,e,n){this.props=t,this.context=e,this.refs=g,this.updater=n||d}v.prototype.isReactComponent={},v.prototype.setState=function(t,e){if("object"!==typeof t&&"function"!==typeof t&&null!=t)throw Error(p(85));this.updater.enqueueSetState(this,t,e,"setState")},v.prototype.forceUpdate=function(t){this.updater.enqueueForceUpdate(this,t,"forceUpdate")},y.prototype=v.prototype;var _=m.prototype=new y;_.constructor=m,r(_,v.prototype),_.isPureReactComponent=!0;var w={current:null},b=Object.prototype.hasOwnProperty,x={key:!0,ref:!0,__self:!0,__source:!0};function C(t,e,n){var r,o={},a=null,u=null;if(null!=e)for(r in void 0!==e.ref&&(u=e.ref),void 0!==e.key&&(a=""+e.key),e)b.call(e,r)&&!x.hasOwnProperty(r)&&(o[r]=e[r]);var s=arguments.length-2;if(1===s)o.children=n;else if(1<s){for(var c=Array(s),l=0;l<s;l++)c[l]=arguments[l+2];o.children=c}if(t&&t.defaultProps)for(r in s=t.defaultProps)void 0===o[r]&&(o[r]=s[r]);return{$$typeof:i,type:t,key:a,ref:u,props:o,_owner:w.current}}function M(t){return"object"===typeof t&&null!==t&&t.$$typeof===i}var P=/\\/+/g;function k(t,e){return"object"===typeof t&&null!==t&&null!=t.key?function(t){var e={"=":"=0",":":"=2"};return"$"+t.replace(/[=:]/g,(function(t){return e[t]}))}(""+t.key):e.toString(36)}function E(t,e,n,r,a){var u=typeof t;"undefined"!==u&&"boolean"!==u||(t=null);var s=!1;if(null===t)s=!0;else switch(u){case"string":case"number":s=!0;break;case"object":switch(t.$$typeof){case i:case o:s=!0}}if(s)return a=a(s=t),t=""===r?"."+k(s,0):r,Array.isArray(a)?(n="",null!=t&&(n=t.replace(P,"$&/")+"/"),E(a,e,n,"",(function(t){return t}))):null!=a&&(M(a)&&(a=function(t,e){return{$$typeof:i,type:t.type,key:e,ref:t.ref,props:t.props,_owner:t._owner}}(a,n+(!a.key||s&&s.key===a.key?"":(""+a.key).replace(P,"$&/")+"/")+t)),e.push(a)),1;if(s=0,r=""===r?".":r+":",Array.isArray(t))for(var c=0;c<t.length;c++){var l=r+k(u=t[c],c);s+=E(u,e,n,l,a)}else if(l=function(t){return null===t||"object"!==typeof t?null:"function"===typeof(t=h&&t[h]||t["@@iterator"])?t:null}(t),"function"===typeof l)for(t=l.call(t),c=0;!(u=t.next()).done;)s+=E(u=u.value,e,n,l=r+k(u,c++),a);else if("object"===u)throw e=""+t,Error(p(31,"[object Object]"===e?"object with keys {"+Object.keys(t).join(", ")+"}":e));return s}function T(t,e,n){if(null==t)return t;var r=[],i=0;return E(t,r,"","",(function(t){return e.call(n,t,i++)})),r}function O(t){if(-1===t._status){var e=t._result;e=e(),t._status=0,t._result=e,e.then((function(e){0===t._status&&(e=e.default,t._status=1,t._result=e)}),(function(e){0===t._status&&(t._status=2,t._result=e)}))}if(1===t._status)return t._result;throw t._result}var S={current:null};function N(){var t=S.current;if(null===t)throw Error(p(321));return t}var j={ReactCurrentDispatcher:S,ReactCurrentBatchConfig:{transition:0},ReactCurrentOwner:w,IsSomeRendererActing:{current:!1},assign:r};e.Children={map:T,forEach:function(t,e,n){T(t,(function(){e.apply(this,arguments)}),n)},count:function(t){var e=0;return T(t,(function(){e++})),e},toArray:function(t){return T(t,(function(t){return t}))||[]},only:function(t){if(!M(t))throw Error(p(143));return t}},e.Component=v,e.PureComponent=m,e.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=j,e.cloneElement=function(t,e,n){if(null===t||void 0===t)throw Error(p(267,t));var o=r({},t.props),a=t.key,u=t.ref,s=t._owner;if(null!=e){if(void 0!==e.ref&&(u=e.ref,s=w.current),void 0!==e.key&&(a=""+e.key),t.type&&t.type.defaultProps)var c=t.type.defaultProps;for(l in e)b.call(e,l)&&!x.hasOwnProperty(l)&&(o[l]=void 0===e[l]&&void 0!==c?c[l]:e[l])}var l=arguments.length-2;if(1===l)o.children=n;else if(1<l){c=Array(l);for(var f=0;f<l;f++)c[f]=arguments[f+2];o.children=c}return{$$typeof:i,type:t.type,key:a,ref:u,props:o,_owner:s}},e.createContext=function(t,e){return void 0===e&&(e=null),(t={$$typeof:u,_calculateChangedBits:e,_currentValue:t,_currentValue2:t,_threadCount:0,Provider:null,Consumer:null}).Provider={$$typeof:a,_context:t},t.Consumer=t},e.createElement=C,e.createFactory=function(t){var e=C.bind(null,t);return e.type=t,e},e.createRef=function(){return{current:null}},e.forwardRef=function(t){return{$$typeof:s,render:t}},e.isValidElement=M,e.lazy=function(t){return{$$typeof:l,_payload:{_status:-1,_result:t},_init:O}},e.memo=function(t,e){return{$$typeof:c,type:t,compare:void 0===e?null:e}},e.useCallback=function(t,e){return N().useCallback(t,e)},e.useContext=function(t,e){return N().useContext(t,e)},e.useDebugValue=function(){},e.useEffect=function(t,e){return N().useEffect(t,e)},e.useImperativeHandle=function(t,e,n){return N().useImperativeHandle(t,e,n)},e.useLayoutEffect=function(t,e){return N().useLayoutEffect(t,e)},e.useMemo=function(t,e){return N().useMemo(t,e)},e.useReducer=function(t,e,n){return N().useReducer(t,e,n)},e.useRef=function(t){return N().useRef(t)},e.useState=function(t){return N().useState(t)},e.version="17.0.2"},function(t,e,n){"use strict";var r=Object.getOwnPropertySymbols,i=Object.prototype.hasOwnProperty,o=Object.prototype.propertyIsEnumerable;function a(t){if(null===t||void 0===t)throw new TypeError("Object.assign cannot be called with null or undefined");return Object(t)}t.exports=function(){try{if(!Object.assign)return!1;var t=new String("abc");if(t[5]="de","5"===Object.getOwnPropertyNames(t)[0])return!1;for(var e={},n=0;n<10;n++)e["_"+String.fromCharCode(n)]=n;if("0123456789"!==Object.getOwnPropertyNames(e).map((function(t){return e[t]})).join(""))return!1;var r={};return"abcdefghijklmnopqrst".split("").forEach((function(t){r[t]=t})),"abcdefghijklmnopqrst"===Object.keys(Object.assign({},r)).join("")}catch(i){return!1}}()?Object.assign:function(t,e){for(var n,u,s=a(t),c=1;c<arguments.length;c++){for(var l in n=Object(arguments[c]))i.call(n,l)&&(s[l]=n[l]);if(r){u=r(n);for(var f=0;f<u.length;f++)o.call(n,u[f])&&(s[u[f]]=n[u[f]])}}return s}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.usePromiseTracker=void 0;var r,i=(r=n(17))&&r.__esModule?r:{default:r},o=n(13),a=n(18);function u(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){if(!(Symbol.iterator in Object(t))&&"[object Arguments]"!==Object.prototype.toString.call(t))return;var n=[],r=!0,i=!1,o=void 0;try{for(var a,u=t[Symbol.iterator]();!(r=(a=u.next()).done)&&(n.push(a.value),!e||n.length!==e);r=!0);}catch(s){i=!0,o=s}finally{try{r||null==u.return||u.return()}finally{if(i)throw o}}return n}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}e.usePromiseTracker=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:a.defaultConfig,e=i.default.useRef(!1);i.default.useEffect((function(){return e.current=!0,function(){return e.current=!1}}),[]);var n=i.default.useState((0,a.setupConfig)(t)),r=u(n,1),s=r[0];i.default.useEffect((function(){e.current&&s&&s.area&&(0,o.getCounter)(s.area)>0&&(h(!0),v(!0))}),[s]);var c=i.default.useState(!1),l=u(c,2),f=l[0],h=l[1],p=i.default.useState(!1),d=u(p,2),g=d[0],v=d[1],y=i.default.useRef(f),m=function(){s&&s.delay&&0!==s.delay?setTimeout((function(){y.current&&v(!0)}),s.delay):v(!0)},_=function(t,n){e.current&&s.area===n&&(h(t),y.current=t,t?m():v(!1))};return i.default.useEffect((function(){return y.current=f,o.emitter.on(o.promiseCounterUpdateEventId,_),function(){return o.emitter.off(o.promiseCounterUpdateEventId,_)}}),[]),{promiseInProgress:g}}},function(t,e,n){"use strict";function r(t,e,n,r,i,o,a){try{var u=t[o](a),s=u.value}catch(c){return void n(c)}u.done?e(s):Promise.resolve(s).then(r,i)}function i(t){return function(){var e=this,n=arguments;return new Promise((function(i,o){var a=t.apply(e,n);function u(t){r(a,i,o,u,s,"next",t)}function s(t){r(a,i,o,u,s,"throw",t)}u(void 0)}))}}function o(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function a(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function u(t,e,n){return e&&a(t.prototype,e),n&&a(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t}n.r(e);var s=n(0),c=n.n(s);function l(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function f(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function h(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?f(Object(n),!0).forEach((function(e){l(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):f(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}var p=function(t,e){return t<e?-1:t>e?1:t>=e?0:NaN},d=function(t){var e;return 1===t.length&&(e=t,t=function(t,n){return p(e(t),n)}),{left:function(e,n,r,i){for(null==r&&(r=0),null==i&&(i=e.length);r<i;){var o=r+i>>>1;t(e[o],n)<0?r=o+1:i=o}return r},right:function(e,n,r,i){for(null==r&&(r=0),null==i&&(i=e.length);r<i;){var o=r+i>>>1;t(e[o],n)>0?i=o:r=o+1}return r}}};var g=d(p);g.right,g.left;var v=Array.prototype;v.slice,v.map,Math.sqrt(50),Math.sqrt(10),Math.sqrt(2);Array.prototype.slice;var y={value:function(){}};function m(){for(var t,e=0,n=arguments.length,r={};e<n;++e){if(!(t=arguments[e]+"")||t in r||/[\\s.]/.test(t))throw new Error("illegal type: "+t);r[t]=[]}return new _(r)}function _(t){this._=t}function w(t,e){return t.trim().split(/^|\\s+/).map((function(t){var n="",r=t.indexOf(".");if(r>=0&&(n=t.slice(r+1),t=t.slice(0,r)),t&&!e.hasOwnProperty(t))throw new Error("unknown type: "+t);return{type:t,name:n}}))}function b(t,e){for(var n,r=0,i=t.length;r<i;++r)if((n=t[r]).name===e)return n.value}function x(t,e,n){for(var r=0,i=t.length;r<i;++r)if(t[r].name===e){t[r]=y,t=t.slice(0,r).concat(t.slice(r+1));break}return null!=n&&t.push({name:e,value:n}),t}_.prototype=m.prototype={constructor:_,on:function(t,e){var n,r=this._,i=w(t+"",r),o=-1,a=i.length;if(!(arguments.length<2)){if(null!=e&&"function"!==typeof e)throw new Error("invalid callback: "+e);for(;++o<a;)if(n=(t=i[o]).type)r[n]=x(r[n],t.name,e);else if(null==e)for(n in r)r[n]=x(r[n],t.name,null);return this}for(;++o<a;)if((n=(t=i[o]).type)&&(n=b(r[n],t.name)))return n},copy:function(){var t={},e=this._;for(var n in e)t[n]=e[n].slice();return new _(t)},call:function(t,e){if((n=arguments.length-2)>0)for(var n,r,i=new Array(n),o=0;o<n;++o)i[o]=arguments[o+2];if(!this._.hasOwnProperty(t))throw new Error("unknown type: "+t);for(o=0,n=(r=this._[t]).length;o<n;++o)r[o].value.apply(e,i)},apply:function(t,e,n){if(!this._.hasOwnProperty(t))throw new Error("unknown type: "+t);for(var r=this._[t],i=0,o=r.length;i<o;++i)r[i].value.apply(e,n)}};var C=m;function M(){}var P=function(t){return null==t?M:function(){return this.querySelector(t)}};function k(){return[]}var E=function(t){return null==t?k:function(){return this.querySelectorAll(t)}},T=function(t){return function(){return this.matches(t)}},O=function(t){return new Array(t.length)};function S(t,e){this.ownerDocument=t.ownerDocument,this.namespaceURI=t.namespaceURI,this._next=null,this._parent=t,this.__data__=e}S.prototype={constructor:S,appendChild:function(t){return this._parent.insertBefore(t,this._next)},insertBefore:function(t,e){return this._parent.insertBefore(t,e)},querySelector:function(t){return this._parent.querySelector(t)},querySelectorAll:function(t){return this._parent.querySelectorAll(t)}};function N(t,e,n,r,i,o){for(var a,u=0,s=e.length,c=o.length;u<c;++u)(a=e[u])?(a.__data__=o[u],r[u]=a):n[u]=new S(t,o[u]);for(;u<s;++u)(a=e[u])&&(i[u]=a)}function j(t,e,n,r,i,o,a){var u,s,c,l={},f=e.length,h=o.length,p=new Array(f);for(u=0;u<f;++u)(s=e[u])&&(p[u]=c="$"+a.call(s,s.__data__,u,e),c in l?i[u]=s:l[c]=s);for(u=0;u<h;++u)(s=l[c="$"+a.call(t,o[u],u,o)])?(r[u]=s,s.__data__=o[u],l[c]=null):n[u]=new S(t,o[u]);for(u=0;u<f;++u)(s=e[u])&&l[p[u]]===s&&(i[u]=s)}function U(t,e){return t<e?-1:t>e?1:t>=e?0:NaN}var A="http://www.w3.org/1999/xhtml",L={svg:"http://www.w3.org/2000/svg",xhtml:A,xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/"},D=function(t){var e=t+="",n=e.indexOf(":");return n>=0&&"xmlns"!==(e=t.slice(0,n))&&(t=t.slice(n+1)),L.hasOwnProperty(e)?{space:L[e],local:t}:t};function R(t){return function(){this.removeAttribute(t)}}function F(t){return function(){this.removeAttributeNS(t.space,t.local)}}function I(t,e){return function(){this.setAttribute(t,e)}}function Y(t,e){return function(){this.setAttributeNS(t.space,t.local,e)}}function H(t,e){return function(){var n=e.apply(this,arguments);null==n?this.removeAttribute(t):this.setAttribute(t,n)}}function q(t,e){return function(){var n=e.apply(this,arguments);null==n?this.removeAttributeNS(t.space,t.local):this.setAttributeNS(t.space,t.local,n)}}var $=function(t){return t.ownerDocument&&t.ownerDocument.defaultView||t.document&&t||t.defaultView};function J(t){return function(){this.style.removeProperty(t)}}function z(t,e,n){return function(){this.style.setProperty(t,e,n)}}function V(t,e,n){return function(){var r=e.apply(this,arguments);null==r?this.style.removeProperty(t):this.style.setProperty(t,r,n)}}function X(t,e){return t.style.getPropertyValue(e)||$(t).getComputedStyle(t,null).getPropertyValue(e)}function G(t){return function(){delete this[t]}}function B(t,e){return function(){this[t]=e}}function Z(t,e){return function(){var n=e.apply(this,arguments);null==n?delete this[t]:this[t]=n}}function W(t){return t.trim().split(/^|\\s+/)}function Q(t){return t.classList||new K(t)}function K(t){this._node=t,this._names=W(t.getAttribute("class")||"")}function tt(t,e){for(var n=Q(t),r=-1,i=e.length;++r<i;)n.add(e[r])}function et(t,e){for(var n=Q(t),r=-1,i=e.length;++r<i;)n.remove(e[r])}function nt(t){return function(){tt(this,t)}}function rt(t){return function(){et(this,t)}}function it(t,e){return function(){(e.apply(this,arguments)?tt:et)(this,t)}}K.prototype={add:function(t){this._names.indexOf(t)<0&&(this._names.push(t),this._node.setAttribute("class",this._names.join(" ")))},remove:function(t){var e=this._names.indexOf(t);e>=0&&(this._names.splice(e,1),this._node.setAttribute("class",this._names.join(" ")))},contains:function(t){return this._names.indexOf(t)>=0}};function ot(){this.textContent=""}function at(t){return function(){this.textContent=t}}function ut(t){return function(){var e=t.apply(this,arguments);this.textContent=null==e?"":e}}function st(){this.innerHTML=""}function ct(t){return function(){this.innerHTML=t}}function lt(t){return function(){var e=t.apply(this,arguments);this.innerHTML=null==e?"":e}}function ft(){this.nextSibling&&this.parentNode.appendChild(this)}function ht(){this.previousSibling&&this.parentNode.insertBefore(this,this.parentNode.firstChild)}function pt(t){return function(){var e=this.ownerDocument,n=this.namespaceURI;return n===A&&e.documentElement.namespaceURI===A?e.createElement(t):e.createElementNS(n,t)}}function dt(t){return function(){return this.ownerDocument.createElementNS(t.space,t.local)}}var gt=function(t){var e=D(t);return(e.local?dt:pt)(e)};function vt(){return null}function yt(){var t=this.parentNode;t&&t.removeChild(this)}function mt(){var t=this.cloneNode(!1),e=this.parentNode;return e?e.insertBefore(t,this.nextSibling):t}function _t(){var t=this.cloneNode(!0),e=this.parentNode;return e?e.insertBefore(t,this.nextSibling):t}var wt={},bt=null;"undefined"!==typeof document&&("onmouseenter"in document.documentElement||(wt={mouseenter:"mouseover",mouseleave:"mouseout"}));function xt(t,e,n){return t=Ct(t,e,n),function(e){var n=e.relatedTarget;n&&(n===this||8&n.compareDocumentPosition(this))||t.call(this,e)}}function Ct(t,e,n){return function(r){var i=bt;bt=r;try{t.call(this,this.__data__,e,n)}finally{bt=i}}}function Mt(t){return t.trim().split(/^|\\s+/).map((function(t){var e="",n=t.indexOf(".");return n>=0&&(e=t.slice(n+1),t=t.slice(0,n)),{type:t,name:e}}))}function Pt(t){return function(){var e=this.__on;if(e){for(var n,r=0,i=-1,o=e.length;r<o;++r)n=e[r],t.type&&n.type!==t.type||n.name!==t.name?e[++i]=n:this.removeEventListener(n.type,n.listener,n.capture);++i?e.length=i:delete this.__on}}}function kt(t,e,n){var r=wt.hasOwnProperty(t.type)?xt:Ct;return function(i,o,a){var u,s=this.__on,c=r(e,o,a);if(s)for(var l=0,f=s.length;l<f;++l)if((u=s[l]).type===t.type&&u.name===t.name)return this.removeEventListener(u.type,u.listener,u.capture),this.addEventListener(u.type,u.listener=c,u.capture=n),void(u.value=e);this.addEventListener(t.type,c,n),u={type:t.type,name:t.name,value:e,listener:c,capture:n},s?s.push(u):this.__on=[u]}}function Et(t,e,n){var r=$(t),i=r.CustomEvent;"function"===typeof i?i=new i(e,n):(i=r.document.createEvent("Event"),n?(i.initEvent(e,n.bubbles,n.cancelable),i.detail=n.detail):i.initEvent(e,!1,!1)),t.dispatchEvent(i)}function Tt(t,e){return function(){return Et(this,t,e)}}function Ot(t,e){return function(){return Et(this,t,e.apply(this,arguments))}}var St=[null];function Nt(t,e){this._groups=t,this._parents=e}function jt(){return new Nt([[document.documentElement]],St)}Nt.prototype=jt.prototype={constructor:Nt,select:function(t){"function"!==typeof t&&(t=P(t));for(var e=this._groups,n=e.length,r=new Array(n),i=0;i<n;++i)for(var o,a,u=e[i],s=u.length,c=r[i]=new Array(s),l=0;l<s;++l)(o=u[l])&&(a=t.call(o,o.__data__,l,u))&&("__data__"in o&&(a.__data__=o.__data__),c[l]=a);return new Nt(r,this._parents)},selectAll:function(t){"function"!==typeof t&&(t=E(t));for(var e=this._groups,n=e.length,r=[],i=[],o=0;o<n;++o)for(var a,u=e[o],s=u.length,c=0;c<s;++c)(a=u[c])&&(r.push(t.call(a,a.__data__,c,u)),i.push(a));return new Nt(r,i)},filter:function(t){"function"!==typeof t&&(t=T(t));for(var e=this._groups,n=e.length,r=new Array(n),i=0;i<n;++i)for(var o,a=e[i],u=a.length,s=r[i]=[],c=0;c<u;++c)(o=a[c])&&t.call(o,o.__data__,c,a)&&s.push(o);return new Nt(r,this._parents)},data:function(t,e){if(!t)return d=new Array(this.size()),l=-1,this.each((function(t){d[++l]=t})),d;var n,r=e?j:N,i=this._parents,o=this._groups;"function"!==typeof t&&(n=t,t=function(){return n});for(var a=o.length,u=new Array(a),s=new Array(a),c=new Array(a),l=0;l<a;++l){var f=i[l],h=o[l],p=h.length,d=t.call(f,f&&f.__data__,l,i),g=d.length,v=s[l]=new Array(g),y=u[l]=new Array(g);r(f,h,v,y,c[l]=new Array(p),d,e);for(var m,_,w=0,b=0;w<g;++w)if(m=v[w]){for(w>=b&&(b=w+1);!(_=y[b])&&++b<g;);m._next=_||null}}return(u=new Nt(u,i))._enter=s,u._exit=c,u},enter:function(){return new Nt(this._enter||this._groups.map(O),this._parents)},exit:function(){return new Nt(this._exit||this._groups.map(O),this._parents)},join:function(t,e,n){var r=this.enter(),i=this,o=this.exit();return r="function"===typeof t?t(r):r.append(t+""),null!=e&&(i=e(i)),null==n?o.remove():n(o),r&&i?r.merge(i).order():i},merge:function(t){for(var e=this._groups,n=t._groups,r=e.length,i=n.length,o=Math.min(r,i),a=new Array(r),u=0;u<o;++u)for(var s,c=e[u],l=n[u],f=c.length,h=a[u]=new Array(f),p=0;p<f;++p)(s=c[p]||l[p])&&(h[p]=s);for(;u<r;++u)a[u]=e[u];return new Nt(a,this._parents)},order:function(){for(var t=this._groups,e=-1,n=t.length;++e<n;)for(var r,i=t[e],o=i.length-1,a=i[o];--o>=0;)(r=i[o])&&(a&&4^r.compareDocumentPosition(a)&&a.parentNode.insertBefore(r,a),a=r);return this},sort:function(t){function e(e,n){return e&&n?t(e.__data__,n.__data__):!e-!n}t||(t=U);for(var n=this._groups,r=n.length,i=new Array(r),o=0;o<r;++o){for(var a,u=n[o],s=u.length,c=i[o]=new Array(s),l=0;l<s;++l)(a=u[l])&&(c[l]=a);c.sort(e)}return new Nt(i,this._parents).order()},call:function(){var t=arguments[0];return arguments[0]=this,t.apply(null,arguments),this},nodes:function(){var t=new Array(this.size()),e=-1;return this.each((function(){t[++e]=this})),t},node:function(){for(var t=this._groups,e=0,n=t.length;e<n;++e)for(var r=t[e],i=0,o=r.length;i<o;++i){var a=r[i];if(a)return a}return null},size:function(){var t=0;return this.each((function(){++t})),t},empty:function(){return!this.node()},each:function(t){for(var e=this._groups,n=0,r=e.length;n<r;++n)for(var i,o=e[n],a=0,u=o.length;a<u;++a)(i=o[a])&&t.call(i,i.__data__,a,o);return this},attr:function(t,e){var n=D(t);if(arguments.length<2){var r=this.node();return n.local?r.getAttributeNS(n.space,n.local):r.getAttribute(n)}return this.each((null==e?n.local?F:R:"function"===typeof e?n.local?q:H:n.local?Y:I)(n,e))},style:function(t,e,n){return arguments.length>1?this.each((null==e?J:"function"===typeof e?V:z)(t,e,null==n?"":n)):X(this.node(),t)},property:function(t,e){return arguments.length>1?this.each((null==e?G:"function"===typeof e?Z:B)(t,e)):this.node()[t]},classed:function(t,e){var n=W(t+"");if(arguments.length<2){for(var r=Q(this.node()),i=-1,o=n.length;++i<o;)if(!r.contains(n[i]))return!1;return!0}return this.each(("function"===typeof e?it:e?nt:rt)(n,e))},text:function(t){return arguments.length?this.each(null==t?ot:("function"===typeof t?ut:at)(t)):this.node().textContent},html:function(t){return arguments.length?this.each(null==t?st:("function"===typeof t?lt:ct)(t)):this.node().innerHTML},raise:function(){return this.each(ft)},lower:function(){return this.each(ht)},append:function(t){var e="function"===typeof t?t:gt(t);return this.select((function(){return this.appendChild(e.apply(this,arguments))}))},insert:function(t,e){var n="function"===typeof t?t:gt(t),r=null==e?vt:"function"===typeof e?e:P(e);return this.select((function(){return this.insertBefore(n.apply(this,arguments),r.apply(this,arguments)||null)}))},remove:function(){return this.each(yt)},clone:function(t){return this.select(t?_t:mt)},datum:function(t){return arguments.length?this.property("__data__",t):this.node().__data__},on:function(t,e,n){var r,i,o=Mt(t+""),a=o.length;if(!(arguments.length<2)){for(u=e?kt:Pt,null==n&&(n=!1),r=0;r<a;++r)this.each(u(o[r],e,n));return this}var u=this.node().__on;if(u)for(var s,c=0,l=u.length;c<l;++c)for(r=0,s=u[c];r<a;++r)if((i=o[r]).type===s.type&&i.name===s.name)return s.value},dispatch:function(t,e){return this.each(("function"===typeof e?Ot:Tt)(t,e))}};var Ut=jt;var At=function(t,e,n){t.prototype=e.prototype=n,n.constructor=t};function Lt(t,e){var n=Object.create(t.prototype);for(var r in e)n[r]=e[r];return n}function Dt(){}var Rt=.7,Ft=1/Rt,It="\\\\s*([+-]?\\\\d+)\\\\s*",Yt="\\\\s*([+-]?\\\\d*\\\\.?\\\\d+(?:[eE][+-]?\\\\d+)?)\\\\s*",Ht="\\\\s*([+-]?\\\\d*\\\\.?\\\\d+(?:[eE][+-]?\\\\d+)?)%\\\\s*",qt=/^#([0-9a-f]{3,8})$/,$t=new RegExp("^rgb\\\\("+[It,It,It]+"\\\\)$"),Jt=new RegExp("^rgb\\\\("+[Ht,Ht,Ht]+"\\\\)$"),zt=new RegExp("^rgba\\\\("+[It,It,It,Yt]+"\\\\)$"),Vt=new RegExp("^rgba\\\\("+[Ht,Ht,Ht,Yt]+"\\\\)$"),Xt=new RegExp("^hsl\\\\("+[Yt,Ht,Ht]+"\\\\)$"),Gt=new RegExp("^hsla\\\\("+[Yt,Ht,Ht,Yt]+"\\\\)$"),Bt={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};function Zt(){return this.rgb().formatHex()}function Wt(){return this.rgb().formatRgb()}function Qt(t){var e,n;return t=(t+"").trim().toLowerCase(),(e=qt.exec(t))?(n=e[1].length,e=parseInt(e[1],16),6===n?Kt(e):3===n?new re(e>>8&15|e>>4&240,e>>4&15|240&e,(15&e)<<4|15&e,1):8===n?te(e>>24&255,e>>16&255,e>>8&255,(255&e)/255):4===n?te(e>>12&15|e>>8&240,e>>8&15|e>>4&240,e>>4&15|240&e,((15&e)<<4|15&e)/255):null):(e=$t.exec(t))?new re(e[1],e[2],e[3],1):(e=Jt.exec(t))?new re(255*e[1]/100,255*e[2]/100,255*e[3]/100,1):(e=zt.exec(t))?te(e[1],e[2],e[3],e[4]):(e=Vt.exec(t))?te(255*e[1]/100,255*e[2]/100,255*e[3]/100,e[4]):(e=Xt.exec(t))?ue(e[1],e[2]/100,e[3]/100,1):(e=Gt.exec(t))?ue(e[1],e[2]/100,e[3]/100,e[4]):Bt.hasOwnProperty(t)?Kt(Bt[t]):"transparent"===t?new re(NaN,NaN,NaN,0):null}function Kt(t){return new re(t>>16&255,t>>8&255,255&t,1)}function te(t,e,n,r){return r<=0&&(t=e=n=NaN),new re(t,e,n,r)}function ee(t){return t instanceof Dt||(t=Qt(t)),t?new re((t=t.rgb()).r,t.g,t.b,t.opacity):new re}function ne(t,e,n,r){return 1===arguments.length?ee(t):new re(t,e,n,null==r?1:r)}function re(t,e,n,r){this.r=+t,this.g=+e,this.b=+n,this.opacity=+r}function ie(){return"#"+ae(this.r)+ae(this.g)+ae(this.b)}function oe(){var t=this.opacity;return(1===(t=isNaN(t)?1:Math.max(0,Math.min(1,t)))?"rgb(":"rgba(")+Math.max(0,Math.min(255,Math.round(this.r)||0))+", "+Math.max(0,Math.min(255,Math.round(this.g)||0))+", "+Math.max(0,Math.min(255,Math.round(this.b)||0))+(1===t?")":", "+t+")")}function ae(t){return((t=Math.max(0,Math.min(255,Math.round(t)||0)))<16?"0":"")+t.toString(16)}function ue(t,e,n,r){return r<=0?t=e=n=NaN:n<=0||n>=1?t=e=NaN:e<=0&&(t=NaN),new ce(t,e,n,r)}function se(t){if(t instanceof ce)return new ce(t.h,t.s,t.l,t.opacity);if(t instanceof Dt||(t=Qt(t)),!t)return new ce;if(t instanceof ce)return t;var e=(t=t.rgb()).r/255,n=t.g/255,r=t.b/255,i=Math.min(e,n,r),o=Math.max(e,n,r),a=NaN,u=o-i,s=(o+i)/2;return u?(a=e===o?(n-r)/u+6*(n<r):n===o?(r-e)/u+2:(e-n)/u+4,u/=s<.5?o+i:2-o-i,a*=60):u=s>0&&s<1?0:a,new ce(a,u,s,t.opacity)}function ce(t,e,n,r){this.h=+t,this.s=+e,this.l=+n,this.opacity=+r}function le(t,e,n){return 255*(t<60?e+(n-e)*t/60:t<180?n:t<240?e+(n-e)*(240-t)/60:e)}function fe(t,e,n,r,i){var o=t*t,a=o*t;return((1-3*t+3*o-a)*e+(4-6*o+3*a)*n+(1+3*t+3*o-3*a)*r+a*i)/6}At(Dt,Qt,{copy:function(t){return Object.assign(new this.constructor,this,t)},displayable:function(){return this.rgb().displayable()},hex:Zt,formatHex:Zt,formatHsl:function(){return se(this).formatHsl()},formatRgb:Wt,toString:Wt}),At(re,ne,Lt(Dt,{brighter:function(t){return t=null==t?Ft:Math.pow(Ft,t),new re(this.r*t,this.g*t,this.b*t,this.opacity)},darker:function(t){return t=null==t?Rt:Math.pow(Rt,t),new re(this.r*t,this.g*t,this.b*t,this.opacity)},rgb:function(){return this},displayable:function(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:ie,formatHex:ie,formatRgb:oe,toString:oe})),At(ce,(function(t,e,n,r){return 1===arguments.length?se(t):new ce(t,e,n,null==r?1:r)}),Lt(Dt,{brighter:function(t){return t=null==t?Ft:Math.pow(Ft,t),new ce(this.h,this.s,this.l*t,this.opacity)},darker:function(t){return t=null==t?Rt:Math.pow(Rt,t),new ce(this.h,this.s,this.l*t,this.opacity)},rgb:function(){var t=this.h%360+360*(this.h<0),e=isNaN(t)||isNaN(this.s)?0:this.s,n=this.l,r=n+(n<.5?n:1-n)*e,i=2*n-r;return new re(le(t>=240?t-240:t+120,i,r),le(t,i,r),le(t<120?t+240:t-120,i,r),this.opacity)},displayable:function(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl:function(){var t=this.opacity;return(1===(t=isNaN(t)?1:Math.max(0,Math.min(1,t)))?"hsl(":"hsla(")+(this.h||0)+", "+100*(this.s||0)+"%, "+100*(this.l||0)+"%"+(1===t?")":", "+t+")")}}));var he=function(t){return function(){return t}};function pe(t,e){return function(n){return t+n*e}}function de(t){return 1===(t=+t)?ge:function(e,n){return n-e?function(t,e,n){return t=Math.pow(t,n),e=Math.pow(e,n)-t,n=1/n,function(r){return Math.pow(t+r*e,n)}}(e,n,t):he(isNaN(e)?n:e)}}function ge(t,e){var n=e-t;return n?pe(t,n):he(isNaN(t)?e:t)}var ve=function t(e){var n=de(e);function r(t,e){var r=n((t=ne(t)).r,(e=ne(e)).r),i=n(t.g,e.g),o=n(t.b,e.b),a=ge(t.opacity,e.opacity);return function(e){return t.r=r(e),t.g=i(e),t.b=o(e),t.opacity=a(e),t+""}}return r.gamma=t,r}(1);function ye(t){return function(e){var n,r,i=e.length,o=new Array(i),a=new Array(i),u=new Array(i);for(n=0;n<i;++n)r=ne(e[n]),o[n]=r.r||0,a[n]=r.g||0,u[n]=r.b||0;return o=t(o),a=t(a),u=t(u),r.opacity=1,function(t){return r.r=o(t),r.g=a(t),r.b=u(t),r+""}}}ye((function(t){var e=t.length-1;return function(n){var r=n<=0?n=0:n>=1?(n=1,e-1):Math.floor(n*e),i=t[r],o=t[r+1],a=r>0?t[r-1]:2*i-o,u=r<e-1?t[r+2]:2*o-i;return fe((n-r/e)*e,a,i,o,u)}})),ye((function(t){var e=t.length;return function(n){var r=Math.floor(((n%=1)<0?++n:n)*e),i=t[(r+e-1)%e],o=t[r%e],a=t[(r+1)%e],u=t[(r+2)%e];return fe((n-r/e)*e,i,o,a,u)}}));var me=function(t,e){return t=+t,e=+e,function(n){return t*(1-n)+e*n}},_e=/[-+]?(?:\\d+\\.?\\d*|\\.?\\d+)(?:[eE][-+]?\\d+)?/g,we=new RegExp(_e.source,"g");var be,xe,Ce=function(t,e){var n,r,i,o=_e.lastIndex=we.lastIndex=0,a=-1,u=[],s=[];for(t+="",e+="";(n=_e.exec(t))&&(r=we.exec(e));)(i=r.index)>o&&(i=e.slice(o,i),u[a]?u[a]+=i:u[++a]=i),(n=n[0])===(r=r[0])?u[a]?u[a]+=r:u[++a]=r:(u[++a]=null,s.push({i:a,x:me(n,r)})),o=we.lastIndex;return o<e.length&&(i=e.slice(o),u[a]?u[a]+=i:u[++a]=i),u.length<2?s[0]?function(t){return function(e){return t(e)+""}}(s[0].x):function(t){return function(){return t}}(e):(e=s.length,function(t){for(var n,r=0;r<e;++r)u[(n=s[r]).i]=n.x(t);return u.join("")})},Me=0,Pe=0,ke=0,Ee=0,Te=0,Oe=0,Se="object"===typeof performance&&performance.now?performance:Date,Ne="object"===typeof window&&window.requestAnimationFrame?window.requestAnimationFrame.bind(window):function(t){setTimeout(t,17)};function je(){return Te||(Ne(Ue),Te=Se.now()+Oe)}function Ue(){Te=0}function Ae(){this._call=this._time=this._next=null}function Le(t,e,n){var r=new Ae;return r.restart(t,e,n),r}function De(){Te=(Ee=Se.now())+Oe,Me=Pe=0;try{!function(){je(),++Me;for(var t,e=be;e;)(t=Te-e._time)>=0&&e._call.call(null,t),e=e._next;--Me}()}finally{Me=0,function(){var t,e,n=be,r=1/0;for(;n;)n._call?(r>n._time&&(r=n._time),t=n,n=n._next):(e=n._next,n._next=null,n=t?t._next=e:be=e);xe=t,Fe(r)}(),Te=0}}function Re(){var t=Se.now(),e=t-Ee;e>1e3&&(Oe-=e,Ee=t)}function Fe(t){Me||(Pe&&(Pe=clearTimeout(Pe)),t-Te>24?(t<1/0&&(Pe=setTimeout(De,t-Se.now()-Oe)),ke&&(ke=clearInterval(ke))):(ke||(Ee=Se.now(),ke=setInterval(Re,1e3)),Me=1,Ne(De)))}Ae.prototype=Le.prototype={constructor:Ae,restart:function(t,e,n){if("function"!==typeof t)throw new TypeError("callback is not a function");n=(null==n?je():+n)+(null==e?0:+e),this._next||xe===this||(xe?xe._next=this:be=this,xe=this),this._call=t,this._time=n,Fe()},stop:function(){this._call&&(this._call=null,this._time=1/0,Fe())}};var Ie=function(t,e,n){var r=new Ae;return e=null==e?0:+e,r.restart((function(n){r.stop(),t(n+e)}),e,n),r},Ye=C("start","end","cancel","interrupt"),He=[],qe=function(t,e,n,r,i,o){var a=t.__transition;if(a){if(n in a)return}else t.__transition={};!function(t,e,n){var r,i=t.__transition;function o(t){n.state=1,n.timer.restart(a,n.delay,n.time),n.delay<=t&&a(t-n.delay)}function a(o){var c,l,f,h;if(1!==n.state)return s();for(c in i)if((h=i[c]).name===n.name){if(3===h.state)return Ie(a);4===h.state?(h.state=6,h.timer.stop(),h.on.call("interrupt",t,t.__data__,h.index,h.group),delete i[c]):+c<e&&(h.state=6,h.timer.stop(),h.on.call("cancel",t,t.__data__,h.index,h.group),delete i[c])}if(Ie((function(){3===n.state&&(n.state=4,n.timer.restart(u,n.delay,n.time),u(o))})),n.state=2,n.on.call("start",t,t.__data__,n.index,n.group),2===n.state){for(n.state=3,r=new Array(f=n.tween.length),c=0,l=-1;c<f;++c)(h=n.tween[c].value.call(t,t.__data__,n.index,n.group))&&(r[++l]=h);r.length=l+1}}function u(e){for(var i=e<n.duration?n.ease.call(null,e/n.duration):(n.timer.restart(s),n.state=5,1),o=-1,a=r.length;++o<a;)r[o].call(t,i);5===n.state&&(n.on.call("end",t,t.__data__,n.index,n.group),s())}function s(){for(var r in n.state=6,n.timer.stop(),delete i[e],i)return;delete t.__transition}i[e]=n,n.timer=Le(o,0,n.time)}(t,n,{name:e,index:r,group:i,on:Ye,tween:He,time:o.time,delay:o.delay,duration:o.duration,ease:o.ease,timer:null,state:0})};function $e(t,e){var n=ze(t,e);if(n.state>0)throw new Error("too late; already scheduled");return n}function Je(t,e){var n=ze(t,e);if(n.state>3)throw new Error("too late; already running");return n}function ze(t,e){var n=t.__transition;if(!n||!(n=n[e]))throw new Error("transition not found");return n}var Ve,Xe,Ge,Be,Ze=function(t,e){var n,r,i,o=t.__transition,a=!0;if(o){for(i in e=null==e?null:e+"",o)(n=o[i]).name===e?(r=n.state>2&&n.state<5,n.state=6,n.timer.stop(),n.on.call(r?"interrupt":"cancel",t,t.__data__,n.index,n.group),delete o[i]):a=!1;a&&delete t.__transition}},We=180/Math.PI,Qe={translateX:0,translateY:0,rotate:0,skewX:0,scaleX:1,scaleY:1},Ke=function(t,e,n,r,i,o){var a,u,s;return(a=Math.sqrt(t*t+e*e))&&(t/=a,e/=a),(s=t*n+e*r)&&(n-=t*s,r-=e*s),(u=Math.sqrt(n*n+r*r))&&(n/=u,r/=u,s/=u),t*r<e*n&&(t=-t,e=-e,s=-s,a=-a),{translateX:i,translateY:o,rotate:Math.atan2(e,t)*We,skewX:Math.atan(s)*We,scaleX:a,scaleY:u}};function tn(t,e,n,r){function i(t){return t.length?t.pop()+" ":""}return function(o,a){var u=[],s=[];return o=t(o),a=t(a),function(t,r,i,o,a,u){if(t!==i||r!==o){var s=a.push("translate(",null,e,null,n);u.push({i:s-4,x:me(t,i)},{i:s-2,x:me(r,o)})}else(i||o)&&a.push("translate("+i+e+o+n)}(o.translateX,o.translateY,a.translateX,a.translateY,u,s),function(t,e,n,o){t!==e?(t-e>180?e+=360:e-t>180&&(t+=360),o.push({i:n.push(i(n)+"rotate(",null,r)-2,x:me(t,e)})):e&&n.push(i(n)+"rotate("+e+r)}(o.rotate,a.rotate,u,s),function(t,e,n,o){t!==e?o.push({i:n.push(i(n)+"skewX(",null,r)-2,x:me(t,e)}):e&&n.push(i(n)+"skewX("+e+r)}(o.skewX,a.skewX,u,s),function(t,e,n,r,o,a){if(t!==n||e!==r){var u=o.push(i(o)+"scale(",null,",",null,")");a.push({i:u-4,x:me(t,n)},{i:u-2,x:me(e,r)})}else 1===n&&1===r||o.push(i(o)+"scale("+n+","+r+")")}(o.scaleX,o.scaleY,a.scaleX,a.scaleY,u,s),o=a=null,function(t){for(var e,n=-1,r=s.length;++n<r;)u[(e=s[n]).i]=e.x(t);return u.join("")}}}var en=tn((function(t){return"none"===t?Qe:(Ve||(Ve=document.createElement("DIV"),Xe=document.documentElement,Ge=document.defaultView),Ve.style.transform=t,t=Ge.getComputedStyle(Xe.appendChild(Ve),null).getPropertyValue("transform"),Xe.removeChild(Ve),t=t.slice(7,-1).split(","),Ke(+t[0],+t[1],+t[2],+t[3],+t[4],+t[5]))}),"px, ","px)","deg)"),nn=tn((function(t){return null==t?Qe:(Be||(Be=document.createElementNS("http://www.w3.org/2000/svg","g")),Be.setAttribute("transform",t),(t=Be.transform.baseVal.consolidate())?(t=t.matrix,Ke(t.a,t.b,t.c,t.d,t.e,t.f)):Qe)}),", ",")",")");function rn(t,e){var n,r;return function(){var i=Je(this,t),o=i.tween;if(o!==n)for(var a=0,u=(r=n=o).length;a<u;++a)if(r[a].name===e){(r=r.slice()).splice(a,1);break}i.tween=r}}function on(t,e,n){var r,i;if("function"!==typeof n)throw new Error;return function(){var o=Je(this,t),a=o.tween;if(a!==r){i=(r=a).slice();for(var u={name:e,value:n},s=0,c=i.length;s<c;++s)if(i[s].name===e){i[s]=u;break}s===c&&i.push(u)}o.tween=i}}function an(t,e,n){var r=t._id;return t.each((function(){var t=Je(this,r);(t.value||(t.value={}))[e]=n.apply(this,arguments)})),function(t){return ze(t,r).value[e]}}var un=function(t,e){var n;return("number"===typeof e?me:e instanceof Qt?ve:(n=Qt(e))?(e=n,ve):Ce)(t,e)};function sn(t){return function(){this.removeAttribute(t)}}function cn(t){return function(){this.removeAttributeNS(t.space,t.local)}}function ln(t,e,n){var r,i,o=n+"";return function(){var a=this.getAttribute(t);return a===o?null:a===r?i:i=e(r=a,n)}}function fn(t,e,n){var r,i,o=n+"";return function(){var a=this.getAttributeNS(t.space,t.local);return a===o?null:a===r?i:i=e(r=a,n)}}function hn(t,e,n){var r,i,o;return function(){var a,u,s=n(this);if(null!=s)return(a=this.getAttribute(t))===(u=s+"")?null:a===r&&u===i?o:(i=u,o=e(r=a,s));this.removeAttribute(t)}}function pn(t,e,n){var r,i,o;return function(){var a,u,s=n(this);if(null!=s)return(a=this.getAttributeNS(t.space,t.local))===(u=s+"")?null:a===r&&u===i?o:(i=u,o=e(r=a,s));this.removeAttributeNS(t.space,t.local)}}function dn(t,e){return function(n){this.setAttribute(t,e.call(this,n))}}function gn(t,e){return function(n){this.setAttributeNS(t.space,t.local,e.call(this,n))}}function vn(t,e){var n,r;function i(){var i=e.apply(this,arguments);return i!==r&&(n=(r=i)&&gn(t,i)),n}return i._value=e,i}function yn(t,e){var n,r;function i(){var i=e.apply(this,arguments);return i!==r&&(n=(r=i)&&dn(t,i)),n}return i._value=e,i}function mn(t,e){return function(){$e(this,t).delay=+e.apply(this,arguments)}}function _n(t,e){return e=+e,function(){$e(this,t).delay=e}}function wn(t,e){return function(){Je(this,t).duration=+e.apply(this,arguments)}}function bn(t,e){return e=+e,function(){Je(this,t).duration=e}}function xn(t,e){if("function"!==typeof e)throw new Error;return function(){Je(this,t).ease=e}}function Cn(t,e,n){var r,i,o=function(t){return(t+"").trim().split(/^|\\s+/).every((function(t){var e=t.indexOf(".");return e>=0&&(t=t.slice(0,e)),!t||"start"===t}))}(e)?$e:Je;return function(){var a=o(this,t),u=a.on;u!==r&&(i=(r=u).copy()).on(e,n),a.on=i}}var Mn=Ut.prototype.constructor;function Pn(t){return function(){this.style.removeProperty(t)}}function kn(t,e,n){return function(r){this.style.setProperty(t,e.call(this,r),n)}}function En(t,e,n){var r,i;function o(){var o=e.apply(this,arguments);return o!==i&&(r=(i=o)&&kn(t,o,n)),r}return o._value=e,o}function Tn(t){return function(e){this.textContent=t.call(this,e)}}function On(t){var e,n;function r(){var r=t.apply(this,arguments);return r!==n&&(e=(n=r)&&Tn(r)),e}return r._value=t,r}var Sn=0;function Nn(t,e,n,r){this._groups=t,this._parents=e,this._name=n,this._id=r}function jn(){return++Sn}var Un=Ut.prototype;Nn.prototype=function(t){return Ut().transition(t)}.prototype={constructor:Nn,select:function(t){var e=this._name,n=this._id;"function"!==typeof t&&(t=P(t));for(var r=this._groups,i=r.length,o=new Array(i),a=0;a<i;++a)for(var u,s,c=r[a],l=c.length,f=o[a]=new Array(l),h=0;h<l;++h)(u=c[h])&&(s=t.call(u,u.__data__,h,c))&&("__data__"in u&&(s.__data__=u.__data__),f[h]=s,qe(f[h],e,n,h,f,ze(u,n)));return new Nn(o,this._parents,e,n)},selectAll:function(t){var e=this._name,n=this._id;"function"!==typeof t&&(t=E(t));for(var r=this._groups,i=r.length,o=[],a=[],u=0;u<i;++u)for(var s,c=r[u],l=c.length,f=0;f<l;++f)if(s=c[f]){for(var h,p=t.call(s,s.__data__,f,c),d=ze(s,n),g=0,v=p.length;g<v;++g)(h=p[g])&&qe(h,e,n,g,p,d);o.push(p),a.push(s)}return new Nn(o,a,e,n)},filter:function(t){"function"!==typeof t&&(t=T(t));for(var e=this._groups,n=e.length,r=new Array(n),i=0;i<n;++i)for(var o,a=e[i],u=a.length,s=r[i]=[],c=0;c<u;++c)(o=a[c])&&t.call(o,o.__data__,c,a)&&s.push(o);return new Nn(r,this._parents,this._name,this._id)},merge:function(t){if(t._id!==this._id)throw new Error;for(var e=this._groups,n=t._groups,r=e.length,i=n.length,o=Math.min(r,i),a=new Array(r),u=0;u<o;++u)for(var s,c=e[u],l=n[u],f=c.length,h=a[u]=new Array(f),p=0;p<f;++p)(s=c[p]||l[p])&&(h[p]=s);for(;u<r;++u)a[u]=e[u];return new Nn(a,this._parents,this._name,this._id)},selection:function(){return new Mn(this._groups,this._parents)},transition:function(){for(var t=this._name,e=this._id,n=jn(),r=this._groups,i=r.length,o=0;o<i;++o)for(var a,u=r[o],s=u.length,c=0;c<s;++c)if(a=u[c]){var l=ze(a,e);qe(a,t,n,c,u,{time:l.time+l.delay+l.duration,delay:0,duration:l.duration,ease:l.ease})}return new Nn(r,this._parents,t,n)},call:Un.call,nodes:Un.nodes,node:Un.node,size:Un.size,empty:Un.empty,each:Un.each,on:function(t,e){var n=this._id;return arguments.length<2?ze(this.node(),n).on.on(t):this.each(Cn(n,t,e))},attr:function(t,e){var n=D(t),r="transform"===n?nn:un;return this.attrTween(t,"function"===typeof e?(n.local?pn:hn)(n,r,an(this,"attr."+t,e)):null==e?(n.local?cn:sn)(n):(n.local?fn:ln)(n,r,e))},attrTween:function(t,e){var n="attr."+t;if(arguments.length<2)return(n=this.tween(n))&&n._value;if(null==e)return this.tween(n,null);if("function"!==typeof e)throw new Error;var r=D(t);return this.tween(n,(r.local?vn:yn)(r,e))},style:function(t,e,n){var r="transform"===(t+="")?en:un;return null==e?this.styleTween(t,function(t,e){var n,r,i;return function(){var o=X(this,t),a=(this.style.removeProperty(t),X(this,t));return o===a?null:o===n&&a===r?i:i=e(n=o,r=a)}}(t,r)).on("end.style."+t,Pn(t)):"function"===typeof e?this.styleTween(t,function(t,e,n){var r,i,o;return function(){var a=X(this,t),u=n(this),s=u+"";return null==u&&(this.style.removeProperty(t),s=u=X(this,t)),a===s?null:a===r&&s===i?o:(i=s,o=e(r=a,u))}}(t,r,an(this,"style."+t,e))).each(function(t,e){var n,r,i,o,a="style."+e,u="end."+a;return function(){var s=Je(this,t),c=s.on,l=null==s.value[a]?o||(o=Pn(e)):void 0;c===n&&i===l||(r=(n=c).copy()).on(u,i=l),s.on=r}}(this._id,t)):this.styleTween(t,function(t,e,n){var r,i,o=n+"";return function(){var a=X(this,t);return a===o?null:a===r?i:i=e(r=a,n)}}(t,r,e),n).on("end.style."+t,null)},styleTween:function(t,e,n){var r="style."+(t+="");if(arguments.length<2)return(r=this.tween(r))&&r._value;if(null==e)return this.tween(r,null);if("function"!==typeof e)throw new Error;return this.tween(r,En(t,e,null==n?"":n))},text:function(t){return this.tween("text","function"===typeof t?function(t){return function(){var e=t(this);this.textContent=null==e?"":e}}(an(this,"text",t)):function(t){return function(){this.textContent=t}}(null==t?"":t+""))},textTween:function(t){var e="text";if(arguments.length<1)return(e=this.tween(e))&&e._value;if(null==t)return this.tween(e,null);if("function"!==typeof t)throw new Error;return this.tween(e,On(t))},remove:function(){return this.on("end.remove",(t=this._id,function(){var e=this.parentNode;for(var n in this.__transition)if(+n!==t)return;e&&e.removeChild(this)}));var t},tween:function(t,e){var n=this._id;if(t+="",arguments.length<2){for(var r,i=ze(this.node(),n).tween,o=0,a=i.length;o<a;++o)if((r=i[o]).name===t)return r.value;return null}return this.each((null==e?rn:on)(n,t,e))},delay:function(t){var e=this._id;return arguments.length?this.each(("function"===typeof t?mn:_n)(e,t)):ze(this.node(),e).delay},duration:function(t){var e=this._id;return arguments.length?this.each(("function"===typeof t?wn:bn)(e,t)):ze(this.node(),e).duration},ease:function(t){var e=this._id;return arguments.length?this.each(xn(e,t)):ze(this.node(),e).ease},end:function(){var t,e,n=this,r=n._id,i=n.size();return new Promise((function(o,a){var u={value:a},s={value:function(){0===--i&&o()}};n.each((function(){var n=Je(this,r),i=n.on;i!==t&&((e=(t=i).copy())._.cancel.push(u),e._.interrupt.push(u),e._.end.push(s)),n.on=e}))}))}};var An={time:null,delay:0,duration:250,ease:function(t){return((t*=2)<=1?t*t*t:(t-=2)*t*t+2)/2}};function Ln(t,e){for(var n;!(n=t.__transition)||!(n=n[e]);)if(!(t=t.parentNode))return An.time=je(),An;return n}Ut.prototype.interrupt=function(t){return this.each((function(){Ze(this,t)}))},Ut.prototype.transition=function(t){var e,n;t instanceof Nn?(e=t._id,t=t._name):(e=jn(),(n=An).time=je(),t=null==t?null:t+"");for(var r=this._groups,i=r.length,o=0;o<i;++o)for(var a,u=r[o],s=u.length,c=0;c<s;++c)(a=u[c])&&qe(a,t,e,c,u,n||Ln(a,e));return new Nn(r,this._parents,t,e)};function Dn(t){return[+t[0],+t[1]]}function Rn(t){return[Dn(t[0]),Dn(t[1])]}["w","e"].map(Fn),["n","s"].map(Fn),["n","w","e","s","nw","ne","sw","se"].map(Fn);function Fn(t){return{type:t}}Math.cos,Math.sin,Math.PI,Math.max;Array.prototype.slice;var In=Math.PI,Yn=2*In,Hn=1e-6,qn=Yn-Hn;function $n(){this._x0=this._y0=this._x1=this._y1=null,this._=""}function Jn(){return new $n}$n.prototype=Jn.prototype={constructor:$n,moveTo:function(t,e){this._+="M"+(this._x0=this._x1=+t)+","+(this._y0=this._y1=+e)},closePath:function(){null!==this._x1&&(this._x1=this._x0,this._y1=this._y0,this._+="Z")},lineTo:function(t,e){this._+="L"+(this._x1=+t)+","+(this._y1=+e)},quadraticCurveTo:function(t,e,n,r){this._+="Q"+ +t+","+ +e+","+(this._x1=+n)+","+(this._y1=+r)},bezierCurveTo:function(t,e,n,r,i,o){this._+="C"+ +t+","+ +e+","+ +n+","+ +r+","+(this._x1=+i)+","+(this._y1=+o)},arcTo:function(t,e,n,r,i){t=+t,e=+e,n=+n,r=+r,i=+i;var o=this._x1,a=this._y1,u=n-t,s=r-e,c=o-t,l=a-e,f=c*c+l*l;if(i<0)throw new Error("negative radius: "+i);if(null===this._x1)this._+="M"+(this._x1=t)+","+(this._y1=e);else if(f>Hn)if(Math.abs(l*u-s*c)>Hn&&i){var h=n-o,p=r-a,d=u*u+s*s,g=h*h+p*p,v=Math.sqrt(d),y=Math.sqrt(f),m=i*Math.tan((In-Math.acos((d+f-g)/(2*v*y)))/2),_=m/y,w=m/v;Math.abs(_-1)>Hn&&(this._+="L"+(t+_*c)+","+(e+_*l)),this._+="A"+i+","+i+",0,0,"+ +(l*h>c*p)+","+(this._x1=t+w*u)+","+(this._y1=e+w*s)}else this._+="L"+(this._x1=t)+","+(this._y1=e);else;},arc:function(t,e,n,r,i,o){t=+t,e=+e,o=!!o;var a=(n=+n)*Math.cos(r),u=n*Math.sin(r),s=t+a,c=e+u,l=1^o,f=o?r-i:i-r;if(n<0)throw new Error("negative radius: "+n);null===this._x1?this._+="M"+s+","+c:(Math.abs(this._x1-s)>Hn||Math.abs(this._y1-c)>Hn)&&(this._+="L"+s+","+c),n&&(f<0&&(f=f%Yn+Yn),f>qn?this._+="A"+n+","+n+",0,1,"+l+","+(t-a)+","+(e-u)+"A"+n+","+n+",0,1,"+l+","+(this._x1=s)+","+(this._y1=c):f>Hn&&(this._+="A"+n+","+n+",0,"+ +(f>=In)+","+l+","+(this._x1=t+n*Math.cos(i))+","+(this._y1=e+n*Math.sin(i))))},rect:function(t,e,n,r){this._+="M"+(this._x0=this._x1=+t)+","+(this._y0=this._y1=+e)+"h"+ +n+"v"+ +r+"h"+-n+"Z"},toString:function(){return this._}};var zn="$";function Vn(){}function Xn(t,e){var n=new Vn;if(t instanceof Vn)t.each((function(t,e){n.set(e,t)}));else if(Array.isArray(t)){var r,i=-1,o=t.length;if(null==e)for(;++i<o;)n.set(i,t[i]);else for(;++i<o;)n.set(e(r=t[i],i,t),r)}else if(t)for(var a in t)n.set(a,t[a]);return n}Vn.prototype=Xn.prototype={constructor:Vn,has:function(t){return zn+t in this},get:function(t){return this[zn+t]},set:function(t,e){return this[zn+t]=e,this},remove:function(t){var e=zn+t;return e in this&&delete this[e]},clear:function(){for(var t in this)t[0]===zn&&delete this[t]},keys:function(){var t=[];for(var e in this)e[0]===zn&&t.push(e.slice(1));return t},values:function(){var t=[];for(var e in this)e[0]===zn&&t.push(this[e]);return t},entries:function(){var t=[];for(var e in this)e[0]===zn&&t.push({key:e.slice(1),value:this[e]});return t},size:function(){var t=0;for(var e in this)e[0]===zn&&++t;return t},empty:function(){for(var t in this)if(t[0]===zn)return!1;return!0},each:function(t){for(var e in this)e[0]===zn&&t(this[e],e.slice(1),this)}};var Gn=Xn;function Bn(){}var Zn=Gn.prototype;function Wn(t,e){var n=new Bn;if(t instanceof Bn)t.each((function(t){n.add(t)}));else if(t){var r=-1,i=t.length;if(null==e)for(;++r<i;)n.add(t[r]);else for(;++r<i;)n.add(e(t[r],r,t))}return n}Bn.prototype=Wn.prototype={constructor:Bn,has:Zn.has,add:function(t){return this[zn+(t+="")]=t,this},remove:Zn.remove,clear:Zn.clear,values:Zn.keys,size:Zn.size,empty:Zn.empty,each:Zn.each};Array.prototype.slice;var Qn={},Kn={};function tr(t){return new Function("d","return {"+t.map((function(t,e){return JSON.stringify(t)+": d["+e+\'] || ""\'})).join(",")+"}")}function er(t){var e=Object.create(null),n=[];return t.forEach((function(t){for(var r in t)r in e||n.push(e[r]=r)})),n}function nr(t,e){var n=t+"",r=n.length;return r<e?new Array(e-r+1).join(0)+n:n}function rr(t){var e,n=t.getUTCHours(),r=t.getUTCMinutes(),i=t.getUTCSeconds(),o=t.getUTCMilliseconds();return isNaN(t)?"Invalid Date":((e=t.getUTCFullYear())<0?"-"+nr(-e,6):e>9999?"+"+nr(e,6):nr(e,4))+"-"+nr(t.getUTCMonth()+1,2)+"-"+nr(t.getUTCDate(),2)+(o?"T"+nr(n,2)+":"+nr(r,2)+":"+nr(i,2)+"."+nr(o,3)+"Z":i?"T"+nr(n,2)+":"+nr(r,2)+":"+nr(i,2)+"Z":r||n?"T"+nr(n,2)+":"+nr(r,2)+"Z":"")}var ir=function(t){var e=new RegExp(\'["\'+t+"\\n\\r]"),n=t.charCodeAt(0);function r(t,e){var r,i=[],o=t.length,a=0,u=0,s=o<=0,c=!1;function l(){if(s)return Kn;if(c)return c=!1,Qn;var e,r,i=a;if(34===t.charCodeAt(i)){for(;a++<o&&34!==t.charCodeAt(a)||34===t.charCodeAt(++a););return(e=a)>=o?s=!0:10===(r=t.charCodeAt(a++))?c=!0:13===r&&(c=!0,10===t.charCodeAt(a)&&++a),t.slice(i+1,e-1).replace(/""/g,\'"\')}for(;a<o;){if(10===(r=t.charCodeAt(e=a++)))c=!0;else if(13===r)c=!0,10===t.charCodeAt(a)&&++a;else if(r!==n)continue;return t.slice(i,e)}return s=!0,t.slice(i,o)}for(10===t.charCodeAt(o-1)&&--o,13===t.charCodeAt(o-1)&&--o;(r=l())!==Kn;){for(var f=[];r!==Qn&&r!==Kn;)f.push(r),r=l();e&&null==(f=e(f,u++))||i.push(f)}return i}function i(e,n){return e.map((function(e){return n.map((function(t){return a(e[t])})).join(t)}))}function o(e){return e.map(a).join(t)}function a(t){return null==t?"":t instanceof Date?rr(t):e.test(t+="")?\'"\'+t.replace(/"/g,\'""\')+\'"\':t}return{parse:function(t,e){var n,i,o=r(t,(function(t,r){if(n)return n(t,r-1);i=t,n=e?function(t,e){var n=tr(t);return function(r,i){return e(n(r),i,t)}}(t,e):tr(t)}));return o.columns=i||[],o},parseRows:r,format:function(e,n){return null==n&&(n=er(e)),[n.map(a).join(t)].concat(i(e,n)).join("\\n")},formatBody:function(t,e){return null==e&&(e=er(t)),i(t,e).join("\\n")},formatRows:function(t){return t.map(o).join("\\n")},formatRow:o,formatValue:a}},or=ir(","),ar=or.parse,ur=(or.parseRows,or.format,or.formatBody,or.formatRows,or.formatRow,or.formatValue,ir("\\t")),sr=ur.parse;ur.parseRows,ur.format,ur.formatBody,ur.formatRows,ur.formatRow,ur.formatValue;function cr(t){if(!t.ok)throw new Error(t.status+" "+t.statusText);return t.text()}var lr=function(t,e){return fetch(t,e).then(cr)};function fr(t){return function(e,n,r){return 2===arguments.length&&"function"===typeof n&&(r=n,n=void 0),lr(e,n).then((function(e){return t(e,r)}))}}var hr=fr(ar);fr(sr);function pr(t,e,n,r){if(isNaN(e)||isNaN(n))return t;var i,o,a,u,s,c,l,f,h,p=t._root,d={data:r},g=t._x0,v=t._y0,y=t._x1,m=t._y1;if(!p)return t._root=d,t;for(;p.length;)if((c=e>=(o=(g+y)/2))?g=o:y=o,(l=n>=(a=(v+m)/2))?v=a:m=a,i=p,!(p=p[f=l<<1|c]))return i[f]=d,t;if(u=+t._x.call(null,p.data),s=+t._y.call(null,p.data),e===u&&n===s)return d.next=p,i?i[f]=d:t._root=d,t;do{i=i?i[f]=new Array(4):t._root=new Array(4),(c=e>=(o=(g+y)/2))?g=o:y=o,(l=n>=(a=(v+m)/2))?v=a:m=a}while((f=l<<1|c)===(h=(s>=a)<<1|u>=o));return i[h]=p,i[f]=d,t}var dr=function(t,e,n,r,i){this.node=t,this.x0=e,this.y0=n,this.x1=r,this.y1=i};function gr(t){return t[0]}function vr(t){return t[1]}function yr(t,e,n){var r=new mr(null==e?gr:e,null==n?vr:n,NaN,NaN,NaN,NaN);return null==t?r:r.addAll(t)}function mr(t,e,n,r,i,o){this._x=t,this._y=e,this._x0=n,this._y0=r,this._x1=i,this._y1=o,this._root=void 0}function _r(t){for(var e={data:t.data},n=e;t=t.next;)n=n.next={data:t.data};return e}var wr=yr.prototype=mr.prototype;wr.copy=function(){var t,e,n=new mr(this._x,this._y,this._x0,this._y0,this._x1,this._y1),r=this._root;if(!r)return n;if(!r.length)return n._root=_r(r),n;for(t=[{source:r,target:n._root=new Array(4)}];r=t.pop();)for(var i=0;i<4;++i)(e=r.source[i])&&(e.length?t.push({source:e,target:r.target[i]=new Array(4)}):r.target[i]=_r(e));return n},wr.add=function(t){var e=+this._x.call(null,t),n=+this._y.call(null,t);return pr(this.cover(e,n),e,n,t)},wr.addAll=function(t){var e,n,r,i,o=t.length,a=new Array(o),u=new Array(o),s=1/0,c=1/0,l=-1/0,f=-1/0;for(n=0;n<o;++n)isNaN(r=+this._x.call(null,e=t[n]))||isNaN(i=+this._y.call(null,e))||(a[n]=r,u[n]=i,r<s&&(s=r),r>l&&(l=r),i<c&&(c=i),i>f&&(f=i));if(s>l||c>f)return this;for(this.cover(s,c).cover(l,f),n=0;n<o;++n)pr(this,a[n],u[n],t[n]);return this},wr.cover=function(t,e){if(isNaN(t=+t)||isNaN(e=+e))return this;var n=this._x0,r=this._y0,i=this._x1,o=this._y1;if(isNaN(n))i=(n=Math.floor(t))+1,o=(r=Math.floor(e))+1;else{for(var a,u,s=i-n,c=this._root;n>t||t>=i||r>e||e>=o;)switch(u=(e<r)<<1|t<n,(a=new Array(4))[u]=c,c=a,s*=2,u){case 0:i=n+s,o=r+s;break;case 1:n=i-s,o=r+s;break;case 2:i=n+s,r=o-s;break;case 3:n=i-s,r=o-s}this._root&&this._root.length&&(this._root=c)}return this._x0=n,this._y0=r,this._x1=i,this._y1=o,this},wr.data=function(){var t=[];return this.visit((function(e){if(!e.length)do{t.push(e.data)}while(e=e.next)})),t},wr.extent=function(t){return arguments.length?this.cover(+t[0][0],+t[0][1]).cover(+t[1][0],+t[1][1]):isNaN(this._x0)?void 0:[[this._x0,this._y0],[this._x1,this._y1]]},wr.find=function(t,e,n){var r,i,o,a,u,s,c,l=this._x0,f=this._y0,h=this._x1,p=this._y1,d=[],g=this._root;for(g&&d.push(new dr(g,l,f,h,p)),null==n?n=1/0:(l=t-n,f=e-n,h=t+n,p=e+n,n*=n);s=d.pop();)if(!(!(g=s.node)||(i=s.x0)>h||(o=s.y0)>p||(a=s.x1)<l||(u=s.y1)<f))if(g.length){var v=(i+a)/2,y=(o+u)/2;d.push(new dr(g[3],v,y,a,u),new dr(g[2],i,y,v,u),new dr(g[1],v,o,a,y),new dr(g[0],i,o,v,y)),(c=(e>=y)<<1|t>=v)&&(s=d[d.length-1],d[d.length-1]=d[d.length-1-c],d[d.length-1-c]=s)}else{var m=t-+this._x.call(null,g.data),_=e-+this._y.call(null,g.data),w=m*m+_*_;if(w<n){var b=Math.sqrt(n=w);l=t-b,f=e-b,h=t+b,p=e+b,r=g.data}}return r},wr.remove=function(t){if(isNaN(o=+this._x.call(null,t))||isNaN(a=+this._y.call(null,t)))return this;var e,n,r,i,o,a,u,s,c,l,f,h,p=this._root,d=this._x0,g=this._y0,v=this._x1,y=this._y1;if(!p)return this;if(p.length)for(;;){if((c=o>=(u=(d+v)/2))?d=u:v=u,(l=a>=(s=(g+y)/2))?g=s:y=s,e=p,!(p=p[f=l<<1|c]))return this;if(!p.length)break;(e[f+1&3]||e[f+2&3]||e[f+3&3])&&(n=e,h=f)}for(;p.data!==t;)if(r=p,!(p=p.next))return this;return(i=p.next)&&delete p.next,r?(i?r.next=i:delete r.next,this):e?(i?e[f]=i:delete e[f],(p=e[0]||e[1]||e[2]||e[3])&&p===(e[3]||e[2]||e[1]||e[0])&&!p.length&&(n?n[h]=p:this._root=p),this):(this._root=i,this)},wr.removeAll=function(t){for(var e=0,n=t.length;e<n;++e)this.remove(t[e]);return this},wr.root=function(){return this._root},wr.size=function(){var t=0;return this.visit((function(e){if(!e.length)do{++t}while(e=e.next)})),t},wr.visit=function(t){var e,n,r,i,o,a,u=[],s=this._root;for(s&&u.push(new dr(s,this._x0,this._y0,this._x1,this._y1));e=u.pop();)if(!t(s=e.node,r=e.x0,i=e.y0,o=e.x1,a=e.y1)&&s.length){var c=(r+o)/2,l=(i+a)/2;(n=s[3])&&u.push(new dr(n,c,l,o,a)),(n=s[2])&&u.push(new dr(n,r,l,c,a)),(n=s[1])&&u.push(new dr(n,c,i,o,l)),(n=s[0])&&u.push(new dr(n,r,i,c,l))}return this},wr.visitAfter=function(t){var e,n=[],r=[];for(this._root&&n.push(new dr(this._root,this._x0,this._y0,this._x1,this._y1));e=n.pop();){var i=e.node;if(i.length){var o,a=e.x0,u=e.y0,s=e.x1,c=e.y1,l=(a+s)/2,f=(u+c)/2;(o=i[0])&&n.push(new dr(o,a,u,l,f)),(o=i[1])&&n.push(new dr(o,l,u,s,f)),(o=i[2])&&n.push(new dr(o,a,f,l,c)),(o=i[3])&&n.push(new dr(o,l,f,s,c))}r.push(e)}for(;e=r.pop();)t(e.node,e.x0,e.y0,e.x1,e.y1);return this},wr.x=function(t){return arguments.length?(this._x=t,this):this._x},wr.y=function(t){return arguments.length?(this._y=t,this):this._y};Math.PI,Math.sqrt(5);var br=function(){return Math.random()},xr=(function t(e){function n(t,n){return t=null==t?0:+t,n=null==n?1:+n,1===arguments.length?(n=t,t=0):n-=t,function(){return e()*n+t}}return n.source=t,n}(br),function t(e){function n(t,n){var r,i;return t=null==t?0:+t,n=null==n?1:+n,function(){var o;if(null!=r)o=r,r=null;else do{r=2*e()-1,o=2*e()-1,i=r*r+o*o}while(!i||i>1);return t+n*o*Math.sqrt(-2*Math.log(i)/i)}}return n.source=t,n}(br)),Cr=(function t(e){function n(){var t=xr.source(e).apply(this,arguments);return function(){return Math.exp(t())}}return n.source=t,n}(br),function t(e){function n(t){return function(){for(var n=0,r=0;r<t;++r)n+=e();return n}}return n.source=t,n}(br));(function t(e){function n(t){var n=Cr.source(e)(t);return function(){return n()/t}}return n.source=t,n})(br),function t(e){function n(t){return function(){return-Math.log(1-e())/t}}return n.source=t,n}(br);var Mr=Array.prototype;Mr.map,Mr.slice;var Pr=/^(?:(.)?([<>=^]))?([+\\-( ])?([$#])?(0)?(\\d+)?(,)?(\\.\\d+)?(~)?([a-z%])?$/i;function kr(t){if(!(e=Pr.exec(t)))throw new Error("invalid format: "+t);var e;return new Er({fill:e[1],align:e[2],sign:e[3],symbol:e[4],zero:e[5],width:e[6],comma:e[7],precision:e[8]&&e[8].slice(1),trim:e[9],type:e[10]})}function Er(t){this.fill=void 0===t.fill?" ":t.fill+"",this.align=void 0===t.align?">":t.align+"",this.sign=void 0===t.sign?"-":t.sign+"",this.symbol=void 0===t.symbol?"":t.symbol+"",this.zero=!!t.zero,this.width=void 0===t.width?void 0:+t.width,this.comma=!!t.comma,this.precision=void 0===t.precision?void 0:+t.precision,this.trim=!!t.trim,this.type=void 0===t.type?"":t.type+""}kr.prototype=Er.prototype,Er.prototype.toString=function(){return this.fill+this.align+this.sign+this.symbol+(this.zero?"0":"")+(void 0===this.width?"":Math.max(1,0|this.width))+(this.comma?",":"")+(void 0===this.precision?"":"."+Math.max(0,0|this.precision))+(this.trim?"~":"")+this.type};function Tr(t,e){if((n=(t=e?t.toExponential(e-1):t.toExponential()).indexOf("e"))<0)return null;var n,r=t.slice(0,n);return[r.length>1?r[0]+r.slice(2):r,+t.slice(n+1)]}var Or,Sr,Nr=function(t){return(t=Tr(Math.abs(t)))?t[1]:NaN},jr=function(t,e){var n=Tr(t,e);if(!n)return t+"";var r=n[0],i=n[1];return i<0?"0."+new Array(-i).join("0")+r:r.length>i+1?r.slice(0,i+1)+"."+r.slice(i+1):r+new Array(i-r.length+2).join("0")},Ur={"%":function(t,e){return(100*t).toFixed(e)},b:function(t){return Math.round(t).toString(2)},c:function(t){return t+""},d:function(t){return Math.abs(t=Math.round(t))>=1e21?t.toLocaleString("en").replace(/,/g,""):t.toString(10)},e:function(t,e){return t.toExponential(e)},f:function(t,e){return t.toFixed(e)},g:function(t,e){return t.toPrecision(e)},o:function(t){return Math.round(t).toString(8)},p:function(t,e){return jr(100*t,e)},r:jr,s:function(t,e){var n=Tr(t,e);if(!n)return t+"";var r=n[0],i=n[1],o=i-(Or=3*Math.max(-8,Math.min(8,Math.floor(i/3))))+1,a=r.length;return o===a?r:o>a?r+new Array(o-a+1).join("0"):o>0?r.slice(0,o)+"."+r.slice(o):"0."+new Array(1-o).join("0")+Tr(t,Math.max(0,e+o-1))[0]},X:function(t){return Math.round(t).toString(16).toUpperCase()},x:function(t){return Math.round(t).toString(16)}},Ar=function(t){return t},Lr=Array.prototype.map,Dr=["y","z","a","f","p","n","\\xb5","m","","k","M","G","T","P","E","Z","Y"];Sr=function(t){var e,n,r=void 0===t.grouping||void 0===t.thousands?Ar:(e=Lr.call(t.grouping,Number),n=t.thousands+"",function(t,r){for(var i=t.length,o=[],a=0,u=e[0],s=0;i>0&&u>0&&(s+u+1>r&&(u=Math.max(1,r-s)),o.push(t.substring(i-=u,i+u)),!((s+=u+1)>r));)u=e[a=(a+1)%e.length];return o.reverse().join(n)}),i=void 0===t.currency?"":t.currency[0]+"",o=void 0===t.currency?"":t.currency[1]+"",a=void 0===t.decimal?".":t.decimal+"",u=void 0===t.numerals?Ar:function(t){return function(e){return e.replace(/[0-9]/g,(function(e){return t[+e]}))}}(Lr.call(t.numerals,String)),s=void 0===t.percent?"%":t.percent+"",c=void 0===t.minus?"-":t.minus+"",l=void 0===t.nan?"NaN":t.nan+"";function f(t){var e=(t=kr(t)).fill,n=t.align,f=t.sign,h=t.symbol,p=t.zero,d=t.width,g=t.comma,v=t.precision,y=t.trim,m=t.type;"n"===m?(g=!0,m="g"):Ur[m]||(void 0===v&&(v=12),y=!0,m="g"),(p||"0"===e&&"="===n)&&(p=!0,e="0",n="=");var _="$"===h?i:"#"===h&&/[boxX]/.test(m)?"0"+m.toLowerCase():"",w="$"===h?o:/[%p]/.test(m)?s:"",b=Ur[m],x=/[defgprs%]/.test(m);function C(t){var i,o,s,h=_,C=w;if("c"===m)C=b(t)+C,t="";else{var M=(t=+t)<0||1/t<0;if(t=isNaN(t)?l:b(Math.abs(t),v),y&&(t=function(t){t:for(var e,n=t.length,r=1,i=-1;r<n;++r)switch(t[r]){case".":i=e=r;break;case"0":0===i&&(i=r),e=r;break;default:if(!+t[r])break t;i>0&&(i=0)}return i>0?t.slice(0,i)+t.slice(e+1):t}(t)),M&&0===+t&&"+"!==f&&(M=!1),h=(M?"("===f?f:c:"-"===f||"("===f?"":f)+h,C=("s"===m?Dr[8+Or/3]:"")+C+(M&&"("===f?")":""),x)for(i=-1,o=t.length;++i<o;)if(48>(s=t.charCodeAt(i))||s>57){C=(46===s?a+t.slice(i+1):t.slice(i))+C,t=t.slice(0,i);break}}g&&!p&&(t=r(t,1/0));var P=h.length+t.length+C.length,k=P<d?new Array(d-P+1).join(e):"";switch(g&&p&&(t=r(k+t,k.length?d-C.length:1/0),k=""),n){case"<":t=h+t+C+k;break;case"=":t=h+k+t+C;break;case"^":t=k.slice(0,P=k.length>>1)+h+t+C+k.slice(P);break;default:t=k+h+t+C}return u(t)}return v=void 0===v?6:/[gprs]/.test(m)?Math.max(1,Math.min(21,v)):Math.max(0,Math.min(20,v)),C.toString=function(){return t+""},C}return{format:f,formatPrefix:function(t,e){var n=f(((t=kr(t)).type="f",t)),r=3*Math.max(-8,Math.min(8,Math.floor(Nr(e)/3))),i=Math.pow(10,-r),o=Dr[8+r/3];return function(t){return n(i*t)+o}}}}({decimal:".",thousands:",",grouping:[3],currency:["$",""],minus:"-"}),Sr.format,Sr.formatPrefix;var Rr=new Date,Fr=new Date;function Ir(t,e,n,r){function i(e){return t(e=0===arguments.length?new Date:new Date(+e)),e}return i.floor=function(e){return t(e=new Date(+e)),e},i.ceil=function(n){return t(n=new Date(n-1)),e(n,1),t(n),n},i.round=function(t){var e=i(t),n=i.ceil(t);return t-e<n-t?e:n},i.offset=function(t,n){return e(t=new Date(+t),null==n?1:Math.floor(n)),t},i.range=function(n,r,o){var a,u=[];if(n=i.ceil(n),o=null==o?1:Math.floor(o),!(n<r)||!(o>0))return u;do{u.push(a=new Date(+n)),e(n,o),t(n)}while(a<n&&n<r);return u},i.filter=function(n){return Ir((function(e){if(e>=e)for(;t(e),!n(e);)e.setTime(e-1)}),(function(t,r){if(t>=t)if(r<0)for(;++r<=0;)for(;e(t,-1),!n(t););else for(;--r>=0;)for(;e(t,1),!n(t););}))},n&&(i.count=function(e,r){return Rr.setTime(+e),Fr.setTime(+r),t(Rr),t(Fr),Math.floor(n(Rr,Fr))},i.every=function(t){return t=Math.floor(t),isFinite(t)&&t>0?t>1?i.filter(r?function(e){return r(e)%t===0}:function(e){return i.count(0,e)%t===0}):i:null}),i}var Yr=Ir((function(t){t.setMonth(0,1),t.setHours(0,0,0,0)}),(function(t,e){t.setFullYear(t.getFullYear()+e)}),(function(t,e){return e.getFullYear()-t.getFullYear()}),(function(t){return t.getFullYear()}));Yr.every=function(t){return isFinite(t=Math.floor(t))&&t>0?Ir((function(e){e.setFullYear(Math.floor(e.getFullYear()/t)*t),e.setMonth(0,1),e.setHours(0,0,0,0)}),(function(e,n){e.setFullYear(e.getFullYear()+n*t)})):null};var Hr=Yr,qr=(Yr.range,Ir((function(t){t.setDate(1),t.setHours(0,0,0,0)}),(function(t,e){t.setMonth(t.getMonth()+e)}),(function(t,e){return e.getMonth()-t.getMonth()+12*(e.getFullYear()-t.getFullYear())}),(function(t){return t.getMonth()}))),$r=(qr.range,1e3),Jr=6e4,zr=36e5,Vr=864e5,Xr=6048e5;function Gr(t){return Ir((function(e){e.setDate(e.getDate()-(e.getDay()+7-t)%7),e.setHours(0,0,0,0)}),(function(t,e){t.setDate(t.getDate()+7*e)}),(function(t,e){return(e-t-(e.getTimezoneOffset()-t.getTimezoneOffset())*Jr)/Xr}))}var Br=Gr(0),Zr=Gr(1),Wr=Gr(2),Qr=Gr(3),Kr=Gr(4),ti=Gr(5),ei=Gr(6),ni=(Br.range,Zr.range,Wr.range,Qr.range,Kr.range,ti.range,ei.range,Ir((function(t){t.setHours(0,0,0,0)}),(function(t,e){t.setDate(t.getDate()+e)}),(function(t,e){return(e-t-(e.getTimezoneOffset()-t.getTimezoneOffset())*Jr)/Vr}),(function(t){return t.getDate()-1}))),ri=ni,ii=(ni.range,Ir((function(t){t.setTime(t-t.getMilliseconds()-t.getSeconds()*$r-t.getMinutes()*Jr)}),(function(t,e){t.setTime(+t+e*zr)}),(function(t,e){return(e-t)/zr}),(function(t){return t.getHours()}))),oi=(ii.range,Ir((function(t){t.setTime(t-t.getMilliseconds()-t.getSeconds()*$r)}),(function(t,e){t.setTime(+t+e*Jr)}),(function(t,e){return(e-t)/Jr}),(function(t){return t.getMinutes()}))),ai=(oi.range,Ir((function(t){t.setTime(t-t.getMilliseconds())}),(function(t,e){t.setTime(+t+e*$r)}),(function(t,e){return(e-t)/$r}),(function(t){return t.getUTCSeconds()}))),ui=(ai.range,Ir((function(){}),(function(t,e){t.setTime(+t+e)}),(function(t,e){return e-t})));ui.every=function(t){return t=Math.floor(t),isFinite(t)&&t>0?t>1?Ir((function(e){e.setTime(Math.floor(e/t)*t)}),(function(e,n){e.setTime(+e+n*t)}),(function(e,n){return(n-e)/t})):ui:null};ui.range;function si(t){return Ir((function(e){e.setUTCDate(e.getUTCDate()-(e.getUTCDay()+7-t)%7),e.setUTCHours(0,0,0,0)}),(function(t,e){t.setUTCDate(t.getUTCDate()+7*e)}),(function(t,e){return(e-t)/Xr}))}var ci=si(0),li=si(1),fi=si(2),hi=si(3),pi=si(4),di=si(5),gi=si(6),vi=(ci.range,li.range,fi.range,hi.range,pi.range,di.range,gi.range,Ir((function(t){t.setUTCHours(0,0,0,0)}),(function(t,e){t.setUTCDate(t.getUTCDate()+e)}),(function(t,e){return(e-t)/Vr}),(function(t){return t.getUTCDate()-1}))),yi=vi,mi=(vi.range,Ir((function(t){t.setUTCMonth(0,1),t.setUTCHours(0,0,0,0)}),(function(t,e){t.setUTCFullYear(t.getUTCFullYear()+e)}),(function(t,e){return e.getUTCFullYear()-t.getUTCFullYear()}),(function(t){return t.getUTCFullYear()})));mi.every=function(t){return isFinite(t=Math.floor(t))&&t>0?Ir((function(e){e.setUTCFullYear(Math.floor(e.getUTCFullYear()/t)*t),e.setUTCMonth(0,1),e.setUTCHours(0,0,0,0)}),(function(e,n){e.setUTCFullYear(e.getUTCFullYear()+n*t)})):null};var _i=mi;mi.range;function wi(t){if(0<=t.y&&t.y<100){var e=new Date(-1,t.m,t.d,t.H,t.M,t.S,t.L);return e.setFullYear(t.y),e}return new Date(t.y,t.m,t.d,t.H,t.M,t.S,t.L)}function bi(t){if(0<=t.y&&t.y<100){var e=new Date(Date.UTC(-1,t.m,t.d,t.H,t.M,t.S,t.L));return e.setUTCFullYear(t.y),e}return new Date(Date.UTC(t.y,t.m,t.d,t.H,t.M,t.S,t.L))}function xi(t,e,n){return{y:t,m:e,d:n,H:0,M:0,S:0,L:0}}var Ci,Mi={"-":"",_:" ",0:"0"},Pi=/^\\s*\\d+/,ki=/^%/,Ei=/[\\\\^$*+?|[\\]().{}]/g;function Ti(t,e,n){var r=t<0?"-":"",i=(r?-t:t)+"",o=i.length;return r+(o<n?new Array(n-o+1).join(e)+i:i)}function Oi(t){return t.replace(Ei,"\\\\$&")}function Si(t){return new RegExp("^(?:"+t.map(Oi).join("|")+")","i")}function Ni(t){for(var e={},n=-1,r=t.length;++n<r;)e[t[n].toLowerCase()]=n;return e}function ji(t,e,n){var r=Pi.exec(e.slice(n,n+1));return r?(t.w=+r[0],n+r[0].length):-1}function Ui(t,e,n){var r=Pi.exec(e.slice(n,n+1));return r?(t.u=+r[0],n+r[0].length):-1}function Ai(t,e,n){var r=Pi.exec(e.slice(n,n+2));return r?(t.U=+r[0],n+r[0].length):-1}function Li(t,e,n){var r=Pi.exec(e.slice(n,n+2));return r?(t.V=+r[0],n+r[0].length):-1}function Di(t,e,n){var r=Pi.exec(e.slice(n,n+2));return r?(t.W=+r[0],n+r[0].length):-1}function Ri(t,e,n){var r=Pi.exec(e.slice(n,n+4));return r?(t.y=+r[0],n+r[0].length):-1}function Fi(t,e,n){var r=Pi.exec(e.slice(n,n+2));return r?(t.y=+r[0]+(+r[0]>68?1900:2e3),n+r[0].length):-1}function Ii(t,e,n){var r=/^(Z)|([+-]\\d\\d)(?::?(\\d\\d))?/.exec(e.slice(n,n+6));return r?(t.Z=r[1]?0:-(r[2]+(r[3]||"00")),n+r[0].length):-1}function Yi(t,e,n){var r=Pi.exec(e.slice(n,n+1));return r?(t.q=3*r[0]-3,n+r[0].length):-1}function Hi(t,e,n){var r=Pi.exec(e.slice(n,n+2));return r?(t.m=r[0]-1,n+r[0].length):-1}function qi(t,e,n){var r=Pi.exec(e.slice(n,n+2));return r?(t.d=+r[0],n+r[0].length):-1}function $i(t,e,n){var r=Pi.exec(e.slice(n,n+3));return r?(t.m=0,t.d=+r[0],n+r[0].length):-1}function Ji(t,e,n){var r=Pi.exec(e.slice(n,n+2));return r?(t.H=+r[0],n+r[0].length):-1}function zi(t,e,n){var r=Pi.exec(e.slice(n,n+2));return r?(t.M=+r[0],n+r[0].length):-1}function Vi(t,e,n){var r=Pi.exec(e.slice(n,n+2));return r?(t.S=+r[0],n+r[0].length):-1}function Xi(t,e,n){var r=Pi.exec(e.slice(n,n+3));return r?(t.L=+r[0],n+r[0].length):-1}function Gi(t,e,n){var r=Pi.exec(e.slice(n,n+6));return r?(t.L=Math.floor(r[0]/1e3),n+r[0].length):-1}function Bi(t,e,n){var r=ki.exec(e.slice(n,n+1));return r?n+r[0].length:-1}function Zi(t,e,n){var r=Pi.exec(e.slice(n));return r?(t.Q=+r[0],n+r[0].length):-1}function Wi(t,e,n){var r=Pi.exec(e.slice(n));return r?(t.s=+r[0],n+r[0].length):-1}function Qi(t,e){return Ti(t.getDate(),e,2)}function Ki(t,e){return Ti(t.getHours(),e,2)}function to(t,e){return Ti(t.getHours()%12||12,e,2)}function eo(t,e){return Ti(1+ri.count(Hr(t),t),e,3)}function no(t,e){return Ti(t.getMilliseconds(),e,3)}function ro(t,e){return no(t,e)+"000"}function io(t,e){return Ti(t.getMonth()+1,e,2)}function oo(t,e){return Ti(t.getMinutes(),e,2)}function ao(t,e){return Ti(t.getSeconds(),e,2)}function uo(t){var e=t.getDay();return 0===e?7:e}function so(t,e){return Ti(Br.count(Hr(t)-1,t),e,2)}function co(t){var e=t.getDay();return e>=4||0===e?Kr(t):Kr.ceil(t)}function lo(t,e){return t=co(t),Ti(Kr.count(Hr(t),t)+(4===Hr(t).getDay()),e,2)}function fo(t){return t.getDay()}function ho(t,e){return Ti(Zr.count(Hr(t)-1,t),e,2)}function po(t,e){return Ti(t.getFullYear()%100,e,2)}function go(t,e){return Ti((t=co(t)).getFullYear()%100,e,2)}function vo(t,e){return Ti(t.getFullYear()%1e4,e,4)}function yo(t,e){var n=t.getDay();return Ti((t=n>=4||0===n?Kr(t):Kr.ceil(t)).getFullYear()%1e4,e,4)}function mo(t){var e=t.getTimezoneOffset();return(e>0?"-":(e*=-1,"+"))+Ti(e/60|0,"0",2)+Ti(e%60,"0",2)}function _o(t,e){return Ti(t.getUTCDate(),e,2)}function wo(t,e){return Ti(t.getUTCHours(),e,2)}function bo(t,e){return Ti(t.getUTCHours()%12||12,e,2)}function xo(t,e){return Ti(1+yi.count(_i(t),t),e,3)}function Co(t,e){return Ti(t.getUTCMilliseconds(),e,3)}function Mo(t,e){return Co(t,e)+"000"}function Po(t,e){return Ti(t.getUTCMonth()+1,e,2)}function ko(t,e){return Ti(t.getUTCMinutes(),e,2)}function Eo(t,e){return Ti(t.getUTCSeconds(),e,2)}function To(t){var e=t.getUTCDay();return 0===e?7:e}function Oo(t,e){return Ti(ci.count(_i(t)-1,t),e,2)}function So(t){var e=t.getUTCDay();return e>=4||0===e?pi(t):pi.ceil(t)}function No(t,e){return t=So(t),Ti(pi.count(_i(t),t)+(4===_i(t).getUTCDay()),e,2)}function jo(t){return t.getUTCDay()}function Uo(t,e){return Ti(li.count(_i(t)-1,t),e,2)}function Ao(t,e){return Ti(t.getUTCFullYear()%100,e,2)}function Lo(t,e){return Ti((t=So(t)).getUTCFullYear()%100,e,2)}function Do(t,e){return Ti(t.getUTCFullYear()%1e4,e,4)}function Ro(t,e){var n=t.getUTCDay();return Ti((t=n>=4||0===n?pi(t):pi.ceil(t)).getUTCFullYear()%1e4,e,4)}function Fo(){return"+0000"}function Io(){return"%"}function Yo(t){return+t}function Ho(t){return Math.floor(+t/1e3)}!function(t){Ci=function(t){var e=t.dateTime,n=t.date,r=t.time,i=t.periods,o=t.days,a=t.shortDays,u=t.months,s=t.shortMonths,c=Si(i),l=Ni(i),f=Si(o),h=Ni(o),p=Si(a),d=Ni(a),g=Si(u),v=Ni(u),y=Si(s),m=Ni(s),_={a:function(t){return a[t.getDay()]},A:function(t){return o[t.getDay()]},b:function(t){return s[t.getMonth()]},B:function(t){return u[t.getMonth()]},c:null,d:Qi,e:Qi,f:ro,g:go,G:yo,H:Ki,I:to,j:eo,L:no,m:io,M:oo,p:function(t){return i[+(t.getHours()>=12)]},q:function(t){return 1+~~(t.getMonth()/3)},Q:Yo,s:Ho,S:ao,u:uo,U:so,V:lo,w:fo,W:ho,x:null,X:null,y:po,Y:vo,Z:mo,"%":Io},w={a:function(t){return a[t.getUTCDay()]},A:function(t){return o[t.getUTCDay()]},b:function(t){return s[t.getUTCMonth()]},B:function(t){return u[t.getUTCMonth()]},c:null,d:_o,e:_o,f:Mo,g:Lo,G:Ro,H:wo,I:bo,j:xo,L:Co,m:Po,M:ko,p:function(t){return i[+(t.getUTCHours()>=12)]},q:function(t){return 1+~~(t.getUTCMonth()/3)},Q:Yo,s:Ho,S:Eo,u:To,U:Oo,V:No,w:jo,W:Uo,x:null,X:null,y:Ao,Y:Do,Z:Fo,"%":Io},b={a:function(t,e,n){var r=p.exec(e.slice(n));return r?(t.w=d[r[0].toLowerCase()],n+r[0].length):-1},A:function(t,e,n){var r=f.exec(e.slice(n));return r?(t.w=h[r[0].toLowerCase()],n+r[0].length):-1},b:function(t,e,n){var r=y.exec(e.slice(n));return r?(t.m=m[r[0].toLowerCase()],n+r[0].length):-1},B:function(t,e,n){var r=g.exec(e.slice(n));return r?(t.m=v[r[0].toLowerCase()],n+r[0].length):-1},c:function(t,n,r){return M(t,e,n,r)},d:qi,e:qi,f:Gi,g:Fi,G:Ri,H:Ji,I:Ji,j:$i,L:Xi,m:Hi,M:zi,p:function(t,e,n){var r=c.exec(e.slice(n));return r?(t.p=l[r[0].toLowerCase()],n+r[0].length):-1},q:Yi,Q:Zi,s:Wi,S:Vi,u:Ui,U:Ai,V:Li,w:ji,W:Di,x:function(t,e,r){return M(t,n,e,r)},X:function(t,e,n){return M(t,r,e,n)},y:Fi,Y:Ri,Z:Ii,"%":Bi};function x(t,e){return function(n){var r,i,o,a=[],u=-1,s=0,c=t.length;for(n instanceof Date||(n=new Date(+n));++u<c;)37===t.charCodeAt(u)&&(a.push(t.slice(s,u)),null!=(i=Mi[r=t.charAt(++u)])?r=t.charAt(++u):i="e"===r?" ":"0",(o=e[r])&&(r=o(n,i)),a.push(r),s=u+1);return a.push(t.slice(s,u)),a.join("")}}function C(t,e){return function(n){var r,i,o=xi(1900,void 0,1);if(M(o,t,n+="",0)!=n.length)return null;if("Q"in o)return new Date(o.Q);if("s"in o)return new Date(1e3*o.s+("L"in o?o.L:0));if(e&&!("Z"in o)&&(o.Z=0),"p"in o&&(o.H=o.H%12+12*o.p),void 0===o.m&&(o.m="q"in o?o.q:0),"V"in o){if(o.V<1||o.V>53)return null;"w"in o||(o.w=1),"Z"in o?(i=(r=bi(xi(o.y,0,1))).getUTCDay(),r=i>4||0===i?li.ceil(r):li(r),r=yi.offset(r,7*(o.V-1)),o.y=r.getUTCFullYear(),o.m=r.getUTCMonth(),o.d=r.getUTCDate()+(o.w+6)%7):(i=(r=wi(xi(o.y,0,1))).getDay(),r=i>4||0===i?Zr.ceil(r):Zr(r),r=ri.offset(r,7*(o.V-1)),o.y=r.getFullYear(),o.m=r.getMonth(),o.d=r.getDate()+(o.w+6)%7)}else("W"in o||"U"in o)&&("w"in o||(o.w="u"in o?o.u%7:"W"in o?1:0),i="Z"in o?bi(xi(o.y,0,1)).getUTCDay():wi(xi(o.y,0,1)).getDay(),o.m=0,o.d="W"in o?(o.w+6)%7+7*o.W-(i+5)%7:o.w+7*o.U-(i+6)%7);return"Z"in o?(o.H+=o.Z/100|0,o.M+=o.Z%100,bi(o)):wi(o)}}function M(t,e,n,r){for(var i,o,a=0,u=e.length,s=n.length;a<u;){if(r>=s)return-1;if(37===(i=e.charCodeAt(a++))){if(i=e.charAt(a++),!(o=b[i in Mi?e.charAt(a++):i])||(r=o(t,n,r))<0)return-1}else if(i!=n.charCodeAt(r++))return-1}return r}return _.x=x(n,_),_.X=x(r,_),_.c=x(e,_),w.x=x(n,w),w.X=x(r,w),w.c=x(e,w),{format:function(t){var e=x(t+="",_);return e.toString=function(){return t},e},parse:function(t){var e=C(t+="",!1);return e.toString=function(){return t},e},utcFormat:function(t){var e=x(t+="",w);return e.toString=function(){return t},e},utcParse:function(t){var e=C(t+="",!0);return e.toString=function(){return t},e}}}(t),Ci.format,Ci.parse,Ci.utcFormat,Ci.utcParse}({dateTime:"%x, %X",date:"%-m/%-d/%Y",time:"%-I:%M:%S %p",periods:["AM","PM"],days:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],shortDays:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],months:["January","February","March","April","May","June","July","August","September","October","November","December"],shortMonths:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"]});var qo=Ir((function(t){t.setUTCDate(1),t.setUTCHours(0,0,0,0)}),(function(t,e){t.setUTCMonth(t.getUTCMonth()+e)}),(function(t,e){return e.getUTCMonth()-t.getUTCMonth()+12*(e.getUTCFullYear()-t.getUTCFullYear())}),(function(t){return t.getUTCMonth()})),$o=(qo.range,Ir((function(t){t.setUTCMinutes(0,0,0)}),(function(t,e){t.setTime(+t+e*zr)}),(function(t,e){return(e-t)/zr}),(function(t){return t.getUTCHours()}))),Jo=($o.range,Ir((function(t){t.setUTCSeconds(0,0)}),(function(t,e){t.setTime(+t+e*Jr)}),(function(t,e){return(e-t)/Jr}),(function(t){return t.getUTCMinutes()})));Jo.range;function zo(){this._=null}function Vo(t){t.U=t.C=t.L=t.R=t.P=t.N=null}function Xo(t,e){var n=e,r=e.R,i=n.U;i?i.L===n?i.L=r:i.R=r:t._=r,r.U=i,n.U=r,n.R=r.L,n.R&&(n.R.U=n),r.L=n}function Go(t,e){var n=e,r=e.L,i=n.U;i?i.L===n?i.L=r:i.R=r:t._=r,r.U=i,n.U=r,n.L=r.R,n.L&&(n.L.U=n),r.R=n}function Bo(t){for(;t.L;)t=t.L;return t}zo.prototype={constructor:zo,insert:function(t,e){var n,r,i;if(t){if(e.P=t,e.N=t.N,t.N&&(t.N.P=e),t.N=e,t.R){for(t=t.R;t.L;)t=t.L;t.L=e}else t.R=e;n=t}else this._?(t=Bo(this._),e.P=null,e.N=t,t.P=t.L=e,n=t):(e.P=e.N=null,this._=e,n=null);for(e.L=e.R=null,e.U=n,e.C=!0,t=e;n&&n.C;)n===(r=n.U).L?(i=r.R)&&i.C?(n.C=i.C=!1,r.C=!0,t=r):(t===n.R&&(Xo(this,n),n=(t=n).U),n.C=!1,r.C=!0,Go(this,r)):(i=r.L)&&i.C?(n.C=i.C=!1,r.C=!0,t=r):(t===n.L&&(Go(this,n),n=(t=n).U),n.C=!1,r.C=!0,Xo(this,r)),n=t.U;this._.C=!1},remove:function(t){t.N&&(t.N.P=t.P),t.P&&(t.P.N=t.N),t.N=t.P=null;var e,n,r,i=t.U,o=t.L,a=t.R;if(n=o?a?Bo(a):o:a,i?i.L===t?i.L=n:i.R=n:this._=n,o&&a?(r=n.C,n.C=t.C,n.L=o,o.U=n,n!==a?(i=n.U,n.U=t.U,t=n.R,i.L=t,n.R=a,a.U=n):(n.U=i,i=n,t=n.R)):(r=t.C,t=n),t&&(t.U=i),!r)if(t&&t.C)t.C=!1;else{do{if(t===this._)break;if(t===i.L){if((e=i.R).C&&(e.C=!1,i.C=!0,Xo(this,i),e=i.R),e.L&&e.L.C||e.R&&e.R.C){e.R&&e.R.C||(e.L.C=!1,e.C=!0,Go(this,e),e=i.R),e.C=i.C,i.C=e.R.C=!1,Xo(this,i),t=this._;break}}else if((e=i.L).C&&(e.C=!1,i.C=!0,Go(this,i),e=i.L),e.L&&e.L.C||e.R&&e.R.C){e.L&&e.L.C||(e.R.C=!1,e.C=!0,Xo(this,e),e=i.L),e.C=i.C,i.C=e.L.C=!1,Go(this,i),t=this._;break}e.C=!0,t=i,i=i.U}while(!t.C);t&&(t.C=!1)}}};var Zo=zo;function Wo(t,e,n,r){var i=[null,null],o=ba.push(i)-1;return i.left=t,i.right=e,n&&Ko(i,t,e,n),r&&Ko(i,e,t,r),_a[t.index].halfedges.push(o),_a[e.index].halfedges.push(o),i}function Qo(t,e,n){var r=[e,n];return r.left=t,r}function Ko(t,e,n,r){t[0]||t[1]?t.left===n?t[1]=r:t[0]=r:(t[0]=r,t.left=e,t.right=n)}function ta(t,e,n,r,i){var o,a=t[0],u=t[1],s=a[0],c=a[1],l=0,f=1,h=u[0]-s,p=u[1]-c;if(o=e-s,h||!(o>0)){if(o/=h,h<0){if(o<l)return;o<f&&(f=o)}else if(h>0){if(o>f)return;o>l&&(l=o)}if(o=r-s,h||!(o<0)){if(o/=h,h<0){if(o>f)return;o>l&&(l=o)}else if(h>0){if(o<l)return;o<f&&(f=o)}if(o=n-c,p||!(o>0)){if(o/=p,p<0){if(o<l)return;o<f&&(f=o)}else if(p>0){if(o>f)return;o>l&&(l=o)}if(o=i-c,p||!(o<0)){if(o/=p,p<0){if(o>f)return;o>l&&(l=o)}else if(p>0){if(o<l)return;o<f&&(f=o)}return!(l>0||f<1)||(l>0&&(t[0]=[s+l*h,c+l*p]),f<1&&(t[1]=[s+f*h,c+f*p]),!0)}}}}}function ea(t,e,n,r,i){var o=t[1];if(o)return!0;var a,u,s=t[0],c=t.left,l=t.right,f=c[0],h=c[1],p=l[0],d=l[1],g=(f+p)/2,v=(h+d)/2;if(d===h){if(g<e||g>=r)return;if(f>p){if(s){if(s[1]>=i)return}else s=[g,n];o=[g,i]}else{if(s){if(s[1]<n)return}else s=[g,i];o=[g,n]}}else if(u=v-(a=(f-p)/(d-h))*g,a<-1||a>1)if(f>p){if(s){if(s[1]>=i)return}else s=[(n-u)/a,n];o=[(i-u)/a,i]}else{if(s){if(s[1]<n)return}else s=[(i-u)/a,i];o=[(n-u)/a,n]}else if(h<d){if(s){if(s[0]>=r)return}else s=[e,a*e+u];o=[r,a*r+u]}else{if(s){if(s[0]<e)return}else s=[r,a*r+u];o=[e,a*e+u]}return t[0]=s,t[1]=o,!0}function na(t,e){var n=t.site,r=e.left,i=e.right;return n===i&&(i=r,r=n),i?Math.atan2(i[1]-r[1],i[0]-r[0]):(n===r?(r=e[1],i=e[0]):(r=e[0],i=e[1]),Math.atan2(r[0]-i[0],i[1]-r[1]))}function ra(t,e){return e[+(e.left!==t.site)]}function ia(t,e){return e[+(e.left===t.site)]}var oa,aa=[];function ua(){Vo(this),this.x=this.y=this.arc=this.site=this.cy=null}function sa(t){var e=t.P,n=t.N;if(e&&n){var r=e.site,i=t.site,o=n.site;if(r!==o){var a=i[0],u=i[1],s=r[0]-a,c=r[1]-u,l=o[0]-a,f=o[1]-u,h=2*(s*f-c*l);if(!(h>=-Ca)){var p=s*s+c*c,d=l*l+f*f,g=(f*p-c*d)/h,v=(s*d-l*p)/h,y=aa.pop()||new ua;y.arc=t,y.site=i,y.x=g+a,y.y=(y.cy=v+u)+Math.sqrt(g*g+v*v),t.circle=y;for(var m=null,_=wa._;_;)if(y.y<_.y||y.y===_.y&&y.x<=_.x){if(!_.L){m=_.P;break}_=_.L}else{if(!_.R){m=_;break}_=_.R}wa.insert(m,y),m||(oa=y)}}}}function ca(t){var e=t.circle;e&&(e.P||(oa=e.N),wa.remove(e),aa.push(e),Vo(e),t.circle=null)}var la=[];function fa(){Vo(this),this.edge=this.site=this.circle=null}function ha(t){var e=la.pop()||new fa;return e.site=t,e}function pa(t){ca(t),ma.remove(t),la.push(t),Vo(t)}function da(t){var e=t.circle,n=e.x,r=e.cy,i=[n,r],o=t.P,a=t.N,u=[t];pa(t);for(var s=o;s.circle&&Math.abs(n-s.circle.x)<xa&&Math.abs(r-s.circle.cy)<xa;)o=s.P,u.unshift(s),pa(s),s=o;u.unshift(s),ca(s);for(var c=a;c.circle&&Math.abs(n-c.circle.x)<xa&&Math.abs(r-c.circle.cy)<xa;)a=c.N,u.push(c),pa(c),c=a;u.push(c),ca(c);var l,f=u.length;for(l=1;l<f;++l)c=u[l],s=u[l-1],Ko(c.edge,s.site,c.site,i);s=u[0],(c=u[f-1]).edge=Wo(s.site,c.site,null,i),sa(s),sa(c)}function ga(t){for(var e,n,r,i,o=t[0],a=t[1],u=ma._;u;)if((r=va(u,a)-o)>xa)u=u.L;else{if(!((i=o-ya(u,a))>xa)){r>-xa?(e=u.P,n=u):i>-xa?(e=u,n=u.N):e=n=u;break}if(!u.R){e=u;break}u=u.R}!function(t){_a[t.index]={site:t,halfedges:[]}}(t);var s=ha(t);if(ma.insert(e,s),e||n){if(e===n)return ca(e),n=ha(e.site),ma.insert(s,n),s.edge=n.edge=Wo(e.site,s.site),sa(e),void sa(n);if(n){ca(e),ca(n);var c=e.site,l=c[0],f=c[1],h=t[0]-l,p=t[1]-f,d=n.site,g=d[0]-l,v=d[1]-f,y=2*(h*v-p*g),m=h*h+p*p,_=g*g+v*v,w=[(v*m-p*_)/y+l,(h*_-g*m)/y+f];Ko(n.edge,c,d,w),s.edge=Wo(c,t,null,w),n.edge=Wo(t,d,null,w),sa(e),sa(n)}else s.edge=Wo(e.site,s.site)}}function va(t,e){var n=t.site,r=n[0],i=n[1],o=i-e;if(!o)return r;var a=t.P;if(!a)return-1/0;var u=(n=a.site)[0],s=n[1],c=s-e;if(!c)return u;var l=u-r,f=1/o-1/c,h=l/c;return f?(-h+Math.sqrt(h*h-2*f*(l*l/(-2*c)-s+c/2+i-o/2)))/f+r:(r+u)/2}function ya(t,e){var n=t.N;if(n)return va(n,e);var r=t.site;return r[1]===e?r[0]:1/0}var ma,_a,wa,ba,xa=1e-6,Ca=1e-12;function Ma(t,e){return e[1]-t[1]||e[0]-t[0]}function Pa(t,e){var n,r,i,o=t.sort(Ma).pop();for(ba=[],_a=new Array(t.length),ma=new Zo,wa=new Zo;;)if(i=oa,o&&(!i||o[1]<i.y||o[1]===i.y&&o[0]<i.x))o[0]===n&&o[1]===r||(ga(o),n=o[0],r=o[1]),o=t.pop();else{if(!i)break;da(i.arc)}if(function(){for(var t,e,n,r,i=0,o=_a.length;i<o;++i)if((t=_a[i])&&(r=(e=t.halfedges).length)){var a=new Array(r),u=new Array(r);for(n=0;n<r;++n)a[n]=n,u[n]=na(t,ba[e[n]]);for(a.sort((function(t,e){return u[e]-u[t]})),n=0;n<r;++n)u[n]=e[a[n]];for(n=0;n<r;++n)e[n]=u[n]}}(),e){var a=+e[0][0],u=+e[0][1],s=+e[1][0],c=+e[1][1];!function(t,e,n,r){for(var i,o=ba.length;o--;)ea(i=ba[o],t,e,n,r)&&ta(i,t,e,n,r)&&(Math.abs(i[0][0]-i[1][0])>xa||Math.abs(i[0][1]-i[1][1])>xa)||delete ba[o]}(a,u,s,c),function(t,e,n,r){var i,o,a,u,s,c,l,f,h,p,d,g,v=_a.length,y=!0;for(i=0;i<v;++i)if(o=_a[i]){for(a=o.site,u=(s=o.halfedges).length;u--;)ba[s[u]]||s.splice(u,1);for(u=0,c=s.length;u<c;)d=(p=ia(o,ba[s[u]]))[0],g=p[1],f=(l=ra(o,ba[s[++u%c]]))[0],h=l[1],(Math.abs(d-f)>xa||Math.abs(g-h)>xa)&&(s.splice(u,0,ba.push(Qo(a,p,Math.abs(d-t)<xa&&r-g>xa?[t,Math.abs(f-t)<xa?h:r]:Math.abs(g-r)<xa&&n-d>xa?[Math.abs(h-r)<xa?f:n,r]:Math.abs(d-n)<xa&&g-e>xa?[n,Math.abs(f-n)<xa?h:e]:Math.abs(g-e)<xa&&d-t>xa?[Math.abs(h-e)<xa?f:t,e]:null))-1),++c);c&&(y=!1)}if(y){var m,_,w,b=1/0;for(i=0,y=null;i<v;++i)(o=_a[i])&&(w=(m=(a=o.site)[0]-t)*m+(_=a[1]-e)*_)<b&&(b=w,y=o);if(y){var x=[t,e],C=[t,r],M=[n,r],P=[n,e];y.halfedges.push(ba.push(Qo(a=y.site,x,C))-1,ba.push(Qo(a,C,M))-1,ba.push(Qo(a,M,P))-1,ba.push(Qo(a,P,x))-1)}}for(i=0;i<v;++i)(o=_a[i])&&(o.halfedges.length||delete _a[i])}(a,u,s,c)}this.edges=ba,this.cells=_a,ma=wa=ba=_a=null}Pa.prototype={constructor:Pa,polygons:function(){var t=this.edges;return this.cells.map((function(e){var n=e.halfedges.map((function(n){return ra(e,t[n])}));return n.data=e.site.data,n}))},triangles:function(){var t=[],e=this.edges;return this.cells.forEach((function(n,r){if(o=(i=n.halfedges).length)for(var i,o,a,u,s,c,l=n.site,f=-1,h=e[i[o-1]],p=h.left===l?h.right:h.left;++f<o;)a=p,p=(h=e[i[f]]).left===l?h.right:h.left,a&&p&&r<a.index&&r<p.index&&(s=a,c=p,((u=l)[0]-c[0])*(s[1]-u[1])-(u[0]-s[0])*(c[1]-u[1])<0)&&t.push([l.data,a.data,p.data])})),t},links:function(){return this.edges.filter((function(t){return t.right})).map((function(t){return{source:t.left.data,target:t.right.data}}))},find:function(t,e,n){for(var r,i,o=this,a=o._found||0,u=o.cells.length;!(i=o.cells[a]);)if(++a>=u)return null;var s=t-i.site[0],c=e-i.site[1],l=s*s+c*c;do{i=o.cells[r=a],a=null,i.halfedges.forEach((function(n){var r=o.edges[n],u=r.left;if(u!==i.site&&u||(u=r.right)){var s=t-u[0],c=e-u[1],f=s*s+c*c;f<l&&(l=f,a=u.index)}}))}while(null!==a);return o._found=r,null==n||l<=n*n?i.site:null}};Math.SQRT2;function ka(t,e,n){this.k=t,this.x=e,this.y=n}ka.prototype={constructor:ka,scale:function(t){return 1===t?this:new ka(this.k*t,this.x,this.y)},translate:function(t,e){return 0===t&0===e?this:new ka(this.k,this.x+this.k*t,this.y+this.k*e)},apply:function(t){return[t[0]*this.k+this.x,t[1]*this.k+this.y]},applyX:function(t){return t*this.k+this.x},applyY:function(t){return t*this.k+this.y},invert:function(t){return[(t[0]-this.x)/this.k,(t[1]-this.y)/this.k]},invertX:function(t){return(t-this.x)/this.k},invertY:function(t){return(t-this.y)/this.k},rescaleX:function(t){return t.copy().domain(t.range().map(this.invertX,this).map(t.invert,t))},rescaleY:function(t){return t.copy().domain(t.range().map(this.invertY,this).map(t.invert,t))},toString:function(){return"translate("+this.x+","+this.y+") scale("+this.k+")"}};new ka(1,0,0);ka.prototype;var Ea=n(7),Ta=function(){function t(e){var n=this,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};o(this,t),this.baseUrl=e,this.fetchParams=r,this.smiles_cache={},this.smiles_highlight_cache={},this.cache={},this.handleSmilesCache=function(t){var e=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return e?n.smiles_highlight_cache[t]:n.smiles_cache[t]},this.setSmilesCache=function(t){var e=arguments.length>1&&void 0!==arguments[1]&&arguments[1],r=arguments.length>2?arguments[2]:void 0;e?n.smiles_highlight_cache[t]=r:n.smiles_cache[t]=r},this.async_cache=function(){var t=i(c.a.mark((function t(e){return c.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",e);case 1:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),this.handleCache=function(t){return n.cache[t]?Object.assign(n.cache[t]):null},this.setCache=function(t,e){n.cache[t]=e},this.handleErrors=function(t){if(!t.ok)throw Error(t.statusText);return t},this.handleJSONErrors=function(t){return Object.keys(t).includes("error")&&alert(t.error),t},this.getUploadedFiles=i(c.a.mark((function t(){var e;return c.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e=n.baseUrl+"/get_uploaded_files_list",t.abrupt("return",fetch(e,h(h({},n.fetchParams),{},{method:"GET"})).then(n.handleErrors).then((function(t){return t.json()})).then(n.handleJSONErrors).catch((function(t){console.log(t)})));case 2:case"end":return t.stop()}}),t)}))),this.deleteFile=function(){var t=i(c.a.mark((function t(e){var r;return c.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return r=n.baseUrl+"/delete_file/"+e,t.abrupt("return",fetch(r,h(h({},n.fetchParams),{},{method:"GET"})).then(n.handleErrors).then((function(t){return t.json()})).then(n.handleJSONErrors).catch((function(t){alert("file could not be deleted. please, try again"),console.log(t)})));case 2:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),this.getStructureFromSmiles=function(t){var e=arguments.length>1&&void 0!==arguments[1]&&arguments[1],r=arguments.length>2?arguments[2]:void 0,i=n.handleSmilesCache(t,e);if(i)return n.async_cache(i);var o=new FormData;o.append("smiles",t);var a=n.baseUrl+"/get_mol_img";return e&&(a+="/highlight"),fetch(a,h(h({},n.fetchParams),{},{method:"POST",body:o,signal:null===r||void 0===r?void 0:r.signal})).then(n.handleErrors).then((function(t){return t.json()})).then(n.handleJSONErrors).then((function(r){return n.setSmilesCache(t,e,r.data),r.data})).catch((function(t){console.log(t)}))},this.getMCSFromSmilesList=function(){var t=i(c.a.mark((function t(e,r){var i;return c.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return i=r?fetch(n.baseUrl+"/get_common_mol_img",h(h({},n.fetchParams),{},{method:"POST",body:e,signal:null===r||void 0===r?void 0:r.signal})):fetch(n.baseUrl+"/get_common_mol_img",h(h({},n.fetchParams),{},{method:"POST",body:e})),t.abrupt("return",i.then(n.handleErrors).then((function(t){return t.json()})).then(n.handleJSONErrors).then((function(t){return t.data})).catch((function(t){console.log(t)})));case 2:case"end":return t.stop()}}),t)})));return function(e,n){return t.apply(this,arguments)}}(),this.getSubstructureCount=function(){var t=i(c.a.mark((function t(e,r){var i;return c.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return(i=new FormData).append("smiles_list",e),i.append("filter_smiles",r),t.abrupt("return",fetch(n.baseUrl+"/get_substructure_count",h(h({},n.fetchParams),{},{method:"POST",body:i})).then(n.handleErrors).then((function(t){return t.json()})).then(n.handleJSONErrors).then((function(t){if(Object.keys(t).includes("substructure_counts"))return t.substructure_counts;throw Error("Backend responded with error: "+t.error)})).catch((function(t){alert("could not find substructure match"),console.log(t)})));case 4:case"end":return t.stop()}}),t)})));return function(e,n){return t.apply(this,arguments)}}(),this.calculateHDBScanClusters=function(){var t=i(c.a.mark((function t(e,r,i,o){var a;return c.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return(a=new FormData).append("min_cluster_size",r),a.append("min_cluster_samples",i),a.append("allow_single_cluster",o),a.append("X",e),t.abrupt("return",fetch(n.baseUrl+"/segmentation",h(h({},n.fetchParams),{},{method:"POST",body:a})).then(n.handleErrors).then((function(t){return t.json()})).then(n.handleJSONErrors).catch((function(t){alert("error when calculating clusters"),console.log(t)})));case 6:case"end":return t.stop()}}),t)})));return function(e,n,r,i){return t.apply(this,arguments)}}(),this.terminate_projection=function(){var t=i(c.a.mark((function t(e){var r;return c.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return r=n.baseUrl+"/terminate_projection_thread/"+e,t.abrupt("return",fetch(r,h(h({},n.fetchParams),{},{method:"GET"})).then(n.handleErrors).then((function(t){return t.json()})).then(n.handleJSONErrors).catch((function(t){console.log(t)})));case 2:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),this.getkNearestData=function(){var t=i(c.a.mark((function t(e,r,i,o){var a;return c.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:a=n.baseUrl+"/get_k_nearest_from_csv/"+e+"/"+r+"/"+i+"/"+o,window.open(a);case 2:case"end":return t.stop()}}),t)})));return function(e,n,r,i){return t.apply(this,arguments)}}(),this.project_dataset=function(){var t=i(c.a.mark((function t(e,r,i,o){var a;return c.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return(a=new FormData).append("filename",e),a.append("params",JSON.stringify(r)),a.append("selected_feature_info",JSON.stringify(i)),t.abrupt("return",fetch(n.baseUrl+"/project_dataset_async",h(h({},n.fetchParams),{},{method:"POST",body:a,signal:null===o||void 0===o?void 0:o.signal})).then(n.handleErrors).then((function(t){return n.resetAggregationCache(),t})).catch((function(t){console.log(t)})));case 5:case"end":return t.stop()}}),t)})));return function(e,n,r,i){return t.apply(this,arguments)}}(),this.upload_csv_file=function(){var t=i(c.a.mark((function t(e,r){var i,o;return c.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return(i=new FormData).append("myFile",e),i.append("file_size",e.size),o=fetch(n.baseUrl+"/upload_csv",h(h({},n.fetchParams),{},{method:"POST",body:i,signal:null===r||void 0===r?void 0:r.signal})).then(n.handleErrors).then((function(t){return t.json()})).then(n.handleJSONErrors).catch((function(t){"AbortError"===t.name?console.log("Fetch aborted"):(alert("error when uploading file. it might be too big"),console.log(t))})),t.abrupt("return",o);case 5:case"end":return t.stop()}}),t)})));return function(e,n){return t.apply(this,arguments)}}(),this.loadNODatapoints=function(){var t=i(c.a.mark((function t(e){return c.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",fetch(n.baseUrl+"/get_no_datapoints/"+e,h(h({},n.fetchParams),{},{method:"GET"})).then(n.handleErrors).then((function(t){return t.json()})).then(n.handleJSONErrors).catch((function(t){console.log(t)})));case 1:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),this.loadValueRange=function(){var t=i(c.a.mark((function t(e,r){return c.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",fetch(n.baseUrl+"/get_value_range/"+e+"/"+r,h(h({},n.fetchParams),{},{method:"GET"})).then(n.handleErrors).then((function(t){return t.json()})).then(n.handleJSONErrors).catch((function(t){console.log(t)})));case 1:case"end":return t.stop()}}),t)})));return function(e,n){return t.apply(this,arguments)}}(),this.loadCategoryValues=function(){var t=i(c.a.mark((function t(e,r){return c.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",fetch(n.baseUrl+"/get_category_values/"+e+"/"+r,h(h({},n.fetchParams),{},{method:"GET"})).then(n.handleErrors).then((function(t){return t.json()})).then(n.handleJSONErrors).catch((function(t){console.log(t)})));case 1:case"end":return t.stop()}}),t)})));return function(e,n){return t.apply(this,arguments)}}(),this.updateBackendCache=function(){var t=i(c.a.mark((function t(e,r){var i,o,a;return c.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(i="",null!=r)for(o in r)a=r[o],i+="&cache_cols="+a;return t.abrupt("return",fetch(n.baseUrl+"/update_cache/"+e+"?dummy=1"+i,h(h({},n.fetchParams),{},{method:"GET"})).then(n.handleErrors).then((function(t){return t.json()})).then(n.handleJSONErrors).catch((function(t){console.log(t)})));case 3:case"end":return t.stop()}}),t)})));return function(e,n){return t.apply(this,arguments)}}(),this.loadCategoryCount=function(){var t=i(c.a.mark((function t(e,r){return c.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",fetch(n.baseUrl+"/get_category_count/"+e+"/"+r,h(h({},n.fetchParams),{},{method:"GET"})).then(n.handleErrors).then((function(t){return t.json()})).then(n.handleJSONErrors).catch((function(t){console.log(t)})));case 1:case"end":return t.stop()}}),t)})));return function(e,n){return t.apply(this,arguments)}}(),this.loadCategoryCountOfHex=function(){var t=i(c.a.mark((function t(e,r,i,o,a,u,s){return c.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return null==i&&(i="x"),null==o&&(o="y"),t.abrupt("return",fetch(n.baseUrl+"/get_category_count_of_hex/"+e+"/"+r+"/"+i+"/"+o+"?x="+a+"&y="+u+"&circ_radius="+s,h(h({},n.fetchParams),{},{method:"GET"})).then(n.handleErrors).then((function(t){return t.json()})).then(n.handleJSONErrors).catch((function(t){console.log(t)})));case 3:case"end":return t.stop()}}),t)})));return function(e,n,r,i,o,a,u){return t.apply(this,arguments)}}(),this.loadDensity=function(){var t=i(c.a.mark((function t(e,r){return c.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",fetch(n.baseUrl+"/get_density/"+e+"/"+r,h(h({},n.fetchParams),{},{method:"GET"})).then(n.handleErrors).then((function(t){return t.json()})).then(n.handleJSONErrors).catch((function(t){console.log(t)})));case 1:case"end":return t.stop()}}),t)})));return function(e,n){return t.apply(this,arguments)}}(),this.loadDensityOfHex=function(){var t=i(c.a.mark((function t(e,r,i,o,a,u,s){return c.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return null==i&&(i="x"),null==o&&(o="y"),t.abrupt("return",fetch(n.baseUrl+"/get_density_of_hex/"+e+"/"+r+"/"+i+"/"+o+"?x="+a+"&y="+u+"&circ_radius="+s,h(h({},n.fetchParams),{},{method:"GET"})).then(n.handleErrors).then((function(t){return t.json()})).then(n.handleJSONErrors).catch((function(t){console.log(t)})));case 3:case"end":return t.stop()}}),t)})));return function(e,n,r,i,o,a,u){return t.apply(this,arguments)}}(),this.agg_dataset_cache=null,this.cur_agg_path="",this.resetAggregationCache=function(){n.agg_dataset_cache=null},this.handleAggregationCache=function(t,e,r,i,o,a){if(null==n.agg_dataset_cache||n.agg_dataset_cache.length<=0)return null;if(o=null==o?"x":o,o=null==a?"y":a,n.cur_agg_path!==t||!(e in n.agg_dataset_cache[0].data)||!(r in n.agg_dataset_cache[0].data)||!(o in n.agg_dataset_cache[0].data)||!(a in n.agg_dataset_cache[0].data))return n.resetAggregationCache(),n.cur_agg_path=t,null;var u=n.agg_dataset_cache.filter((function(t){return!!(n.is_within_boundaries(i.x.min,t.x.min)&&n.is_within_boundaries(i.x.max,t.x.max)&&n.is_within_boundaries(i.y.min,t.y.min)&&n.is_within_boundaries(i.y.max,t.y.max))}));return 1===u.length||u.length>1?u[0]:null},this.loadPOIExceptions=function(){var t=i(c.a.mark((function t(e){return c.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",fetch(n.baseUrl+"/get_poi_exceptions/"+e,h(h({},n.fetchParams),{},{method:"GET"})).then(n.handleErrors).then((function(t){return t.json()})).then(n.handleJSONErrors).catch((function(t){console.log(t)})));case 1:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),this.loadPOIConstraints=function(){var t=i(c.a.mark((function t(e){return c.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",fetch(n.baseUrl+"/get_poi_constraints/"+e,h(h({},n.fetchParams),{},{method:"GET"})).then(n.handleErrors).then((function(t){return t.json()})).then(n.handleJSONErrors).catch((function(t){console.log(t)})));case 1:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),this.resetPOIConstraints=function(){var t=i(c.a.mark((function t(e){return c.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",fetch(n.baseUrl+"/reset_poi_constraints/"+e,h(h({},n.fetchParams),{},{method:"GET"})).then(n.handleErrors).then((function(t){return t.json()})).then(n.handleJSONErrors).catch((function(t){console.log(t)})));case 1:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),this.addPOIExceptions=function(){var t=i(c.a.mark((function t(e,r){var i;return c.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return(i=new FormData).append("exceptions",JSON.stringify(r)),i.append("filename",e),t.abrupt("return",fetch(n.baseUrl+"/add_poi_exceptions",h(h({},n.fetchParams),{},{method:"POST",body:i})).then(n.handleErrors).then((function(t){return t.json()})).then(n.handleJSONErrors).catch((function(t){console.log(t)})));case 4:case"end":return t.stop()}}),t)})));return function(e,n){return t.apply(this,arguments)}}(),this.updatePOIExceptions=function(){var t=i(c.a.mark((function t(e,r){var i;return c.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return(i=new FormData).append("exceptions",JSON.stringify(r)),i.append("filename",e),t.abrupt("return",fetch(n.baseUrl+"/update_poi_exceptions",h(h({},n.fetchParams),{},{method:"POST",body:i})).then(n.handleErrors).then((function(t){return t.json()})).then(n.handleJSONErrors).catch((function(t){console.log(t)})));case 4:case"end":return t.stop()}}),t)})));return function(e,n){return t.apply(this,arguments)}}(),this.updatePOIConstraints=function(){var t=i(c.a.mark((function t(e,r){var i;return c.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return(i=new FormData).append("constraints",JSON.stringify(r)),i.append("filename",e),t.abrupt("return",fetch(n.baseUrl+"/update_poi_constraints",h(h({},n.fetchParams),{},{method:"POST",body:i})).then(n.handleErrors).then((function(t){return t.json()})).then(n.handleJSONErrors).catch((function(t){console.log(t)})));case 4:case"end":return t.stop()}}),t)})));return function(e,n){return t.apply(this,arguments)}}(),this.downloadPOIConstraints=function(){var t=i(c.a.mark((function t(e){var r;return c.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:r=n.baseUrl+"/download_poi_constraints/"+e,window.open(r);case 2:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),this.uploadPOIConstraints=function(){var t=i(c.a.mark((function t(e,n){var r,i;return c.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,n.text();case 2:return r=t.sent,i=ar(r),t.abrupt("return",Oa.updatePOIConstraints(e,i));case 5:case"end":return t.stop()}}),t)})));return function(e,n){return t.apply(this,arguments)}}()}return u(t,[{key:"cache_agg_data",value:function(t,e){null==this.agg_dataset_cache?this.agg_dataset_cache=[h(h({},t),{},{data:e})]:this.agg_dataset_cache.push(h(h({},t),{},{data:e}))}},{key:"is_within_boundaries",value:function(t,e){var n=Math.abs(.5*e);return t<e+n&&t>e-n}},{key:"loadHexAgg",value:function(t,e,n,r,i,o,a,u,s,c,l,f,p){var d=this;null==n&&(n="x"),null==r&&(r="y");var g=this.handleAggregationCache(e,i,o,c,n,r),v=null;if(g)console.log("cached"),v=this.async_cache(g.data);else{var y="retrieve_cols="+i;y+="&aggregation_methods="+s.valueAggregationMethod,"None"!==o&&null!=o&&(y+="&retrieve_cols="+o,y+="&aggregation_methods="+s.uncertaintyAggregationMethod);var m="";if(null!=a)for(var _ in a){m+="&cache_cols="+a[_]}var w="";null!=u&&(w="&sample_size="+u),null==c&&(c={x:{min:-1e4,max:1e4},y:{min:-1e4,max:1e4}});var b="&x_min="+c.x.min+"&x_max="+c.x.max+"&y_min="+c.y.min+"&y_max="+c.y.max,x=Oa.baseUrl+"/get_hex_agg/"+e+"/"+n+"/"+r+"?"+y+m+w+b;v=l?l(hr(x,h(h({},Oa.fetchParams),{},{signal:null===f||void 0===f?void 0:f.signal})),f):hr(x,h(h({},Oa.fetchParams),{},{signal:null===f||void 0===f?void 0:f.signal}))}Object(Ea.trackPromise)(v.then((function(e){e.length<=0?(console.log("aggregation dataset is empty"),alert("aggregation dataset is empty")):(null==g&&d.cache_agg_data(c,e),t(e))})).catch((function(t){console.log(t)})),p)}},{key:"loadAggCSV",value:function(t,e,n,r,i,o,a,u,s,c){var l=this;null==a&&(a={x:{min:-1e4,max:1e4},y:{min:-1e4,max:1e4}});var f=this.handleAggregationCache(e,n,r,a),p=null;if(f)p=this.async_cache(f.data);else{var d="retrieve_cols="+n;"None"!==r&&null!=r&&(d+="&retrieve_cols="+r);var g="";if(null!=i)for(var v in i){g+="&cache_cols="+i[v]}var y="";null!=o&&(y="&sample_size="+o);var m="&x_min="+a.x.min+"&x_max="+a.x.max+"&y_min="+a.y.min+"&y_max="+a.y.max,_=Oa.baseUrl+"/get_agg_csv_cached/"+e+"?"+d+g+y+m;p=u?u(hr(_,h(h({},Oa.fetchParams),{},{signal:null===s||void 0===s?void 0:s.signal})),s):hr(_,h(h({},Oa.fetchParams),{},{signal:null===s||void 0===s?void 0:s.signal}))}Object(Ea.trackPromise)(p.then((function(e){e.length<=0?(console.log("aggregation dataset is empty"),alert("aggregation dataset is empty")):(null==f&&l.cache_agg_data(a,e),t(e))})).catch((function(t){console.log(t)})),c)}},{key:"loadPacoCSV",value:function(t,e,n,r,i,o){var a="?dummy=0";for(var u in n){a+="&cols="+n[u]}var s=Oa.baseUrl+"/get_csv_by_columns/"+e+a,c=r?r(hr(s,h(h({},Oa.fetchParams),{},{signal:null===i||void 0===i?void 0:i.signal})),i):hr(s,h(h({},Oa.fetchParams),{},{signal:null===i||void 0===i?void 0:i.signal}));Object(Ea.trackPromise)(c.then((function(e){e.length<=0?(console.log("dataset is empty"),alert("dataset is empty")):t(e)})).catch((function(t){console.log(t)})),o)}}]),t}();var Oa=new Ta("",{}),Sa=function(){function t(e,n,r,i){o(this,t),this.dataset=null,this.params=null,this.selected_feature_info=null,this.embedding=null,this.current_steps=0,this.abort_controller=null,this.msg="",this.dataset=e,this.params=n,this.embedding=r,this.selected_feature_info=i,this.abort_controller=new AbortController}return u(t,[{key:"initializeFit",value:function(t){var e=this,n=function(){var n=i(c.a.mark((function n(r){var i,o,a,u;return c.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(i){n.next=9;break}return n.next=3,r.read();case 3:if(a=n.sent,o=a.value,i=a.done)console.log("The stream is closed!");else try{u=JSON.parse((new TextDecoder).decode(o)),parseInt(u.step)&&(e.current_steps=parseInt(u.step)),u.emb&&u.emb.length>0&&(e.embedding=u.emb),u.msg&&(e.msg=u.msg),t(e.embedding,e.current_steps,e.msg)}catch(s){console.log(s),t(e.embedding,e.current_steps,e.msg)}n.next=0;break;case 9:case"end":return n.stop()}}),n)})));return function(t){return n.apply(this,arguments)}}();Oa.project_dataset(this.dataset,this.params,this.selected_feature_info,this.abort_controller).then((function(t){var e=t.body.getReader();n(e)}))}},{key:"abort",value:function(t){var e=this;Oa.terminate_projection(this.dataset).then((function(n){e.abort_controller.abort(),t()})).catch((function(){e.abort_controller.abort(),t()}))}}]),t}();const Na=self,ja=(t,e,n)=>{Na.postMessage({messageType:"step",embedding:t,step:e,msg:n})},Ua=()=>{Na.postMessage({messageType:"terminated"})};Na.addEventListener("message",(function(t){if("init"===t.data.messageType){const e=new Sa(t.data.path,t.data.params,t.data.init_coordinates,t.data.selected_feature_info);e.initializeFit(ja),Na.embedding=e}else if("abort"===t.data.messageType){Na.embedding.abort(Ua)}}),!1);e.default=null}]);\n',"Worker",void 0,void 0)}var mn=function(t){Object(f.a)(n,t);var e=Object(h.a)(n);function n(t,r){var a;return Object(c.a)(this,n),(a=e.call(this)).targetBounds=void 0,a.embedding_method=void 0,a.callback_fn=void 0,a.embedding_method=t,a.callback_fn=r,a}return Object(l.a)(n,[{key:"init",value:function(t,e,n,r){var a=this;this.callback_fn&&this.callback_fn("init");var i={};e.forEach((function(e){if(e.checked){var n={};n.normalize=e.normalized,n.featureType=t.columns[e.name].featureType.toString(),n.range=t.columns[e.name].range,n.distinct=t.columns[e.name].distinct,i[e.name]=n}})),n.embedding_method=this.embedding_method,this.worker=new pn,this.worker.postMessage({messageType:"init",init_coordinates:r.positions.map((function(t,e){return{x:t.x,y:t.y}})),path:t.info.path,params:n,selected_feature_info:i}),this.worker.addEventListener("message",(function(t){"step"===t.data.messageType?(a.stepper(t.data.embedding),a.notifier(t.data.step,t.data.msg)):"terminated"===t.data.messageType&&a.worker.terminate()}),!1)}},{key:"terminate",value:function(){this.worker.postMessage({messageType:"abort"})}},{key:"step",value:function(){}}]),n}(s.EmbeddingController),vn=n.p+"static/media/pse-icon-aggregate.9f576a54.svg",yn=n.p+"static/media/pse-icon-filter.a1e7c217.svg",bn=n(460),_n={Aggregate:function(){return Object(ut.jsx)(bn.a,{src:vn})},Filter:function(){return Object(ut.jsx)(bn.a,{src:yn})}},xn=n(74),jn=function(){function t(e,n,r){Object(c.a)(this,t),this.vectors=void 0,this.bounds=void 0,this.columns=void 0,this.xChannel=void 0,this.yChannel=void 0,this.vectors=e,this.columns={},this.xChannel=null==n?"x":n,this.yChannel=null==r?"y":r,this.bounds={x:this.calculateRange(n),y:this.calculateRange(r)},this.inferColumns()}return Object(l.a)(t,[{key:"getFeatureType",value:function(t){return"number"!==typeof t&&isNaN(Number(t))?""+new Date(t)!=="Invalid Date"?"date":"arbitrary":"number"}},{key:"inferColumns",value:function(){var t=this,e=Object.keys(this.vectors[0]),n=e.reduce((function(e,n){var r=n.match(/[{].*[}]/);if(null!=r){var a=n.substring(0,n.length-r[0].length);t.vectors.forEach((function(t){t[a]=t[n],delete t[n]})),e[a]=JSON.parse(r[0])}else e[n]={featureLabel:"Default"};return e}),{});e.includes(this.xChannel)&&e.includes(this.yChannel)?this.vectors.forEach((function(e){e[t.xChannel]=+e[t.xChannel],e[t.yChannel]=+e[t.yChannel]})):console.log("You have to specify x and y columns in your dataset"),Object.keys(n).forEach((function(e){switch(t.columns[e]={},t.retrieveFeatureTypes(n,e),t.columns[e].featureType){case s.FeatureType.Binary:break;case s.FeatureType.Categorical:t.columns[e].distinct=Array.from(new Set(Object(d.a)(t.vectors.map((function(t){return t[e]})))));break;case s.FeatureType.Date:case s.FeatureType.Ordinal:break;case s.FeatureType.Quantitative:t.columns[e].range=t.calculateRange(e);case s.FeatureType.String:}}))}},{key:"retrieveFeatureTypes",value:function(t,e){var n=this,r=t[e];if(null!==r&&void 0!==r&&r.dtype)switch(r.dtype){case"numerical":this.columns[e].featureType=s.FeatureType.Quantitative;break;case"date":this.columns[e].featureType=s.FeatureType.Date;break;case"categorical":this.columns[e].featureType=s.FeatureType.Categorical;break;default:this.columns[e].featureType=s.FeatureType.String}else if(t[e].range)this.columns[e].range=t[e].range,this.columns[e].featureType=s.FeatureType.Quantitative;else{var a={},i={},o={};this.vectors.forEach((function(t){var r=n.getFeatureType(t[e]);"number"===r?a[e]=!0:"date"===r?i[e]=!0:o[e]=!0})),!a[e]||i[e]||o[e]?a[e]||!i[e]||o[e]?this.columns[e].featureType=s.FeatureType.Categorical:this.columns[e].featureType=s.FeatureType.Date:this.columns[e].featureType=s.FeatureType.Quantitative}}},{key:"calculateRange",value:function(t){var e=this.vectors.map((function(e){return parseFloat(e[t])})).filter((function(t){return!isNaN(t)}));return{min:Math.min.apply(Math,Object(d.a)(e)),max:Math.max.apply(Math,Object(d.a)(e))}}},{key:"map01",value:function(t,e){var n=this.columns[t].range.max-this.columns[t].range.min;return n=n>0?n:1,(+e[t]-this.columns[t].range.min)/n}},{key:"normalize",value:function(t,e,n){var r,a;return t in n?(r=n[t].mean,a=n[t].std):(r=function(t){var e=t.length;return t.reduce((function(t,e){return t+e}))/e}(this.vectors.map((function(e){return+e[t]}))),a=function(t){var e=t.length,n=t.reduce((function(t,e){return t+e}))/e;return Math.sqrt(t.map((function(t){return Math.pow(t-n,2)})).reduce((function(t,e){return t+e}))/e)}(this.vectors.map((function(e){return+e[t]}))),n[t]={mean:r,std:a}),a<=0&&(a=1),{result:(+e[t]-r)/a,lookup:n}}}]),t}();var On=Object(g.connect)((function(t){return{smallMultiples:t.multiples.multiples.entities}}),(function(t){return{}}))((function(t){var e=t.smallMultiples,n=t.hexagons,i=t.hoverElement,o=t.selectElement,s=e[t.multipleId].attributes.viewTransform,c=a.a.useRef(),l=Object(r.useState)((function(){return new xn.h({antialias:!0,alpha:!0})})),f=Object(u.a)(l,1)[0],h=Object(r.useState)((function(){return new xn.f})),d=Object(u.a)(h,1)[0],g=Object(r.useState)(0),p=Object(u.a)(g,2),m=p[0],v=p[1];return Object(r.useEffect)((function(){c.current.appendChild(f.domElement)}),[]),Object(r.useEffect)((function(){for(var t in d.clear(),n){var e=n[t];null!=n&&d.add(e)}v(m+1)}),[n]),Object(r.useEffect)((function(){var t=d.getObjectByName("hoverElement");d.remove(t),null!=i&&(i.name="hoverElement",d.add(i)),v(m+1)}),[i]),Object(r.useEffect)((function(){var t=d.getObjectByName("selectElement");d.remove(t),null!=o&&(o.name="selectElement",d.add(o)),v(m+1)}),[o]),Object(r.useEffect)((function(){if(s){var t=s.width,e=s.height;f.setPixelRatio(window.devicePixelRatio),f.setSize(t,e),f.setClearColor(0,0);var n=new xn.e(t/-2,t/2,e/2,e/-2,1,1e3);n.position.z=1,n.lookAt(new xn.g(0,0,0)),n.position.x=s.centerX,n.position.y=s.centerY,n.zoom=s.zoom,n.updateProjectionMatrix();try{f.render(d,n)}catch(r){console.log(r)}}}),[s,d,d.children,m]),Object(ut.jsx)("div",{style:{},ref:c})}));function wn(t,e,n,r,a,i){var o=Math.abs(t-n),u=Math.abs(e-r);return!(o>i||u>a)&&a*i-a*o-i/2*u>=0}function Cn(t,e,n,r,a){return r in e.columns&&a in e.columns&&(t.x<e.columns[r].range.min-n||t.x>e.columns[r].range.max+n||t.y<e.columns[a].range.min-n||t.y>e.columns[a].range.max+n)}var Sn=Object(g.connect)((function(t){var e,n;return{poiDataset:t.dataset,smallMultiples:t.multiples.multiples.entities,mouseMove:null===(e=t.mouseInteractionHooks)||void 0===e?void 0:e.mousemove,mouseClick:null===(n=t.mouseInteractionHooks)||void 0===n?void 0:n.mouseclick}}),(function(t){return{setValueRange:function(e){return t(Xt(e))},setUncertaintyRange:function(e){return t($t(e))},setCurrentAggregateSelectionFn:function(e){return t(je(e))}}})),kn="global_loading_indicator_aggregation_ds",En=Sn((function(t){var e,n=t.setCurrentAggregateSelectionFn,a=t.poiDataset,i=t.smallMultiples,o=t.setValueRange,c=t.setUncertaintyRange,l=t.mouseMove,f=t.mouseClick,h=t.multipleId,d=i[h].attributes.aggregateSettings,g=null===d||void 0===d?void 0:d.colormapSettings.aggregateColor,p=i[h].attributes.viewTransform,m=i[h].attributes.workspace,v=null==m.xChannel?"x":m.xChannel,y=null==m.yChannel?"y":m.yChannel;if(null==a||null==a.info||null==g||null==g.value_col||"None"===g.value_col)return null;var b=r.useState(null),_=Object(u.a)(b,2),x=_[0],j=_[1],O=r.useState(null),w=Object(u.a)(O,2),C=w[0],E=w[1],M=r.useState(null),T=Object(u.a)(M,2),P=T[0],A=T[1],N=r.useState(null),I=Object(u.a)(N,2),U=I[0],R=I[1],F=r.useState(null),D=Object(u.a)(F,2),L=D[0],V=D[1],H=r.useState(null),z=Object(u.a)(H,2),J=z[0],Y=z[1],B=Object(s.useCancellablePromise)(),q=B.cancellablePromise,W=B.cancelPromises;r.useEffect((function(){null!=(null===g||void 0===g?void 0:g.value_col)&&(S.loadValueRange(a.info.path,g.value_col).then((function(t){V(t)})),null!=(null===g||void 0===g?void 0:g.uncertainty_col)?S.loadValueRange(a.info.path,g.uncertainty_col).then((function(t){Y(t)})):Y(null))}),[g,a.info.path]),r.useEffect((function(){null!==d&&void 0!==d&&d.advancedSettings.deriveRange&&null!=L&&(o(L),c(J))}),[L,J,null===d||void 0===d?void 0:d.advancedSettings.deriveRange]);var X=r.useCallback(G.debounce((function(t){W();var e=new AbortController,n={x:{min:Math.round(-t.width/t.zoom/2+t.centerX),max:Math.round(t.width/t.zoom/2+t.centerX)},y:{min:Math.round(-t.height/t.zoom/2+t.centerY),max:Math.round(t.height/t.zoom/2+t.centerY)}};n.x.min=n.x.min-Math.abs(n.x.min/2),n.x.max=n.x.max+Math.abs(n.x.max/2),n.y.min=n.y.min-Math.abs(n.y.min/2),n.y.max=n.y.max+Math.abs(n.y.max/2),S.loadHexAgg((function(t){R(new jn(t,v,y))}),a.info.path,v,y,g.value_col,g.uncertainty_col,g.cache_cols,0,null===d||void 0===d?void 0:d.advancedSettings.aggregationMethod,n,q,e,kn)}),500,{leading:!1,trailing:!0}),[null===a||void 0===a||null===(e=a.info)||void 0===e?void 0:e.path,g,d,v,y]);return r.useEffect((function(){X(p)}),[g,a.info.path,null===d||void 0===d?void 0:d.advancedSettings.aggregationMethod,p,v,y]),r.useEffect((function(){if(null!=(null===d||void 0===d?void 0:d.colormapSettings.scale_obj))if(U&&U.vectors){if(Object.keys(U.columns).includes(g.value_col)){var t=function(t,e,n,r,a,i,o){var u=[];return t.vectors.forEach((function(s){if("False"===s.hex){console.log("wrong point");var c=new xn.d({color:0,side:xn.b}),l=new xn.a(1,100),f=new xn.c(l,c);f.position.x=s[e],f.position.y=s[n],u.push(f)}else{var h;if(void 0===s[r]||isNaN(s[r])||""===s[r]);else if(h=null!=t.columns[a]?i(s[r],s[a]):i(s[r],0),null==o||o.length<=0||o.includes(h)){var d=new xn.d({color:h,side:xn.b}),g=new xn.a(s.circ_radius-.04*s.circ_radius,6),p=new xn.c(g,d);p.position.x=s[e],p.position.y=s[n],u.push(p)}}})),u}(U,v,y,g.value_col,g.uncertainty_col,null===d||void 0===d?void 0:d.colormapSettings.scale_obj,null===d||void 0===d?void 0:d.colormapSettings.valueFilter);j(t)}}else j(null)}),[null===d||void 0===d?void 0:d.colormapSettings.scale_obj,U,null===d||void 0===d?void 0:d.colormapSettings.valueFilter]),r.useEffect((function(){if(null==l||l.event_used||null==U)E(null);else{var t=U.columns.circ_radius.range.max;if(Cn(l,U,t,v,y))E(null);else{var e=Math.sqrt(3)/2*t,n=!1;U.vectors.forEach((function(r){if(wn(l.x,l.y,r[v],r[y],e,t)){if(n=!0,null==C||C.position.x!==r[v]||C.position.y!==r[y]){var a=new xn.d({color:k,side:xn.b,transparent:!0,opacity:1}),i=new xn.a(r.circ_radius-.04*r.circ_radius,6),o=new xn.c(i,a);o.position.x=r[v],o.position.y=r[y],E(o)}}else;})),n||E(null)}}}),[U,l]),r.useEffect((function(){if(null==f||f.event_used||null==U)A(null),n(null);else{var t=U.columns.circ_radius.range.max;if(Cn(f,U,t,v,y))A(null),n(null);else{var e=Math.sqrt(3)/2*t,r=!1;U.vectors.forEach((function(a){if(wn(f.x,f.y,a[v],a[y],e,t)){if(r=!0,null==P||P.position.x!==a.x||P.position.y!==a.y){var i=new xn.d({color:k,side:xn.b,transparent:!0,opacity:1}),o=Number(a.circ_radius)+.04*Number(a.circ_radius),u=new xn.a(o,6),s=new xn.c(u,i);s.position.x=a[v],s.position.y=a[y],s.position.z=-1,A(s),n(a)}}else;})),r||(A(null),n(null))}}}),[U,f,n]),Object(ut.jsxs)("div",{children:[Object(ut.jsx)(fn,{handleClose:function(){W()},area:kn}),x&&x.length>0&&Object(ut.jsx)(On,{hexagons:x,hoverElement:C,selectElement:P,multipleId:h})]})})),Mn=n(510),Tn=n(513),Pn=n(511),An=n(514),Nn=n(512),In=n(725),Un=n(93),Rn=n(724),Fn={width:50,height:50,transform:[{filter:"datum.id < 10"}],layer:[{transform:[{filter:"datum.selection == 'selection'"}],mark:{type:"bar",tooltip:!0},encoding:{x:{field:"category",type:"ordinal",axis:null,sort:{field:"id",order:"ascending"}},y:{field:"count",type:"quantitative",axis:null,stack:null},color:{condition:{test:"indexof(['null', 'undefined', 'unknown', 'none', 'Null', 'Undefined', 'Unknown', 'None', 'NULL', 'UNDEFINED', 'UNKNOWN', 'NONE'], datum.category) >= 0 || datum.category === null",value:"#aaaaaa"},value:"#007dad"},tooltip:[{field:"selection",type:"nominal",title:"subset"},{field:"category",type:"nominal"},{field:"count",type:"quantitative",title:"feature"}]}},{transform:[{filter:"datum.selection == 'all'"}],mark:{type:"bar",tooltip:!0,stroke:"black",fillOpacity:0},encoding:{x:{field:"category",type:"ordinal",axis:null,sort:{field:"id",order:"ascending"}},y:{field:"count",type:"quantitative",axis:null,stack:null},color:{condition:{test:"indexof(['null', 'undefined', 'unknown', 'none', 'Null', 'Undefined', 'Unknown', 'None', 'NULL', 'UNDEFINED', 'UNKNOWN', 'NONE'], datum.category) >= 0 || datum.category === null",value:"#aaaaaa"}},tooltip:[{field:"selection",type:"nominal",title:"subset"},{field:"category",type:"nominal"},{field:"count",type:"quantitative",title:"feature"}]}}],data:{name:"values"}};function Dn(t){return Object(ut.jsx)(Rn.a,Object(b.a)(Object(b.a)({},t),{},{spec:Fn}))}var Ln={width:50,height:50,layer:[{transform:[{filter:"datum.selection == 'selection'"}],mark:{type:"area",tooltip:!0,interpolate:"linear"},encoding:{x:{field:"feature",title:"feature",type:"quantitative",axis:null},y:{field:"density",title:"density",type:"quantitative",axis:null},color:{field:"selection",type:"nominal",legend:null,scale:{range:["(170,170,170,0)","#007dad"]}}}},{transform:[{filter:"datum.selection == 'all'"}],mark:{type:"area",tooltip:!0,interpolate:"linear"},encoding:{x:{field:"feature",title:"feature",type:"quantitative",axis:null},y:{field:"density",title:"density",type:"quantitative",axis:null},stroke:{field:"selection",type:"nominal",legend:null,scale:{range:["#000000","#007dad"]}},color:{field:"selection",type:"nominal",legend:null}}}],data:{name:"values"}};function Vn(t){return Object(ut.jsx)(Rn.a,Object(b.a)(Object(b.a)({},t),{},{spec:Ln}))}var Hn=n(199),zn=(n(648),{width:50,height:50,transform:[{density:"feature",groupby:["selection"]}],mark:{type:"area",tooltip:!0},encoding:{x:{field:"value",title:"feature",type:"quantitative",axis:null},y:{field:"density",type:"quantitative",axis:null},color:{field:"selection",type:"nominal",legend:null,scale:{range:["(170,170,170,0)","#007dad"]}},stroke:{field:"selection",type:"nominal",legend:null,scale:{range:["#000000","#007dad"]}},tooltip:[{field:"selection",type:"nominal",title:"subset"},{field:"density",type:"quantitative"},{field:"value",type:"quantitative",title:"feature"}]},data:{name:"values"}});function Gn(t){return Object(ut.jsx)(Rn.a,Object(b.a)(Object(b.a)({},t),{},{spec:zn}))}var Jn={width:50,height:50,mark:{type:"bar",tooltip:!0},transform:[{filter:"datum.feature != null"}],encoding:{x:{field:"feature",type:"temporal",bin:{maxbins:10},axis:null},y:{aggregate:"count",axis:null},color:{value:"#007dad"}},data:{name:"values"}};function Yn(t){return Object(ut.jsx)(Rn.a,Object(b.a)(Object(b.a)({},t),{},{spec:Jn}))}function Bn(t,e,n){var r="";r+="<table>",r+='<tr><td class="key">ratio:</td><td class="value">'.concat(e(t.feature),"</td></tr>"),r+='<tr><td class="key">short name:</td><td class="value">'.concat(e(P(t.category)),"</td></tr>"),r+='<tr><td class="key">smiles:</td><td class="value">'.concat(e(t.category),"</td></tr>"),r+='<tr><td class="key">subset:</td><td class="value">'.concat(e(t.subset),"</td></tr>"),r+="</table>",r+='<div id="smiles_'.concat(t.category,'" style="width:100%; height:100px; background-size: contain; background-position: center; background-repeat: no-repeat;"></div>');var a=t.category;return S.getStructureFromSmiles(a,!1,null).then((function(e){var n=document.getElementById("smiles_".concat(t.category));null!=n&&(e&&e.length>100?n.style.backgroundImage="url('data:image/jpg;base64,".concat(e,"')"):n.innerHTML=e,n.title=a)})),r}function qn(t,e){return{values:t.map((function(t){return{feature:+t[e]}}))}}function Wn(t,e,n){var r=t.map((function(t,e){return{feature:+t[n],selection:"all"}})),a=e.map((function(t,e){return{feature:+t[n],selection:"selection"}}));return{values:[].concat(Object(d.a)(a),Object(d.a)(r))}}function Xn(t,e,n){for(var r={},a=0;a<e.length;a++)e[a][n]in r?r[e[a][n]]+=1:r[e[a][n]]=1;for(var i={},o=0;o<t.length;o++)t[o][n]in i?i[t[o][n]]+=1:i[t[o][n]]=1;var u=[];for(var s in r){var c=r[s]/e.length;c=isFinite(c)?c:0,u.push({selection:"selection",category:s,count:c})}u.sort((function(t,e){return e.count-t.count}));var l={};u.forEach((function(t,e){l[t.category]=e,t.id=e}));var f=u.length,h=[];for(var d in i){var g=i[d]/t.length;g=isFinite(g)?g:0;var p=l[d];null==p&&(p=f,l[d]=p,f++),h.push({selection:"all",category:d,count:g,id:p})}return{values:[].concat(h,u)}}function $n(t){var e=Number.NEGATIVE_INFINITY;t=t.values;for(var n=0;n<t.length;n++)t[n].count>e&&(e=t[n].count);return e}function Qn(t,e){return t.score===e.score?0:t.score<e.score?1:-1}function Zn(t,e,n){return e===n?0:(t.forEach((function(t,r,a){a[r]=(+t-+e)/(+n-+e)})),function(t){var e=t.reduce((function(t,e){return t+e}))/t.length;e=isFinite(e)?e:0;var n=t.map((function(t){return(t-e)*(t-e)}));return n=n.reduce((function(t,e){return t+e})),n/=t.length,n=isFinite(n)?n:1,Math.sqrt(n)}(t))}function Kn(t,e,n,r){var a=Object(In.a)({table:{maxWidth:288},tableRow:{height:"66px"}})(),i=function(t,e,n,r){if(void 0===r)return[];var a=[],i=function(t){for(var e={},n=0;n<t.length;++n)for(var r in t[n])r in e?e[r].push(t[n][r]):e[r]=[t[n][r]];return e}(t),o=function(t){if(null===t)return[];for(var e=[],n=0;n<=t.length;n++)void 0!==t[n]&&t[n].show&&e.push(t[n].feature);return e}(n);for(var u in i){var c,l,f;if(o.indexOf(u)>-1)if((null===(c=r.columns[u])||void 0===c?void 0:c.featureType)===s.FeatureType.Quantitative){var h=Wn(r.vectors,t,u);a.push([u,"",1-Zn(i[u],r.columns[u].range.min,r.columns[u].range.max),Object(ut.jsx)(Gn,{logLevel:Un.Error,data:h,actions:!1,tooltip:(new Hn.a).call})])}else if((null===(l=r.columns[u])||void 0===l?void 0:l.featureType)===s.FeatureType.Categorical){var d,g=Xn(r.vectors,t,u);if(1!==Object.keys(g.values).length){var p,m={};null!==(p=r.columns[u])&&void 0!==p&&p.metaInformation.imgSmiles&&(m={formatTooltip:Bn}),d=Object(ut.jsx)(Dn,{logLevel:Un.Error,data:g,actions:!1,tooltip:new Hn.a(m).call})}else d=null;a.push([u,g.values[0].category,$n(g),d])}else if((null===(f=r.columns[u])||void 0===f?void 0:f.featureType)===s.FeatureType.Date){var v=qn(t,u);a.push([u,"",1-Zn(i[u],r.columns[u].range.min,r.columns[u].range.max),Object(ut.jsx)(Yn,{data:v,actions:!1,tooltip:(new Hn.a).call})])}}for(var y,b,_,x,j=[],O=0;O<a.length;O++)j.push((y=a[O][0],b=a[O][1],_=a[O][2],x=a[O][3],{feature:y,category:b,score:_,char:x}));return j.sort(Qn),j}(t,0,n,r);return Object(ut.jsx)("div",{style:{width:"100%",maxHeight:"100%",overflowY:"scroll"},children:Object(ut.jsx)("div",{style:{width:"100%"},children:Object(ut.jsxs)(Mn.a,{className:a.table,"aria-label":"simple table",size:"small",children:[Object(ut.jsx)(Tn.a,{}),Object(ut.jsx)(Pn.a,{children:i.map((function(t){return Object(ut.jsxs)(An.a,{className:a.tableRow,children:[Object(ut.jsx)(Nn.a,{component:"th",scope:"row",children:Object(ut.jsxs)("div",{style:{maxWidth:200},children:[t.feature,Object(ut.jsx)("br",{}),Object(ut.jsx)("b",{children:P(t.category)})]})}),Object(ut.jsx)(Nn.a,{children:t.char})]},t.feature)}))})]})})})}var tr=Object(g.connect)((function(t){return{legendAttributes:t.genericFingerprintAttributes,dataset:t.dataset}}),(function(t){return{}}))((function(t){var e=t.selection,n=(t.aggregate,t.legendAttributes),r=t.dataset;return e.length<=0?Object(ut.jsx)(s.DefaultLegend,{}):Kn(e,0,n,r)}));function er(){return(er=Object(_.a)(j.a.mark((function t(e,n,r,a,i,o){var u,c,l,f,h,d,g,p,m,v,y,b,_;return j.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:u=r.filter((function(t){return t.show})),c=[],t.t0=j.a.keys(u);case 3:if((t.t1=t.t0()).done){t.next=20;break}if(l=t.t1.value,h=u[l].feature,(null===(f=a.columns[h])||void 0===f?void 0:f.featureType)!==s.FeatureType.Quantitative){t.next=10;break}return t.delegateYield(j.a.mark((function t(){var n,r,o,u,s;return j.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,S.loadDensity(a.info.path,h);case 2:return n=t.sent,r=n.x_vals.map((function(t,e){return{feature:t,density:n.y_vals[e],selection:"all"}})),t.next=6,S.loadDensityOfHex(a.info.path,h,i.xChannel,i.yChannel,e.x,e.y,e.circ_radius);case 6:o=t.sent,u=o.x_vals.map((function(t,e){return{feature:t,density:o.y_vals[e],selection:"selection"}})),s=r.concat(u),d=Object.keys(s).length>1?Object(ut.jsx)(Vn,{logLevel:Un.Error,data:{values:s},actions:!1}):null,c.push({feature:h,category:"",char:d,score:1-o.norm_sd});case 11:case"end":return t.stop()}}),t)}))(),"t2",8);case 8:t.next=18;break;case 10:return t.next=12,ir(a,h,i,e);case 12:g=t.sent,p=g.bar_data,m=g.cat_list,v=g.score,Object.keys(p).length>1?(_={},null!==(b=a.columns[h])&&void 0!==b&&b.metaInformation.imgSmiles&&(_={formatTooltip:Bn}),y=Object(ut.jsx)(Dn,{logLevel:Un.Error,data:{values:p},actions:!1,tooltip:new Hn.a(_).call})):y=null,c.push({feature:h,category:m[0],char:y,score:v});case 18:t.next=3;break;case 20:c.sort((function(t,e){return e.score-t.score})),o(c);case 22:case"end":return t.stop()}}),t)})))).apply(this,arguments)}var nr=Object(g.connect)((function(t){return{legendAttributes:t.genericFingerprintAttributes,dataset:t.dataset,workspace:t.multiples.multiples.entities[t.multiples.active].attributes.workspace}}),(function(t){return{}})),rr=Object(In.a)({table:{maxWidth:288},tableRow:{height:"66px"}}),ar=nr((function(t){var e=t.aggregate,n=t.aggregateSelection,r=t.legendAttributes,i=t.dataset,o=t.workspace,s=rr(),c=a.a.useState([]),l=Object(u.a)(c,2),f=l[0],h=l[1];return a.a.useEffect((function(){!function(t,e,n,r,a,i){er.apply(this,arguments)}(n,e,r,i,o,h)}),[n]),Object(ut.jsx)("div",{style:{width:"100%",maxHeight:"100%",overflowY:"scroll"},children:Object(ut.jsx)("div",{style:{width:"100%"},children:Object(ut.jsxs)(Mn.a,{className:s.table,"aria-label":"simple table",size:"small",children:[Object(ut.jsx)(Tn.a,{}),Object(ut.jsx)(Pn.a,{children:f.map((function(t){return Object(ut.jsxs)(An.a,{className:s.tableRow,children:[Object(ut.jsx)(Nn.a,{component:"th",scope:"row",children:Object(ut.jsxs)("div",{style:{maxWidth:200},children:[t.feature,Object(ut.jsx)("br",{}),Object(ut.jsx)("b",{children:P(t.category)})]})}),Object(ut.jsx)(Nn.a,{children:t.char})]},t.feature)}))})]})})})}));function ir(t,e,n,r){return or.apply(this,arguments)}function or(){return(or=Object(_.a)(j.a.mark((function t(e,n,r,a){var i,o,u,s,c,l,f,h,d,g,p;return j.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,S.loadCategoryCount(e.info.path,n);case 2:return i=t.sent,o=i.reduce((function(t,e){return t+e.count}),0),u=i.map((function(t){return{selection:"all",category:t[n],count:t.count/o}})),t.next=7,S.loadCategoryCountOfHex(e.info.path,n,r.xChannel,r.yChannel,a.x,a.y,a.circ_radius);case 7:for(g in s=t.sent,c=s.reduce((function(t,e){return t+e.count}),0),l=s.map((function(t){return{selection:"selection",category:t[n],count:t.count/c}})),(f=u.map((function(t){return t.category}))).sort((function(t,e){var n=l.find((function(e){return e.category===t})),r=l.find((function(t){return t.category===e}));if(n&&r)return r.count-n.count;if(n)return-1;if(r)return 1;var a=u.find((function(e){return e.category===t}));return u.find((function(t){return t.category===e})).count-a.count})),h=[],d=function(t){var e=f[t],n=u.find((function(t){return t.category===e}));null!=n&&h.push(Object(b.a)(Object(b.a)({},n),{},{id:t}));var r=l.find((function(t){return t.category===e}));null!=r&&h.push(Object(b.a)(Object(b.a)({},r),{},{id:t}))},f)d(g);return p=l.find((function(t){return t.category===f[0]})).count,t.abrupt("return",{bar_data:h,cat_list:f,score:p});case 17:case"end":return t.stop()}}),t)})))).apply(this,arguments)}var ur=Object(g.connect)((function(t){var e;return{aggregateSelection:null===(e=t.selection)||void 0===e?void 0:e.currentAggregateSelection}}),(function(t){return{}}))((function(t){var e=t.aggregate,n=t.selection,r=t.aggregateSelection;return n.length>0?Object(ut.jsx)(tr,{selection:n,aggregate:e}):null!=r?Object(ut.jsx)(ar,{aggregate:e,aggregateSelection:r}):Object(ut.jsx)(s.DefaultLegend,{})})),sr=function(t){Object(f.a)(n,t);var e=Object(h.a)(n);function n(){var t;Object(c.a)(this,n);for(var r=arguments.length,a=new Array(r),i=0;i<r;i++)a[i]=arguments[i];return(t=e.call.apply(e,[this].concat(a))).type=s.DatasetType.Chem,t}return Object(l.a)(n,[{key:"createFingerprint",value:function(t,e,n){return Object(ut.jsx)(ur,{selection:t,aggregate:n})}}]),n}(s.PSEPlugin),cr=(n(649),n(302)),lr=n.n(cr);var fr=Object(g.connect)((function(t){var e,n;return{dataset:t.dataset,pacoAttributes:null===(e=t.pacoSettings)||void 0===e?void 0:e.pacoAttributes,pacoConstraints:null===(n=t.pacoSettings)||void 0===n?void 0:n.pacoConstraints,currentAggregation:t.currentAggregation}}),(function(t){return{setCurrentAggregation:function(e){return t(Object(s.selectVectors)(e))},setPacoRef:function(e){return t(be(e))}}}))((function(t){var e=t.dataset,n=t.pacoAttributes,r=t.pacoConstraints,i=t.setPacoRef,o=t.setCurrentAggregation,s=t.currentAggregation;if(null==e||null==e.columns)return null;var c=a.a.useState([]),l=Object(u.a)(c,2),f=l[0],h=l[1],g={showscale:!1,reversescale:!1,color:e.vectors.map((function(t){return 1})),colorscale:[[0,"#DDDDDD"],[1,"#ff0000"]]},p={type:"parcoords",line:g},m={padding:{top:0,bottom:0,left:0,right:0}},v={responsive:!0,displayModeBar:!1},y=a.a.useRef();return a.a.useEffect((function(){i(null===y||void 0===y?void 0:y.current)}),[y]),a.a.useEffect((function(){if(null!=n){var t=n.filter((function(t){return t.show})).map((function(t){return t.feature}));if(t.length>0){var a=t.map((function(t,n){var a,i,o,u=(a=e.columns[t],i=e.vectors,o=t,i.map((function(t){var e=t[o];return a.isNumeric&&(e=parseFloat(e)),e}))),s=function(t,e,n,r){var a=t.filter((function(t){return t.col===r}));if(e.isNumeric){var i=.01*(e.range.max-e.range.min),o=[];for(var u in a){var s=a[u];"BETWEEN"===s.operator?o.push([+s.val1,+s.val2]):"EQUALS"===s.operator&&o.push([+s.val1-i,+s.val1+i])}return{ticktext:void 0,values:n,tickvals:void 0,constraintrange:o}}var c=Object(d.a)(new Set(n)),l=n.map((function(t){return c.indexOf(t)})),f=[];for(var h in a){var g=a[h];if("EQUALS"===g.operator){var p=c.indexOf(g.val1);f.push([p-.5,p+.5])}}return e.metaInformation.imgSmiles?{ticktext:c.map((function(t){return P(t)})),values:l,tickvals:Object(d.a)(new Set(l)),constraintrange:f}:{ticktext:c,values:l,tickvals:Object(d.a)(new Set(l)),constraintrange:f}}(r,e.columns[t],u,t);return{values:s.values,label:t,constraintrange:s.constraintrange,tickvals:s.tickvals,ticktext:s.ticktext}})),i=Object(b.a)(Object(b.a)({},p),{},{dimensions:a});lr.a.newPlot(y.current,[i],m,v),y.current.on("plotly_restyle",(function(t){if(Object.keys(t[0]).filter((function(t){return t.includes("constraintrange")})).length>0){lr.a.restyle(y.current,{line:Object(b.a)({},g)},[0]);var n=y.current.data[0].dimensions.filter((function(t){return null!=t.constraintrange&&t.constraintrange.length>0}));if(n.length<=0){var r=e.vectors.map((function(t){return t.__meta__.meshIndex}));return void(T(s.aggregation,r)||(h(r),o(r)))}var a=e.vectors.filter((function(t){var r=!0;for(var a in n){var i=n[a],o=i.label,u=t[o],s=i.constraintrange;Array.isArray(s[0])||(s=[s]);var c=!1;for(var l in s){var f=s[l];if(e.columns[o].isNumeric)c=c||u>f[0]&&u<f[1];else for(var h=Math.ceil(f[0]),d=Math.floor(f[1]),g=h;g<=d;g++){var p=i.ticktext[g];e.columns[i.label].metaInformation.imgSmiles&&(p=A(p),c=c||u===p)}}r=r&&c}return r})).map((function(t){return t.__meta__.meshIndex}));T(s.aggregation,a)||(h(a),o(a))}}))}}}),[e,n,r]),a.a.useEffect((function(){if(null!=s.aggregation&&s.aggregation.length>0){if(!T(s.aggregation,f)){var t=e.vectors.map((function(t){return s.aggregation.includes(t.__meta__.meshIndex)?1:0})),n=Object(b.a)(Object(b.a)({},g),{},{color:t}),r=y.current.data[0].dimensions.map((function(t){return Object(b.a)(Object(b.a)({},t),{},{constraintrange:[]})})),a=Object(b.a)(Object(b.a)({},p),{},{dimensions:r,line:n});return lr.a.react(y.current,[a],m,v),void h(Object(d.a)(s.aggregation))}}else lr.a.restyle(y.current,{line:Object(b.a)({},g)},[0])}),[s]),Object(ut.jsx)("div",{className:"PacoParent",children:Object(ut.jsx)(Et.a,{style:{clear:"both"},paddingLeft:2,paddingTop:0,paddingRight:0,children:Object(ut.jsx)("div",{style:{},ref:y})})})})),hr=n(516),dr=function(t){var e=t.col,n=t.value,r=t.setValue,i=t.remove,o=t.dataset,s=a.a.useState([]),c=Object(u.a)(s,2),l=c[0],f=c[1];return a.a.useEffect((function(){S.loadCategoryValues(o.info.path,e).then((function(t){f(t.values)}))}),[e,o.info.path]),Object(ut.jsxs)(Ue.a,{container:!0,paddingTop:0,children:[Object(ut.jsx)(Ue.a,{item:!0,xs:3,textAlign:"right",children:Object(ut.jsx)(Ge.a,{title:"Remove "+e+" filter",children:Object(ut.jsx)(Ke.a,{onClick:function(){i(e)},children:Object(ut.jsx)(en.a,{fontSize:"large"})})})}),Object(ut.jsxs)(Ue.a,{item:!0,xs:9,children:[Object(ut.jsx)(kt.a,{id:"filter_"+e,marginBottom:"0px",children:e}),Object(ut.jsx)("div",{children:l.map((function(t){return Object(ut.jsx)(Ge.a,{title:t,children:Object(ut.jsxs)(hr.a,{style:{margin:"1px"},color:"primary",value:t,selected:n.includes(t),onChange:function(){n.includes(t)?r(Object(d.a)(new Set(n.filter((function(e){return e!==t}))))):r(Object(d.a)(new Set([].concat(Object(d.a)(n),[t]))))},children:["\xa0",o.columns[e].metaInformation.imgSmiles?P(t):t," (",o.vectors.filter((function(n){return n[e]===t})).length,")\xa0"]})},t)}))})]})]})},gr=function(t){var e=t.col,n=t.value,r=t.setValue,i=t.remove,o=t.dataset,s=a.a.useState(n[0]),c=Object(u.a)(s,2),l=c[0],f=c[1],h=a.a.useState(n[1]),d=Object(u.a)(h,2),g=d[0],p=d[1];a.a.useEffect((function(){S.loadValueRange(o.info.path,e).then((function(t){f(t.min),p(t.max)}))}),[o.info.path,e]);return Object(ut.jsxs)(Ue.a,{container:!0,paddingTop:0,children:[Object(ut.jsx)(Ue.a,{item:!0,xs:3,textAlign:"right",children:Object(ut.jsx)(Ge.a,{title:"Remove "+e+" filter",children:Object(ut.jsx)(Ke.a,{onClick:function(){i(e)},children:Object(ut.jsx)(en.a,{fontSize:"large"})})})}),Object(ut.jsxs)(Ue.a,{item:!0,xs:9,children:[Object(ut.jsx)(kt.a,{id:"filter_"+e,marginBottom:"-5px",children:e}),Object(ut.jsx)(ke.h,{getAriaLabel:function(){return e},value:n,onChange:function(t,e){r(e)},valueLabelDisplay:"auto","aria-labelledby":"filter_"+e,min:l,max:g,step:null==g||null==l||Math.floor(g)===g||Math.floor(l)===l?1:(g-l)/100,valueLabelFormat:function(t){return M(t,l,g)},marks:[{value:l||0,label:M(l||0,l,g)},{value:g||1,label:M(g||1,l,g)}]})]})]})},pr=n(560),mr=n.n(pr),vr=n(377),yr=n.n(vr),br=function(t){var e=t.dataset,n=t.removeFilter,r=t.constraintCols,i=t.constraints,o=t.triggerDatasetUpdate,s=t.state,c=a.a.useState({}),l=Object(u.a)(c,2),f=l[0],h=l[1];return a.a.useEffect((function(){if(null!=i){var t=Object(b.a)({},f),n=function(n){var a=r[n],o=i.filter((function(t){return t.col===a})),u=[void 0,void 0],s=[];o.length>0&&o.forEach((function(t){var e=t;"BETWEEN"===e.operator?null==u[0]||null==u[1]?u=[parseFloat(e.val1),parseFloat(e.val2)]:(u[0]=Math.min(parseFloat(e.val1),u[0]),u[1]=Math.max(parseFloat(e.val2),u[1])):"EQUALS"===e.operator&&s.push(e.val1)})),e.columns[a].isNumeric?t[a]={isNum:!0,val:u}:t[a]={isNum:!1,val:s}};for(var a in r)n(a);h(t)}}),[i]),a.a.useEffect((function(){if(null!=r){var t=Object(b.a)({},f);for(var n in r){var a=r[n];a in t||(e.columns[a].isNumeric?t[a]={isNum:!0,val:[-Number.MAX_VALUE,Number.MAX_VALUE]}:t[a]={isNum:!1,val:[]})}for(var i in Object.keys(t)){var o=Object.keys(t)[i];r.includes(o)||delete t[o]}h(t)}}),[r,e.columns]),Object(ut.jsxs)("div",{children:[Object(ut.jsx)(Et.a,{paddingTop:2,paddingRight:2,children:Object.keys(f).map((function(t){var r=f[t];return r.isNum?Object(ut.jsx)(gr,{dataset:e,col:t,value:r.val,setValue:function(e){var n=Object(b.a)({},f);n[t].val=e,h(n)},remove:n},t):Object(ut.jsx)(dr,{dataset:e,col:t,value:r.val,setValue:function(e){var n=Object(b.a)({},f);n[t].val=e,h(n)},remove:n},t)}))}),Object(ut.jsx)(Et.a,{paddingLeft:2,paddingTop:1,children:Object(ut.jsxs)(Ct.a,{fullWidth:!0,variant:"outlined",onClick:function(){_r(f,e,o,s)},children:[Object(ut.jsx)(mr.a,{}),"\xa0Apply Filter"]})}),Object(ut.jsx)(Et.a,{paddingLeft:2,paddingTop:1,children:Object(ut.jsx)(Ge.a,{title:"Reset constraints to initial state",children:Object(ut.jsxs)(Ct.a,{fullWidth:!0,variant:"outlined","aria-label":"Reset constraints to initial state",onClick:function(){S.resetPOIConstraints(e.info.path).then((function(t){null!=o&&o({display:e.info.path,path:e.info.path,type:e.info.type,uploaded:!0})}))},children:[Object(ut.jsx)(yr.a,{}),"\xa0Reset Constraints"]})})})]})},_r=function(t,e,n,r){var a=t,i=[];for(var o in a){var u=a[o];if(u.isNum){var s={col:o,operator:"BETWEEN",val1:u.val[0],val2:u.val[1]};i.push(s)}else{var c=u.val;for(var l in c){var f={col:o,operator:"EQUALS",val1:c[l],val2:c[l]};i.push(f)}}}S.updatePOIConstraints(e.info.path,i).then((function(t){"ok"!==t.msg&&alert(t.msg),null!=n&&n({display:e.info.path,path:e.info.path,type:e.info.type,uploaded:!0},r)}))},xr=n(378),jr=n.n(xr),Or=n(500),wr=function(t){var e=t.dataset,n=t.triggerDatasetUpdate,r=t.state,i=a.a.useState([]),o=Object(u.a)(i,2),s=o[0],c=o[1];return a.a.useEffect((function(){S.loadPOIExceptions(e.info.path).then((function(t){c(t)}))}),[e]),s.length>0&&Object(ut.jsxs)("div",{children:[Object(ut.jsx)(Et.a,{paddingY:2,children:Object(ut.jsx)(Or.a,{orientation:"horizontal"})}),Object(ut.jsx)(Et.a,{paddingLeft:2,paddingRight:2,children:Object(ut.jsx)(kt.a,{variant:"subtitle2",gutterBottom:!0,children:"Define Exceptions"})}),s.map((function(t,a){return Object(ut.jsxs)(Ue.a,{container:!0,paddingTop:0,children:[Object(ut.jsx)(Ue.a,{item:!0,xs:3,textAlign:"right",children:Object(ut.jsx)(Ge.a,{title:"Remove exception",children:Object(ut.jsx)(Ke.a,{onClick:function(){return function(t,r){var a=s.filter((function(e,n){return n!==t}));S.updatePOIExceptions(e.info.path,a).then((function(t){"ok"!==t.msg&&alert(t.msg),null!=n&&n({display:e.info.path,path:e.info.path,type:e.info.type,uploaded:!0},r)}))}(a,r)},children:Object(ut.jsx)(en.a,{fontSize:"large"})})})}),Object(ut.jsx)(Ue.a,{item:!0,xs:9,margin:"auto",children:Object(ut.jsxs)(kt.a,{children:[t.x_col,": ",E(t.x_coord)," | ",t.y_col,": ",E(t.y_coord)]})})]},"exception"+a)}))]})},Cr=Object(g.connect)((function(t){var e;return{dataset:t.dataset,triggerDatasetUpdate:null===(e=t.handleDataset)||void 0===e?void 0:e.triggerUpdate,state:t}}),(function(t){return{}}))((function(t){var e=t.dataset,n=t.triggerDatasetUpdate,r=t.state,i=a.a.useState([]),o=Object(u.a)(i,2),c=o[0],l=o[1],f=a.a.useState([]),h=Object(u.a)(f,2),g=h[0],p=h[1],m=a.a.useRef();return a.a.useEffect((function(){null!=e&&S.loadPOIConstraints(e.info.path).then((function(t){var e=Object(d.a)(new Set(t.map((function(t){return t.col}))));p(e),l(t)}))}),[e]),e&&Object(ut.jsxs)("div",{style:{display:"flex",flexDirection:"column",height:"100%",overflowY:"auto"},children:[Object(ut.jsxs)(Et.a,{paddingLeft:2,paddingTop:1,paddingRight:2,children:[Object(ut.jsx)(kt.a,{variant:"subtitle2",gutterBottom:!0,children:"Filter Settings"}),Object(ut.jsx)(He,{variant:"filterOutOfTotal"})]}),Object(ut.jsx)(Et.a,{paddingLeft:2,paddingTop:1,paddingRight:2,children:Object(ut.jsx)(s.SelectFeatureComponent,{column_info:e.columns,label:"filter",default_val:void 0,categoryOptions:Object.keys(e.columns).filter((function(t){return!g.includes(t)})),onChange:function(t){Object.keys(e.columns).includes(t)&&p([].concat(Object(d.a)(g),[t]))}})}),Object(ut.jsx)(Et.a,{paddingTop:1,paddingRight:2,children:Object(ut.jsx)(br,{state:r,triggerDatasetUpdate:n,dataset:e,constraintCols:g,constraints:c,removeFilter:function(t){p(g.filter((function(e){return e!==t})))}})}),Object(ut.jsx)(Et.a,{paddingLeft:2,paddingTop:1,paddingRight:2,children:Object(ut.jsxs)(Ue.a,{container:!0,children:[Object(ut.jsx)(Ue.a,{item:!0,xs:6,paddingRight:1,children:Object(ut.jsxs)(Ct.a,{fullWidth:!0,variant:"outlined",onClick:function(){Sr(e.info.path)},children:[Object(ut.jsx)(At.a,{}),"\xa0Export"]})}),Object(ut.jsxs)(Ue.a,{item:!0,xs:6,paddingLeft:1,children:[Object(ut.jsx)("input",{style:{display:"none"},accept:".csv",ref:m,type:"file",onChange:function(t){kr(t.target.files,e,n,r)}}),Object(ut.jsxs)(Ct.a,{fullWidth:!0,variant:"outlined",onClick:function(){m.current.click()},children:[Object(ut.jsx)(jr.a,{}),"\xa0Import"]})]})]})}),Object(ut.jsx)(Et.a,{paddingTop:1,paddingRight:2,children:Object(ut.jsx)(wr,{state:r,triggerDatasetUpdate:n,dataset:e})})]})})),Sr=function(t){S.downloadPOIConstraints(t)},kr=function(t,e,n,r){if(!(null==t||t.length<=0)){var a=t[0];a.name.endsWith("csv")&&S.uploadPOIConstraints(e.info.path,a).then((function(t){"ok"===t.msg&&null!=n&&n({display:e.info.path,path:e.info.path,type:e.info.type,uploaded:!0},r)}))}},Er=n(562),Mr=n.n(Er),Tr=n(561),Pr=n.n(Tr),Ar=Object(g.connect)((function(t){var e,n,r;return{pacoAttributes:null===(e=t.pacoSettings)||void 0===e?void 0:e.pacoAttributes,pacoConstraints:null===(n=t.pacoSettings)||void 0===n?void 0:n.pacoConstraints,pacoRef:null===(r=t.pacoSettings)||void 0===r?void 0:r.pacoRef,dataset:t.dataset}}),(function(t){return{setPacoAttributes:function(e){return t(ve(e))},setPacoConstraints:function(e){return t(ye(e))}}}))((function(t){var e=t.setPacoAttributes,n=t.pacoAttributes,r=t.setPacoConstraints,i=t.pacoConstraints,o=t.pacoRef,u=t.dataset,c=a.a.useRef();return Object(ut.jsxs)("div",{style:{display:"flex",flexDirection:"column",height:"100%"},children:[Object(ut.jsx)(Et.a,{paddingLeft:2,paddingTop:1,paddingRight:2,children:Object(ut.jsx)(kt.a,{variant:"subtitle2",gutterBottom:!0,children:"Parallel Coordinates Settings"})}),Object(ut.jsx)(Et.a,{paddingLeft:2,paddingTop:1,paddingRight:2,children:Object(ut.jsxs)(s.AttributeSelectionTable,{attributes:n,setAttributes:e,btnFullWidth:!0,children:[Object(ut.jsx)(Pr.a,{}),"\xa0Choose Attributes"]})}),Object(ut.jsx)(Et.a,{paddingLeft:2,paddingTop:1,paddingRight:2,children:Object(ut.jsx)(Ge.a,{title:"Reset constraints to initial state",children:Object(ut.jsxs)(Ct.a,{fullWidth:!0,variant:"outlined","aria-label":"Reset constraints to initial state",onClick:function(){r(Object(d.a)(i))},children:[Object(ut.jsx)(yr.a,{}),"\xa0Reset Constraints"]})})}),Object(ut.jsx)(Et.a,{paddingLeft:2,paddingTop:1,paddingRight:2,children:Object(ut.jsxs)(Ue.a,{container:!0,children:[Object(ut.jsx)(Ue.a,{item:!0,xs:6,paddingRight:1,children:Object(ut.jsx)(Ge.a,{title:"Export constraints",children:Object(ut.jsxs)(Ct.a,{fullWidth:!0,variant:"outlined",color:"primary","aria-label":"Export constraints",onClick:function(){Nr(o.data[0].dimensions,u.columns)},children:[Object(ut.jsx)(Mr.a,{}),"\xa0Export"]})})}),Object(ut.jsxs)(Ue.a,{item:!0,xs:6,paddingLeft:1,children:[Object(ut.jsx)("input",{style:{display:"none"},accept:".csv",ref:c,type:"file",onChange:function(t){Ir(t.target.files,r)}}),Object(ut.jsx)(Ge.a,{title:"Import constraints",children:Object(ut.jsxs)(Ct.a,{fullWidth:!0,variant:"outlined",color:"primary","aria-label":"Import constraints",onClick:function(){return c.current.click()},children:[Object(ut.jsx)(jr.a,{}),"\xa0Import"]})})]})]})})]})})),Nr=function(t,e){var n=t.filter((function(t){return null!=t.constraintrange&&t.constraintrange.length>0}));if(!(n.length<=0)){var r=[];for(var a in n){var i=n[a],o=i.constraintrange;for(var u in Array.isArray(o[0])||(o=[o]),o){var s=o[u];if(e[i.label].isNumeric){var c={col:i.label,operator:"BETWEEN",val1:s[0],val2:s[1]};r.push(c)}else for(var l=Math.ceil(s[0]),f=Math.floor(s[1]),h=l;h<=f;h++){var d=i.ticktext[h];e[i.label].metaInformation.imgSmiles&&(d=A(d));var g={col:i.label,operator:"EQUALS",val1:d,val2:d};r.push(g)}}}!function(t,e){var n=t.map((function(t){return Object.values(t).join(",")})),r=e.join(",")+"\n";r+=n.join("\n"),R(r,"parallel_coordinates_constraints.csv","text/csv")}(r,Object.keys(r[0]))}},Ir=function(t,e){if(!(null==t||t.length<=0)){var n=t[0],r=new FileReader;r.onload=function(t){var n=O.csvParse(t.target.result);e(n)},r.readAsBinaryString(n)}},Ur=Object(g.connect)((function(t){var e;return{dataset:t.dataset,multiples:t.multiples,globalLabels:t.globalLabels,triggerDatasetUpdate:null===(e=t.handleDataset)||void 0===e?void 0:e.triggerUpdate,state:t}}),(function(t){return{}}))((function(t){var e,n,r,a,i=t.handleClose,o=t.pos_x,u=t.pos_y,c=t.dataset,l=t.multiples,f=t.globalLabels,h=t.triggerDatasetUpdate,d=t.state,g=null===(e=l.multiples.entities[l.active])||void 0===e||null===(n=e.attributes)||void 0===n?void 0:n.workspace,p=null==(null===g||void 0===g?void 0:g.xChannel)?"x":null===g||void 0===g?void 0:g.xChannel,m=null==(null===g||void 0===g?void 0:g.yChannel)?"y":null===g||void 0===g?void 0:g.yChannel,v=null===(r=l.multiples.entities[l.active])||void 0===r||null===(a=r.attributes)||void 0===a?void 0:a.viewTransform;return Object(ut.jsx)(Pe.a,{onClick:function(){var t=s.CameraTransformations.screenToWorld({x:o,y:u},v),e=c.columns[p].range.max-c.columns[p].range.min,n=c.columns[m].range.max-c.columns[m].range.min,r=.1*Math.min(e,n);S.addPOIExceptions(null===c||void 0===c?void 0:c.info.path,[{x_col:p,y_col:m,x_coord:t.x,y_coord:t.y,radius:r}]).then((function(t){"ok"!==t.msg&&alert(t.msg),null!=h&&h({display:c.info.path,path:c.info.path,type:c.info.type,uploaded:!0},d)})),i()},children:"Show ".concat(f.itemLabelPlural," in this region")})})),Rr=Object(g.connect)((function(t){return{globalLabels:t.globalLabels,dataset:t.dataset,triggerDatasetUpdate:t.handleDataset.triggerUpdate,state:t}}),(function(t){return{}}))((function(t){var e=t.handleClose,n=t.globalLabels,r=t.menuTarget,a=t.dataset,i=t.triggerDatasetUpdate,o=t.state;return null==r?null:Object(ut.jsx)(Pe.a,{onClick:function(){var t=Object.keys(a.columns).filter((function(t){return a.columns[t].project&&!s.EXCLUDED_COLUMNS_ALL.includes(t)})),n={};for(var u in t){var c=t[u],l=[];if(a.columns[c].isNumeric){var f=.01*r[c];l.push(r[c]-f),l.push(r[c]+f)}else l.push(r[c]);n[c]={val:l,isNum:a.columns[c].isNumeric}}_r(n,a,i,o),e()},children:"Set filters to features of this ".concat(n.itemLabel)})})),Fr=!1;s.PluginRegistry.getInstance().registerPlugin(new sr);var Dr=function(){var t=Object(r.useState)(new s.API(null,function(){var t=Object(s.createRootReducer)(Se);return function(e,n){var r=t(e,n);if(n.type===s.RootActionTypes.DATASET&&null!=r.dataset){var a=Object.keys(r.dataset.columns).map((function(t){return{feature:t,show:r.dataset.columns[t].metaInformation.paco}}));Object.assign(r,{pacoSettings:Object(b.a)(Object(b.a)({},e.pacoSettings),{},{pacoAttributes:a})})}return r}}())),e=Object(u.a)(t,1)[0];return e.store.dispatch(Object(s.setItemLabel)({label:"experiment",label_plural:"experiments"})),Object(ut.jsx)(s.PSEContextProvider,{context:e,children:Object(ut.jsx)(Lr,{})})},Lr=Object(g.connect)((function(t){var e,n;return{dataset_path:null===(e=t.dataset)||void 0===e||null===(n=e.info)||void 0===n?void 0:n.path,legendAttributes:t.genericFingerprintAttributes,globalLabels:t.globalLabels}}),(function(t){return{setMouseMoveFn:function(e){return t(he(e))},setMouseClickFn:function(e){return t(de(e))},resetViews:function(){return t(Ce.resetViews())}}}))((function(t){var e=t.setMouseMoveFn,n=t.dataset_path,a=t.setMouseClickFn,i=t.legendAttributes,o=(t.globalLabels,t.resetViews),u=function(t){"init"===t&&o()};return Object(r.useEffect)((function(){if(null!=i){var t=i.filter((function(t){return t.show})).map((function(t){return t.feature}));t.length>0&&S.updateBackendCache(n,t)}}),[i,n]),Object(ut.jsx)(s.Application,{config:{preselect:{initOnMount:!1}},features:{embeddings:[{id:"umapRemote",name:"UMAP",settings:{nneighbors:!0},embController:new mn("umap",u)},{id:"tsneRemote",name:"t-SNE",settings:{perplexity:!0},embController:new mn("tsne",u)},{id:"pcaRemote",name:"PCA",settings:{},embController:new mn("pca",u)},{id:"rmOverlap",name:"Overlap Removal",settings:{hideSettings:!0},embController:new mn("rmOverlap",u)}]},overrideComponents:{mouseInteractionCallbacks:{onmousemove:function(t,n){e({x:t.x,y:t.y,event_used:n})},onmouseclick:function(t,e,n){a({x:t.x,y:t.y,event_used:e,button:n})}},datasetTab:hn,appBar:function(){return Object(ut.jsx)("div",{})},contextMenuItems:[Ur,Rr],detailViews:[{name:"LineUp",view:Object(ut.jsx)(ft,{},"lineup"),settings:Nt},{name:"Parallel Coordinates",view:Object(ut.jsx)(fr,{},"paco"),settings:Ar}],tabs:[{name:"aggregatDS",tab:ze,title:"Aggregate",description:"Aggregated Dataset that should be shown in the background",icon:_n.Aggregate},{name:"filterDS",tab:Cr,title:"Filter",description:"Filter subset of dataset that should be shown in the main visualization views",icon:_n.Filter}],layers:[{order:-1,component:En}]}})})),Vr=(n(650),n(563));o.a.render(Object(ut.jsx)(Dr,{}),document.getElementById("root")),console.log("Reaction CIME version:",Vr.a)}},[[651,1,2]]]);
//# sourceMappingURL=main.61680b9e.chunk.js.map